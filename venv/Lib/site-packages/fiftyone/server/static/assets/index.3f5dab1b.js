var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,i=(t,n,s)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[n]=s,o=(e,t)=>{for(var n in t||(t={}))a.call(t,n)&&i(e,n,t[n]);if(s)for(var n of s(t))l.call(t,n)&&i(e,n,t[n]);return e},r=(e,s)=>t(e,n(s)),c=(e,t)=>{var n={};for(var i in e)a.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&s)for(var i of s(e))t.indexOf(i)<0&&l.call(e,i)&&(n[i]=e[i]);return n};import{q as d,e as m,r as u,z as h,u as p,R as g,C as f,a as b,b as y,m as v,v as x,c as w,d as k,l as E,f as S,h as L,g as T,i as Z,j as C,k as P,n as R,o as I,p as W,s as M,t as X,w as N,S as G,_ as Y,M as V,x as F,G as K,y as O,A as z,B as D,D as H,E as U,K as j,F as B,H as J,I as A,J as _,L as Q,N as $,O as q,P as ee,Q as te,T as ne,U as se,V as ae,W as le,X as ie,Y as oe,Z as re,$ as ce,a0 as de,a1 as me,a2 as ue,a3 as he,a4 as pe,a5 as ge,a6 as fe,a7 as be,a8 as ye,a9 as ve,aa as xe,ab as we,ac as ke,ad as Ee,ae as Se,af as Le,ag as Te,ah as Ze,ai as Ce,aj as Pe,ak as Re,al as Ie,am as We,an as Me,ao as Xe,ap as Ne,aq as Ge,ar as Ye,as as Ve,at as Fe,au as Ke,av as Oe,aw as ze,ax as De,ay as He,az as Ue,aA as je,aB as Be,aC as Je,aD as Ae,aE as _e,aF as Qe,aG as $e}from"./vendor.4f1feadd.js";const qe=d("div")`
  position: fixed;
  z-index: 10000;
  width: 0 auto;
  bottom: ${e=>e.top?"unset":"2em"};
  margin: 0 auto;
  right: 2em;
  font-weight: bold;
  display: flex;
  flex-direction: ${e=>e.top?"column-reverse":"column"};
  align-items: ${e=>"center"===e.position?"center":`flex-${e.position||"end"}`};
  @media (max-width: 680px) {
    align-items: center;
  }
`,et=d(m.div)`
  margin-top: 1em;
  box-sizing: border-box;
  position: relative;
  overflow: hidden;
  width: 40ch;
  @media (max-width: 680px) {
    width: 100%;
  }
`,tt=d.p`
  margin-bottom: 1.5em;
  color: ${({theme:e})=>e.fontDark};
`,nt=d.h3`
  font-size: 1.5em;
  color: ${({theme:e})=>e.font};
`,st=d.div`
  color: ${({theme:e})=>e.font};
  background: ${({theme:e})=>e.backgroundDark};
  border: 1px solid ${({theme:e})=>e.backgroundDarkBorder};
  box-shadow: 0 2px 40px ${({theme:e})=>e.backgroundDark};
  padding: 1em 2em 0 2em;
  font-size: 1em;
  overflow: hidden;
  height: auto;
  border-radius: 3px;
`,at=d.button`
  cursor: pointer;
  outline: 0;
  border: none;
  background: transparent;
  display: flex;
  align-self: flex-end;
  position: abo
  overflow: hidden;
  margin: 0;
  padding: 0;
  padding-bottom: 2em;
  color: ${({theme:e})=>e.fontDark};
  :hover {
    color: ${({theme:e})=>e.font};
  }
`,lt=d.div`
  display: flex;
  justify-content: space-between;
`,it=m(d.div`
  position: absolute;
  bottom: ${e=>e.top?"0.5em":"0"};
  left: 0px;
  width: auto;
  border-bottom-left-radius: 3px;
  border-bottom-right-radius: 3px;
  background-image: linear-gradient(
    130deg,
    ${({theme:e})=>e.brand},
    ${({theme:e})=>e.brandFullyTransparent}
  );
  height: 0.5em;
`);let ot=0;const rt={"Server Error":!1,"Dataset Created":!0},ct={"Server Error":"error","Dataset Created":"font"},dt=({config:e={tension:125,friction:20,precision:.1},children:t})=>{const n=u.exports.useContext(h),[s]=u.exports.useState((()=>new WeakMap)),[a]=u.exports.useState((()=>new WeakMap)),[l,i]=u.exports.useState([]),r=p(l,(e=>e.key),{from:{opacity:0,height:0,life:"100%"},enter:e=>async t=>{await t({opacity:1,height:s.get(e).offsetHeight})},leave:e=>async(t,n)=>{a.set(e,n),await t({life:"0%"}),await t({opacity:0}),await t({height:0}),e.onClose&&e.onClose()},onRest:e=>i((t=>t.filter((t=>t.key!==e.key)))),config:(t,n)=>"leave"===n?[{duration:rt[t.kind]?3e3:Number.POSITIVE_INFINITY},e,e]:e});return u.exports.useEffect((()=>t((e=>{const t=o({key:ot++},e);return i((e=>[...e,t])),()=>{t.onClose&&t.onClose(),a.has(t)&&a.get(t)()}}))),[]),g.createElement(qe,null,r.map((e=>{var{key:t,item:l,props:i}=e,o=i,{life:r}=o,d=c(o,["life"]);return g.createElement(et,{key:t,style:d},g.createElement(st,{ref:e=>e&&s.set(l,e)},g.createElement(it,{style:{right:r}}),g.createElement(lt,null,g.createElement(nt,{style:{color:n[ct[l.kind]]}},l.kind),g.createElement(at,{onClick:e=>{e.stopPropagation(),e.preventDefault(),a.has(l)&&a.get(l)()}},g.createElement(f,null))),g.createElement(tt,null,l.message),l.app_items&&l.app_items.map(((e,t)=>g.createElement(tt,{key:t},e))),l.children&&l.children))})))},mt=d.div`
  background-color: transparent;
  border: none;
  padding: 0.27rem 0.5rem 0.5rem 0;
  color: ${({theme:e})=>e.brand};
  height: 1rem;
  border: none;
  font-weight: bold;
`,ut=b({key:"modal",default:null}),ht=y({key:"sortFilterResults",default:{count:!0,asc:!1}}),pt=y({key:"cropToContent",default:!0}),gt=b({key:"fullscreen",default:!1}),ft=b({key:"connected",default:!1}),bt=b({key:"closeTeams",default:null}),yt=b({key:"teamsSubmitted",default:{submitted:!1,minimized:!1}}),vt=b({key:"activePlot",default:"labels"}),xt=b({key:"datasetStatsRaw",default:{view:null,stats:[]}}),wt=b({key:"extendedDatasetStatsRaw",default:{view:null,stats:[],filters:null}}),kt=b({key:"loading",default:!1}),Et=y({key:"tagging",default:!1}),St=b({key:"stateDescription",default:{}}),Lt=b({key:"selectedSamples",default:new Set}),Tt=b({key:"hiddenLabels",default:{}});b({key:"stageInfo",default:void 0});const Zt=b({key:"sidebarVisible",default:!0}),Ct=b({key:"viewCounter",default:0}),Pt=y({key:"colorByLabel",default:!1}),Rt=y({key:"alpha",default:.7}),It=b({key:"colorPool",default:[]}),Wt=y({key:"colorSeed",default:1}),Mt=b({key:"appTeamsIsOpen",default:!1}),Xt=b({key:"savedLookerOptions",default:{}}),Nt=["Classifications","Detections","Keypoints","Polylines","TemporalDetections"],Gt=["Detections","Polylines"],Yt=["TemporalDetection","TemporalDetections"],Vt=["Classifications","Detections","Keypoints","Polylines"],Ft=["Classification","Classifications","Regression","TemporalDetection","TemporalDetections","Detection","Detections","Keypoint","Keypoints","Polyline","Polylines","Heatmap","Segmentation"],Kt=["Classification","Classifications","Detection","Detections","Keypoints","Keypoint","Polylines","Polyline","Regression","TemporalDetection","TemporalDetections"],Ot=["Classification","Classifications","Detection","Detections","Keypoint","Keypoints","Polyline","Polylines","Regression","TemporalDetection","TemporalDetections"],zt=["TemporalDetection","TemporalDetections"],Dt=["Classifications","Detections","Keypoints","Polylines","TemporalDetections"],Ht=["TemporalDetection","TemporalDetections"],Ut={Classifications:"classifications",Detections:"detections",Keypoints:"keypoints",Polylines:"polylines",TemporalDetections:"detections"},jt="Bounds",Bt="Count",Jt="CountValues",At="fiftyone.core.fields.DateField",_t="fiftyone.core.fields.DateTimeField",Qt="fiftyone.core.fields.FloatField",$t="fiftyone.core.fields.FrameNumberField",qt="fiftyone.core.fields.FrameSupportField",en="fiftyone.core.fields.IntField",tn="fiftyone.core.fields.ObjectIdField",nn="fiftyone.core.fields.StringField",sn="fiftyone.core.fields.ListField",an=[qt,sn],ln=["fiftyone.core.fields.BooleanField",At,_t,Qt,$t,qt,en,tn,nn],on=[At,_t,Qt,$t,qt,en],rn=["_id","_rand","_media_type","metadata","tags","frames"],cn=[{name:"Size (bytes)",key:"size_bytes"},{name:"Type",key:"mime_type"},{name:"Media type",key:"_media_type"},{name:"Dimensions",value:e=>{if(!isNaN(e.width)&&!isNaN(e.height))return`${e.width} x ${e.height}`}},{name:"Channels",key:"num_channels"}];const dn=()=>window.process&&window.process.versions&&Boolean(window.process.versions.electron),mn=(e,t,n="middle")=>{if(e.length<=t)return e;const s=n.toLowerCase();if("first"===s)return"..."+e.slice(-(t-3));if("middle"===s){const n=Math.ceil(.5*(t-3)),s=Math.floor(.5*(t-3));return e.slice(0,n)+"..."+e.slice(-s)}if("last"===s)return e.slice(0,t-3)+"...";throw new Error(`Unsupported mode '${n}'`)},un=(e,t=!0,n=27)=>"string"==typeof e?t?mn(e,n):e:"number"==typeof e?Number(e.toFixed(3)).toLocaleString():!0===e?"True":!1===e?"False":[void 0,null].includes(e)?"None":Array.isArray(e)?(e=`[${e.join(", ")}]`,t?mn(e,n):e):null,hn=(e,t,n)=>e===t?0:null===e?1:null===t?-1:e>t?n?1:-1:n?-1:1,pn=e=>e.metadata&&e.metadata.mime_type||v.getType(e.filepath)||"image/jpg",gn=(e,t)=>{const n="2-digit",s={timeZone:t,year:"numeric",day:n,month:n,hour:n,hour12:!1,minute:n,second:n,fractionalSecondDigits:3};return e%1e3||delete s.fractionalSecondDigits,e%864e5||(delete s.second,delete s.minute,delete s.hour),new Intl.DateTimeFormat("en-ZA",s).format(e).replaceAll("/","-").replace(", "," ").replace(",",".")},fn=(()=>{const e="2-digit";let t="en-ZA";const n=36e5,s=24*n;return(a,l,i)=>{const o=Math.abs(l-i);let r={timeZone:a,hour12:!1},c={timeZone:a,hour12:!1};return l%s==0&&i%s==0?(r=null,c={year:"numeric",month:e,day:e},t="en-CA"):o<1e3?(r={year:"numeric",day:e,month:e},c={hour:e,minute:e,second:e,fractionalSecondDigits:3},t="en-ZA"):o<6e4?(r={year:"numeric",day:e,month:e,hour:e,minute:e},c={second:e,fractionalSecondDigits:3},t="en-ZA"):o<n?(r={year:"numeric",day:e,month:e},c={hour:e,minute:e,second:e},t="en-ZA"):(r=null,c={year:"numeric",month:e,day:e,hour:e,minute:e,second:e},t="en-ZA"),[r?new Intl.DateTimeFormat(t,r):null,new Intl.DateTimeFormat(t,c)]}})();const bn=new URLSearchParams(window.location.search).get("notebook"),yn=new URLSearchParams(window.location.search).get("polling"),vn=new URLSearchParams(window.location.search).get("colab"),xn=new URLSearchParams(window.location.search).get("databricks"),wn=new URLSearchParams(window.location.search).get("handleId"),kn=x(),En=window.location.host,Sn=window.location.pathname.endsWith("/")?window.location.pathname.slice(0,-1):window.location.pathname,Ln=dn()?parseInt({}.FIFTYONE_SERVER_PORT)||5151:parseInt(window.location.port),Tn=dn()?"localhost":window.location.hostname,Zn=dn()?`http://${Tn}:${Ln}${Sn}`:window.location.protocol+"//"+En+Sn,Cn=dn()?`ws://${Tn}:${Ln}${Sn}/state`:`${"https:"===window.location.protocol?"wss:":"ws:"}//${En}${Sn}/state`,Pn=dn()?"desktop":vn?"colab":xn?"databricks":bn?"notebook":"browser";var Rn=yn?new class{constructor(e){this.events={},this.readyState=WebSocket.CONNECTING,this.openTimeout=2e3,this.timeout=2e3,this.location=e,this.connect()}connect(){this.gather(),this.interval=setInterval((()=>this.gather()),this.timeout)}execute(e){[WebSocket.CLOSED,WebSocket.CONNECTING].includes(this.readyState)&&(this.events.open.forEach((e=>e(null))),this.timeout=this.openTimeout,clearInterval(this.interval),this.interval=setInterval((()=>this.gather()),this.timeout)),this.readyState=WebSocket.OPEN,e.forEach((e=>{fetch(this.location+"&mode=pull",{method:"post",body:JSON.stringify(e)}).then((e=>e.json())).then((e=>{this.events.message.forEach((t=>t({data:JSON.stringify(e)})))}))}))}gather(){fetch(this.location).then((e=>e.json())).then((({messages:e})=>this.execute(e))).catch((()=>{this.readyState===WebSocket.OPEN&&this.events.close&&this.events.close.forEach((e=>e(null))),this.readyState=WebSocket.CLOSED,clearInterval(this.interval),this.timeout=Math.min(2*this.timeout,5e3),this.interval=setInterval((()=>this.gather()),this.timeout)}))}addEventListener(e,t){this.events[e]||(this.events[e]=new Set),this.events[e].add(t)}removeEventListener(e,t){this.events[e].delete(t)}send(e){fetch(this.location+"&mode=push",{method:"post",body:e}).then((e=>e.json())).then((e=>{const{messages:t,type:n}=e;t&&this.execute(t),n&&this.events.message.forEach((t=>t({data:JSON.stringify(e)})))}))}}(`${Zn}/polling?sessionId=${kn}`):new w(Cn);const In=(e,t)=>JSON.stringify(r(o({},t),{type:e})),Wn=({type:e,args:t,uuid:n,responseType:s})=>new Promise((a=>{const l=((e,t)=>({data:n})=>{(n=JSON.parse(n)).type===e&&t(n)})(s||e,(e=>{var t=e,{uuid:s}=t,i=c(t,["uuid"]);n===s&&(Rn.removeEventListener("message",l),a(i))}));Rn.addEventListener("message",l),Rn.send(In(e,r(o({},t),{uuid:n})))})),Mn=e=>JSON.stringify(e.map((({kwargs:e,_cls:t})=>({kwargs:e.filter((e=>!e[0].startsWith("_"))),_cls:t})))),Xn=(e,t)=>Mn(e)===Mn(t),Nn="hsl(210, 11%, 11%)",Gn="hsl(210, 11%, 15%)",Yn="hsl(210, 5%, 24%)",Vn={background:"hsl(214, 7%, 19%)",backgroundDark:Gn,backgroundDarker:Nn,backgroundLight:Yn,backgroundLightBorder:Gn,backgroundDarkBorder:Nn,backgroundTransparent:"hsla(214, 7%, 19%, 0.5)",border:"hsl(200, 2%, 37%)",borderLight:Yn,button:"hsl(200, 2%, 37%)",buttonBorder:Yn,overlay:"hsla(208, 7%, 46%, 0.7)",overlayButton:"hsla(208, 7%, 46%, 0.3)",overlayButtonHover:"hsla(208, 7%, 46%, 0.7)",menuBackground:Gn,menuBorder:Nn,darkShadow:"hsla(0, 0%, 0%, 0.16)",darkerShadow:"hsla(0, 0%, 0%, 0.25)",brand:"hsl(27, 95%, 49%)",brandDark:"hsl(27, 95%, 45%)",brandTransparent:"hsla(27, 95%, 49%, 0.4)",brandMoreTransparent:"hsla(27, 95%, 49%, 0.1)",brandFullyTransparent:"hsla(27, 95%, 49%, 0)",font:"hsl(0, 0%, 100%)",fontDark:"hsl(220, 2%, 68%)",fontDarkest:"hsl(230, 3%, 60%)",secondary:"hsl(213, 100%, 53%)",secondaryLight:"hsl(211, 85%, 92%)",error:"hsl(0, 87%, 53%)"};r(o({},Vn),{background:"hsl(0, 0%, 100%)",border:"hsl(0, 0%, 85%)",font:"hsl(0, 0%, 20%)"});const Fn=new Set(["-inf","inf","nan"]),Kn=["Classification","Classifications","Regression"],On=["Classification","Classifications","Regression","TemporalDetection","TemporalDetections"],zn={Classifications:"classifications",Detections:"detections",Keypoints:"Keypoints",Polylines:"polylines",TemporalDetections:"detections"},Dn=new Set(["Detection","Segmentation"]),Hn="Click to select sample, Shift+Click to select a range",Un={keyColor:"rgb(138, 138, 138)",numberColor:"rgb(225, 100, 40)",stringColor:"rgb(238, 238, 238)",nullColor:"rgb(225, 100, 40)",trueColor:"rgb(225, 100, 40)",falseColor:"rgb(225, 100, 40)"},jn=(()=>{let e=new ArrayBuffer(4),t=new Uint32Array(e),n=new Uint8Array(e);return t[0]=3405691582,202===n[0]})(),Bn=new Blob([atob("dmFyIF9fZ2V0T3duUHJvcFN5bWJvbHM9T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyxfX2hhc093blByb3A9T2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSxfX3Byb3BJc0VudW09T2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZSxfX29ialJlc3Q9KGUsdCk9Pnt2YXIgcj17fTtmb3IodmFyIG4gaW4gZSlfX2hhc093blByb3AuY2FsbChlLG4pJiZ0LmluZGV4T2Yobik8MCYmKHJbbl09ZVtuXSk7aWYobnVsbCE9ZSYmX19nZXRPd25Qcm9wU3ltYm9scylmb3IodmFyIG4gb2YgX19nZXRPd25Qcm9wU3ltYm9scyhlKSl0LmluZGV4T2Yobik8MCYmX19wcm9wSXNFbnVtLmNhbGwoZSxuKSYmKHJbbl09ZVtuXSk7cmV0dXJuIHJ9OyFmdW5jdGlvbigpeyJ1c2Ugc3RyaWN0Ijtjb25zdCBlPSJDbGFzc2lmaWNhdGlvbiIsdD0iQ2xhc3NpZmljYXRpb25zIixyPSJEZXRlY3Rpb24iLG49IkRldGVjdGlvbnMiLGE9Ikdlb0xvY2F0aW9uIixpPSJHZW9Mb2NhdGlvbnMiLG89IkhlYXRtYXAiLHM9IktleXBvaW50IixsPSJLZXlwb2ludHMiLGY9IlBvbHlsaW5lIixjPSJQb2x5bGluZXMiLHU9IlJlZ3Jlc3Npb24iLGQ9IlNlZ21lbnRhdGlvbiIsaD0iVGVtcG9yYWxEZXRlY3Rpb24iLG09IlRlbXBvcmFsRGV0ZWN0aW9ucyIsYj17W3RdOiJjbGFzc2lmaWNhdGlvbnMiLFtuXToiZGV0ZWN0aW9ucyIsW2xdOiJLZXlwb2ludHMiLFtjXToicG9seWxpbmVzIixbbV06ImRldGVjdGlvbnMifSx3PXtbZV06ZSxbdF06dCxbcl06cixbbl06bixbYV06YSxbaV06aSxbb106byxbc106cyxbbF06bCxbZl06ZixbY106YyxbZF06ZCxbdV06dSxbaF06aCxbbV06bX0sZz0oKCk9PntsZXQgZT1uZXcgQXJyYXlCdWZmZXIoNCksdD1uZXcgVWludDMyQXJyYXkoZSkscj1uZXcgVWludDhBcnJheShlKTtyZXR1cm4gdFswXT0zNDA1NjkxNTgyLDIwMj09PXJbMF19KSgpLHA9e30saz0oZSx0PTEpPT57Y29uc3Qgcj1gJHtlfSR7dD1NYXRoLnJvdW5kKDI1NSp0KX1gO2lmKHIgaW4gcClyZXR1cm4gcFtyXTtsZXQgbixhLGk7cmV0dXJuW24sYSxpXT0ic3RyaW5nIj09dHlwZW9mIGU/KGU9PntsZXQgdCxyLG47aWYoZS5zdGFydHNXaXRoKCIjIikpW3QscixuXT15KGUpO2Vsc2UgaWYoZS5zdGFydHNXaXRoKCJyZ2IiKSl7bGV0IGE9ZS5pbmRleE9mKCIsIik+LTE/IiwiOiIgIjtbdCxyLG5dPWUuc2xpY2UoNCkuc3BsaXQoIikiKVswXS5zcGxpdChhKX1lbHNlIGUuc3RhcnRzV2l0aCgiaHNsIikmJihbdCxyLG5dPV8oZSkpO3JldHVyblt0LHIsbl19KShlKTplLHBbcl09Zz9uPDwyNHxhPDwxNnxpPDw4fHQ6dDw8MjR8aTw8MTZ8YTw8OHxuLHBbcl19LHk9ZT0+e2xldCB0PTAscj0wLG49MDtyZXR1cm4gND09ZS5sZW5ndGg/KHQ9KygiMHgiK2VbMV0rZVsxXSkscj0rKCIweCIrZVsyXStlWzJdKSxuPSsoIjB4IitlWzNdK2VbM10pKTo3PT1lLmxlbmd0aCYmKHQ9KygiMHgiK2VbMV0rZVsyXSkscj0rKCIweCIrZVszXStlWzRdKSxuPSsoIjB4IitlWzVdK2VbNl0pKSxbdCxyLG5dfSxfPWU9PntsZXQgdCxyLG4sYT1lLmluZGV4T2YoIiwiKT4tMT8iLCI6IiAiLFtpLG8sc109ZS5zbGljZSg0KS5zcGxpdCgiKSIpWzBdLnNwbGl0KGEpO2lmKGkvPTM2MCxvLz0xMDAscy89MTAwLDA9PT1vKXQ9cj1uPXM7ZWxzZXtjb25zdCBlPShlLHQscik9PihyPDAmJihyKz0xKSxyPjEmJihyLT0xKSxyPDEvNj9lKzYqKHQtZSkqcjpyPC41P3Q6cjwyLzM/ZSsodC1lKSooMi8zLXIpKjY6ZSksYT1zPC41P3MqKDErbyk6cytvLXMqbyxsPTIqcy1hO3Q9ZShsLGEsaSsxLzMpLHI9ZShsLGEsaSksbj1lKGwsYSxpLTEvMyl9cmV0dXJuW3QscixuXX0sdj17ZXhwb3J0czp7fX0seD12LmV4cG9ydHM7IWZ1bmN0aW9uKGUpe2lmKCJvYmplY3QiPT10eXBlb2YgeCYmdm9pZCAwIT09dil2LmV4cG9ydHM9ZSgpO2Vsc2UgaWYoImZ1bmN0aW9uIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZClkZWZpbmUoW10sZSk7ZWxzZXsoInVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3c/d2luZG93OiJ1bmRlZmluZWQiIT10eXBlb2YgZ2xvYmFsP2dsb2JhbDoidW5kZWZpbmVkIiE9dHlwZW9mIHNlbGY/c2VsZjp0aGlzKS5wYWtvPWUoKX19KChmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbiBlKHQscixuKXtmdW5jdGlvbiBhKG8scyl7aWYoIXJbb10pe2lmKCF0W29dKXt2YXIgbD0iZnVuY3Rpb24iPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighcyYmbClyZXR1cm4gbChvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcigiQ2Fubm90IGZpbmQgbW9kdWxlICciK28rIiciKTt0aHJvdyBmLmNvZGU9Ik1PRFVMRV9OT1RfRk9VTkQiLGZ9dmFyIGM9cltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGMuZXhwb3J0cywoZnVuY3Rpb24oZSl7cmV0dXJuIGEodFtvXVsxXVtlXXx8ZSl9KSxjLGMuZXhwb3J0cyxlLHQscixuKX1yZXR1cm4gcltvXS5leHBvcnRzfWZvcih2YXIgaT0iZnVuY3Rpb24iPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxvPTA7bzxuLmxlbmd0aDtvKyspYShuW29dKTtyZXR1cm4gYX0oezE6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj0idW5kZWZpbmVkIiE9dHlwZW9mIFVpbnQ4QXJyYXkmJiJ1bmRlZmluZWQiIT10eXBlb2YgVWludDE2QXJyYXkmJiJ1bmRlZmluZWQiIT10eXBlb2YgSW50MzJBcnJheTtmdW5jdGlvbiBhKGUsdCl7cmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLHQpfXIuYXNzaWduPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSk7dC5sZW5ndGg7KXt2YXIgcj10LnNoaWZ0KCk7aWYocil7aWYoIm9iamVjdCIhPXR5cGVvZiByKXRocm93IG5ldyBUeXBlRXJyb3IocisibXVzdCBiZSBub24tb2JqZWN0Iik7Zm9yKHZhciBuIGluIHIpYShyLG4pJiYoZVtuXT1yW25dKX19cmV0dXJuIGV9LHIuc2hyaW5rQnVmPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUubGVuZ3RoPT09dD9lOmUuc3ViYXJyYXk/ZS5zdWJhcnJheSgwLHQpOihlLmxlbmd0aD10LGUpfTt2YXIgaT17YXJyYXlTZXQ6ZnVuY3Rpb24oZSx0LHIsbixhKXtpZih0LnN1YmFycmF5JiZlLnN1YmFycmF5KWUuc2V0KHQuc3ViYXJyYXkocixyK24pLGEpO2Vsc2UgZm9yKHZhciBpPTA7aTxuO2krKyllW2EraV09dFtyK2ldfSxmbGF0dGVuQ2h1bmtzOmZ1bmN0aW9uKGUpe3ZhciB0LHIsbixhLGksbztmb3Iobj0wLHQ9MCxyPWUubGVuZ3RoO3Q8cjt0Kyspbis9ZVt0XS5sZW5ndGg7Zm9yKG89bmV3IFVpbnQ4QXJyYXkobiksYT0wLHQ9MCxyPWUubGVuZ3RoO3Q8cjt0KyspaT1lW3RdLG8uc2V0KGksYSksYSs9aS5sZW5ndGg7cmV0dXJuIG99fSxvPXthcnJheVNldDpmdW5jdGlvbihlLHQscixuLGEpe2Zvcih2YXIgaT0wO2k8bjtpKyspZVthK2ldPXRbcitpXX0sZmxhdHRlbkNodW5rczpmdW5jdGlvbihlKXtyZXR1cm5bXS5jb25jYXQuYXBwbHkoW10sZSl9fTtyLnNldFR5cGVkPWZ1bmN0aW9uKGUpe2U/KHIuQnVmOD1VaW50OEFycmF5LHIuQnVmMTY9VWludDE2QXJyYXksci5CdWYzMj1JbnQzMkFycmF5LHIuYXNzaWduKHIsaSkpOihyLkJ1Zjg9QXJyYXksci5CdWYxNj1BcnJheSxyLkJ1ZjMyPUFycmF5LHIuYXNzaWduKHIsbykpfSxyLnNldFR5cGVkKG4pfSx7fV0sMjpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vY29tbW9uIiksYT0hMCxpPSEwO3RyeXtTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsWzBdKX1jYXRjaChmKXthPSExfXRyeXtTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsbmV3IFVpbnQ4QXJyYXkoMSkpfWNhdGNoKGYpe2k9ITF9Zm9yKHZhciBvPW5ldyBuLkJ1ZjgoMjU2KSxzPTA7czwyNTY7cysrKW9bc109cz49MjUyPzY6cz49MjQ4PzU6cz49MjQwPzQ6cz49MjI0PzM6cz49MTkyPzI6MTtmdW5jdGlvbiBsKGUsdCl7aWYodDw2NTUzNCYmKGUuc3ViYXJyYXkmJml8fCFlLnN1YmFycmF5JiZhKSlyZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLG4uc2hyaW5rQnVmKGUsdCkpO2Zvcih2YXIgcj0iIixvPTA7bzx0O28rKylyKz1TdHJpbmcuZnJvbUNoYXJDb2RlKGVbb10pO3JldHVybiByfW9bMjU0XT1vWzI1NF09MSxyLnN0cmluZzJidWY9ZnVuY3Rpb24oZSl7dmFyIHQscixhLGksbyxzPWUubGVuZ3RoLGw9MDtmb3IoaT0wO2k8cztpKyspNTUyOTY9PSg2NDUxMiYocj1lLmNoYXJDb2RlQXQoaSkpKSYmaSsxPHMmJjU2MzIwPT0oNjQ1MTImKGE9ZS5jaGFyQ29kZUF0KGkrMSkpKSYmKHI9NjU1MzYrKHItNTUyOTY8PDEwKSsoYS01NjMyMCksaSsrKSxsKz1yPDEyOD8xOnI8MjA0OD8yOnI8NjU1MzY/Mzo0O2Zvcih0PW5ldyBuLkJ1ZjgobCksbz0wLGk9MDtvPGw7aSsrKTU1Mjk2PT0oNjQ1MTImKHI9ZS5jaGFyQ29kZUF0KGkpKSkmJmkrMTxzJiY1NjMyMD09KDY0NTEyJihhPWUuY2hhckNvZGVBdChpKzEpKSkmJihyPTY1NTM2KyhyLTU1Mjk2PDwxMCkrKGEtNTYzMjApLGkrKykscjwxMjg/dFtvKytdPXI6cjwyMDQ4Pyh0W28rK109MTkyfHI+Pj42LHRbbysrXT0xMjh8NjMmcik6cjw2NTUzNj8odFtvKytdPTIyNHxyPj4+MTIsdFtvKytdPTEyOHxyPj4+NiY2Myx0W28rK109MTI4fDYzJnIpOih0W28rK109MjQwfHI+Pj4xOCx0W28rK109MTI4fHI+Pj4xMiY2Myx0W28rK109MTI4fHI+Pj42JjYzLHRbbysrXT0xMjh8NjMmcik7cmV0dXJuIHR9LHIuYnVmMmJpbnN0cmluZz1mdW5jdGlvbihlKXtyZXR1cm4gbChlLGUubGVuZ3RoKX0sci5iaW5zdHJpbmcyYnVmPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1uZXcgbi5CdWY4KGUubGVuZ3RoKSxyPTAsYT10Lmxlbmd0aDtyPGE7cisrKXRbcl09ZS5jaGFyQ29kZUF0KHIpO3JldHVybiB0fSxyLmJ1ZjJzdHJpbmc9ZnVuY3Rpb24oZSx0KXt2YXIgcixuLGEsaSxzPXR8fGUubGVuZ3RoLGY9bmV3IEFycmF5KDIqcyk7Zm9yKG49MCxyPTA7cjxzOylpZigoYT1lW3IrK10pPDEyOClmW24rK109YTtlbHNlIGlmKChpPW9bYV0pPjQpZltuKytdPTY1NTMzLHIrPWktMTtlbHNle2ZvcihhJj0yPT09aT8zMTozPT09aT8xNTo3O2k+MSYmcjxzOylhPWE8PDZ8NjMmZVtyKytdLGktLTtpPjE/ZltuKytdPTY1NTMzOmE8NjU1MzY/ZltuKytdPWE6KGEtPTY1NTM2LGZbbisrXT01NTI5NnxhPj4xMCYxMDIzLGZbbisrXT01NjMyMHwxMDIzJmEpfXJldHVybiBsKGYsbil9LHIudXRmOGJvcmRlcj1mdW5jdGlvbihlLHQpe3ZhciByO2ZvcigodD10fHxlLmxlbmd0aCk+ZS5sZW5ndGgmJih0PWUubGVuZ3RoKSxyPXQtMTtyPj0wJiYxMjg9PSgxOTImZVtyXSk7KXItLTtyZXR1cm4gcjwwfHwwPT09cj90OnIrb1tlW3JdXT50P3I6dH19LHsiLi9jb21tb24iOjF9XSwzOltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCxyLG4pe2Zvcih2YXIgYT02NTUzNSZlfDAsaT1lPj4+MTYmNjU1MzV8MCxvPTA7MCE9PXI7KXtyLT1vPXI+MmUzPzJlMzpyO2Rve2k9aSsoYT1hK3RbbisrXXwwKXwwfXdoaWxlKC0tbyk7YSU9NjU1MjEsaSU9NjU1MjF9cmV0dXJuIGF8aTw8MTZ8MH19LHt9XSw0OltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPXtaX05PX0ZMVVNIOjAsWl9QQVJUSUFMX0ZMVVNIOjEsWl9TWU5DX0ZMVVNIOjIsWl9GVUxMX0ZMVVNIOjMsWl9GSU5JU0g6NCxaX0JMT0NLOjUsWl9UUkVFUzo2LFpfT0s6MCxaX1NUUkVBTV9FTkQ6MSxaX05FRURfRElDVDoyLFpfRVJSTk86LTEsWl9TVFJFQU1fRVJST1I6LTIsWl9EQVRBX0VSUk9SOi0zLFpfQlVGX0VSUk9SOi01LFpfTk9fQ09NUFJFU1NJT046MCxaX0JFU1RfU1BFRUQ6MSxaX0JFU1RfQ09NUFJFU1NJT046OSxaX0RFRkFVTFRfQ09NUFJFU1NJT046LTEsWl9GSUxURVJFRDoxLFpfSFVGRk1BTl9PTkxZOjIsWl9STEU6MyxaX0ZJWEVEOjQsWl9ERUZBVUxUX1NUUkFURUdZOjAsWl9CSU5BUlk6MCxaX1RFWFQ6MSxaX1VOS05PV046MixaX0RFRkxBVEVEOjh9fSx7fV0sNTpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWZ1bmN0aW9uKCl7Zm9yKHZhciBlLHQ9W10scj0wO3I8MjU2O3IrKyl7ZT1yO2Zvcih2YXIgbj0wO248ODtuKyspZT0xJmU/Mzk4ODI5MjM4NF5lPj4+MTplPj4+MTt0W3JdPWV9cmV0dXJuIHR9KCk7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCxyLGEpe3ZhciBpPW4sbz1hK3I7ZV49LTE7Zm9yKHZhciBzPWE7czxvO3MrKyllPWU+Pj44XmlbMjU1JihlXnRbc10pXTtyZXR1cm4tMV5lfX0se31dLDY6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9ZnVuY3Rpb24oKXt0aGlzLnRleHQ9MCx0aGlzLnRpbWU9MCx0aGlzLnhmbGFncz0wLHRoaXMub3M9MCx0aGlzLmV4dHJhPW51bGwsdGhpcy5leHRyYV9sZW49MCx0aGlzLm5hbWU9IiIsdGhpcy5jb21tZW50PSIiLHRoaXMuaGNyYz0wLHRoaXMuZG9uZT0hMX19LHt9XSw3OltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7dmFyIHIsbixhLGksbyxzLGwsZixjLHUsZCxoLG0sYix3LGcscCxrLHksXyx2LHgsQSxTLEU7cj1lLnN0YXRlLG49ZS5uZXh0X2luLFM9ZS5pbnB1dCxhPW4rKGUuYXZhaWxfaW4tNSksaT1lLm5leHRfb3V0LEU9ZS5vdXRwdXQsbz1pLSh0LWUuYXZhaWxfb3V0KSxzPWkrKGUuYXZhaWxfb3V0LTI1NyksbD1yLmRtYXgsZj1yLndzaXplLGM9ci53aGF2ZSx1PXIud25leHQsZD1yLndpbmRvdyxoPXIuaG9sZCxtPXIuYml0cyxiPXIubGVuY29kZSx3PXIuZGlzdGNvZGUsZz0oMTw8ci5sZW5iaXRzKS0xLHA9KDE8PHIuZGlzdGJpdHMpLTE7ZTpkb3ttPDE1JiYoaCs9U1tuKytdPDxtLG0rPTgsaCs9U1tuKytdPDxtLG0rPTgpLGs9YltoJmddO3Q6Zm9yKDs7KXtpZihoPj4+PXk9az4+PjI0LG0tPXksMD09PSh5PWs+Pj4xNiYyNTUpKUVbaSsrXT02NTUzNSZrO2Vsc2V7aWYoISgxNiZ5KSl7aWYoMD09KDY0JnkpKXtrPWJbKDY1NTM1JmspKyhoJigxPDx5KS0xKV07Y29udGludWUgdH1pZigzMiZ5KXtyLm1vZGU9MTI7YnJlYWsgZX1lLm1zZz0iaW52YWxpZCBsaXRlcmFsL2xlbmd0aCBjb2RlIixyLm1vZGU9MzA7YnJlYWsgZX1fPTY1NTM1JmssKHkmPTE1KSYmKG08eSYmKGgrPVNbbisrXTw8bSxtKz04KSxfKz1oJigxPDx5KS0xLGg+Pj49eSxtLT15KSxtPDE1JiYoaCs9U1tuKytdPDxtLG0rPTgsaCs9U1tuKytdPDxtLG0rPTgpLGs9d1toJnBdO3I6Zm9yKDs7KXtpZihoPj4+PXk9az4+PjI0LG0tPXksISgxNiYoeT1rPj4+MTYmMjU1KSkpe2lmKDA9PSg2NCZ5KSl7az13Wyg2NTUzNSZrKSsoaCYoMTw8eSktMSldO2NvbnRpbnVlIHJ9ZS5tc2c9ImludmFsaWQgZGlzdGFuY2UgY29kZSIsci5tb2RlPTMwO2JyZWFrIGV9aWYodj02NTUzNSZrLG08KHkmPTE1KSYmKGgrPVNbbisrXTw8bSwobSs9OCk8eSYmKGgrPVNbbisrXTw8bSxtKz04KSksKHYrPWgmKDE8PHkpLTEpPmwpe2UubXNnPSJpbnZhbGlkIGRpc3RhbmNlIHRvbyBmYXIgYmFjayIsci5tb2RlPTMwO2JyZWFrIGV9aWYoaD4+Pj15LG0tPXksdj4oeT1pLW8pKXtpZigoeT12LXkpPmMmJnIuc2FuZSl7ZS5tc2c9ImludmFsaWQgZGlzdGFuY2UgdG9vIGZhciBiYWNrIixyLm1vZGU9MzA7YnJlYWsgZX1pZih4PTAsQT1kLDA9PT11KXtpZih4Kz1mLXkseTxfKXtfLT15O2Rve0VbaSsrXT1kW3grK119d2hpbGUoLS15KTt4PWktdixBPUV9fWVsc2UgaWYodTx5KXtpZih4Kz1mK3UteSwoeS09dSk8Xyl7Xy09eTtkb3tFW2krK109ZFt4KytdfXdoaWxlKC0teSk7aWYoeD0wLHU8Xyl7Xy09eT11O2Rve0VbaSsrXT1kW3grK119d2hpbGUoLS15KTt4PWktdixBPUV9fX1lbHNlIGlmKHgrPXUteSx5PF8pe18tPXk7ZG97RVtpKytdPWRbeCsrXX13aGlsZSgtLXkpO3g9aS12LEE9RX1mb3IoO18+MjspRVtpKytdPUFbeCsrXSxFW2krK109QVt4KytdLEVbaSsrXT1BW3grK10sXy09MztfJiYoRVtpKytdPUFbeCsrXSxfPjEmJihFW2krK109QVt4KytdKSl9ZWxzZXt4PWktdjtkb3tFW2krK109RVt4KytdLEVbaSsrXT1FW3grK10sRVtpKytdPUVbeCsrXSxfLT0zfXdoaWxlKF8+Mik7XyYmKEVbaSsrXT1FW3grK10sXz4xJiYoRVtpKytdPUVbeCsrXSkpfWJyZWFrfX1icmVha319d2hpbGUobjxhJiZpPHMpO24tPV89bT4+MyxoJj0oMTw8KG0tPV88PDMpKS0xLGUubmV4dF9pbj1uLGUubmV4dF9vdXQ9aSxlLmF2YWlsX2luPW48YT9hLW4rNTo1LShuLWEpLGUuYXZhaWxfb3V0PWk8cz9zLWkrMjU3OjI1Ny0oaS1zKSxyLmhvbGQ9aCxyLmJpdHM9bX19LHt9XSw4OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi4vdXRpbHMvY29tbW9uIiksYT1lKCIuL2FkbGVyMzIiKSxpPWUoIi4vY3JjMzIiKSxvPWUoIi4vaW5mZmFzdCIpLHM9ZSgiLi9pbmZ0cmVlcyIpLGw9LTIsZj0xMixjPTMwO2Z1bmN0aW9uIHUoZSl7cmV0dXJuKGU+Pj4yNCYyNTUpKyhlPj4+OCY2NTI4MCkrKCg2NTI4MCZlKTw8OCkrKCgyNTUmZSk8PDI0KX1mdW5jdGlvbiBkKCl7dGhpcy5tb2RlPTAsdGhpcy5sYXN0PSExLHRoaXMud3JhcD0wLHRoaXMuaGF2ZWRpY3Q9ITEsdGhpcy5mbGFncz0wLHRoaXMuZG1heD0wLHRoaXMuY2hlY2s9MCx0aGlzLnRvdGFsPTAsdGhpcy5oZWFkPW51bGwsdGhpcy53Yml0cz0wLHRoaXMud3NpemU9MCx0aGlzLndoYXZlPTAsdGhpcy53bmV4dD0wLHRoaXMud2luZG93PW51bGwsdGhpcy5ob2xkPTAsdGhpcy5iaXRzPTAsdGhpcy5sZW5ndGg9MCx0aGlzLm9mZnNldD0wLHRoaXMuZXh0cmE9MCx0aGlzLmxlbmNvZGU9bnVsbCx0aGlzLmRpc3Rjb2RlPW51bGwsdGhpcy5sZW5iaXRzPTAsdGhpcy5kaXN0Yml0cz0wLHRoaXMubmNvZGU9MCx0aGlzLm5sZW49MCx0aGlzLm5kaXN0PTAsdGhpcy5oYXZlPTAsdGhpcy5uZXh0PW51bGwsdGhpcy5sZW5zPW5ldyBuLkJ1ZjE2KDMyMCksdGhpcy53b3JrPW5ldyBuLkJ1ZjE2KDI4OCksdGhpcy5sZW5keW49bnVsbCx0aGlzLmRpc3RkeW49bnVsbCx0aGlzLnNhbmU9MCx0aGlzLmJhY2s9MCx0aGlzLndhcz0wfWZ1bmN0aW9uIGgoZSl7dmFyIHQ7cmV0dXJuIGUmJmUuc3RhdGU/KHQ9ZS5zdGF0ZSxlLnRvdGFsX2luPWUudG90YWxfb3V0PXQudG90YWw9MCxlLm1zZz0iIix0LndyYXAmJihlLmFkbGVyPTEmdC53cmFwKSx0Lm1vZGU9MSx0Lmxhc3Q9MCx0LmhhdmVkaWN0PTAsdC5kbWF4PTMyNzY4LHQuaGVhZD1udWxsLHQuaG9sZD0wLHQuYml0cz0wLHQubGVuY29kZT10LmxlbmR5bj1uZXcgbi5CdWYzMig4NTIpLHQuZGlzdGNvZGU9dC5kaXN0ZHluPW5ldyBuLkJ1ZjMyKDU5MiksdC5zYW5lPTEsdC5iYWNrPS0xLDApOmx9ZnVuY3Rpb24gbShlKXt2YXIgdDtyZXR1cm4gZSYmZS5zdGF0ZT8oKHQ9ZS5zdGF0ZSkud3NpemU9MCx0LndoYXZlPTAsdC53bmV4dD0wLGgoZSkpOmx9ZnVuY3Rpb24gYihlLHQpe3ZhciByLG47cmV0dXJuIGUmJmUuc3RhdGU/KG49ZS5zdGF0ZSx0PDA/KHI9MCx0PS10KToocj0xKyh0Pj40KSx0PDQ4JiYodCY9MTUpKSx0JiYodDw4fHx0PjE1KT9sOihudWxsIT09bi53aW5kb3cmJm4ud2JpdHMhPT10JiYobi53aW5kb3c9bnVsbCksbi53cmFwPXIsbi53Yml0cz10LG0oZSkpKTpsfWZ1bmN0aW9uIHcoZSx0KXt2YXIgcixuO3JldHVybiBlPyhuPW5ldyBkLGUuc3RhdGU9bixuLndpbmRvdz1udWxsLDAhPT0ocj1iKGUsdCkpJiYoZS5zdGF0ZT1udWxsKSxyKTpsfXZhciBnLHAsaz0hMDtmdW5jdGlvbiB5KGUpe2lmKGspe3ZhciB0O2ZvcihnPW5ldyBuLkJ1ZjMyKDUxMikscD1uZXcgbi5CdWYzMigzMiksdD0wO3Q8MTQ0OyllLmxlbnNbdCsrXT04O2Zvcig7dDwyNTY7KWUubGVuc1t0KytdPTk7Zm9yKDt0PDI4MDspZS5sZW5zW3QrK109Nztmb3IoO3Q8Mjg4OyllLmxlbnNbdCsrXT04O2ZvcihzKDEsZS5sZW5zLDAsMjg4LGcsMCxlLndvcmsse2JpdHM6OX0pLHQ9MDt0PDMyOyllLmxlbnNbdCsrXT01O3MoMixlLmxlbnMsMCwzMixwLDAsZS53b3JrLHtiaXRzOjV9KSxrPSExfWUubGVuY29kZT1nLGUubGVuYml0cz05LGUuZGlzdGNvZGU9cCxlLmRpc3RiaXRzPTV9ZnVuY3Rpb24gXyhlLHQscixhKXt2YXIgaSxvPWUuc3RhdGU7cmV0dXJuIG51bGw9PT1vLndpbmRvdyYmKG8ud3NpemU9MTw8by53Yml0cyxvLnduZXh0PTAsby53aGF2ZT0wLG8ud2luZG93PW5ldyBuLkJ1Zjgoby53c2l6ZSkpLGE+PW8ud3NpemU/KG4uYXJyYXlTZXQoby53aW5kb3csdCxyLW8ud3NpemUsby53c2l6ZSwwKSxvLnduZXh0PTAsby53aGF2ZT1vLndzaXplKTooKGk9by53c2l6ZS1vLnduZXh0KT5hJiYoaT1hKSxuLmFycmF5U2V0KG8ud2luZG93LHQsci1hLGksby53bmV4dCksKGEtPWkpPyhuLmFycmF5U2V0KG8ud2luZG93LHQsci1hLGEsMCksby53bmV4dD1hLG8ud2hhdmU9by53c2l6ZSk6KG8ud25leHQrPWksby53bmV4dD09PW8ud3NpemUmJihvLnduZXh0PTApLG8ud2hhdmU8by53c2l6ZSYmKG8ud2hhdmUrPWkpKSksMH1yLmluZmxhdGVSZXNldD1tLHIuaW5mbGF0ZVJlc2V0Mj1iLHIuaW5mbGF0ZVJlc2V0S2VlcD1oLHIuaW5mbGF0ZUluaXQ9ZnVuY3Rpb24oZSl7cmV0dXJuIHcoZSwxNSl9LHIuaW5mbGF0ZUluaXQyPXcsci5pbmZsYXRlPWZ1bmN0aW9uKGUsdCl7dmFyIHIsZCxoLG0sYix3LGcscCxrLHYseCxBLFMsRSxCLFUsSSxPLFosQyxSLE4sRixULHo9MCxEPW5ldyBuLkJ1ZjgoNCksTT1bMTYsMTcsMTgsMCw4LDcsOSw2LDEwLDUsMTEsNCwxMiwzLDEzLDIsMTQsMSwxNV07aWYoIWV8fCFlLnN0YXRlfHwhZS5vdXRwdXR8fCFlLmlucHV0JiYwIT09ZS5hdmFpbF9pbilyZXR1cm4gbDsocj1lLnN0YXRlKS5tb2RlPT09ZiYmKHIubW9kZT0xMyksYj1lLm5leHRfb3V0LGg9ZS5vdXRwdXQsZz1lLmF2YWlsX291dCxtPWUubmV4dF9pbixkPWUuaW5wdXQsdz1lLmF2YWlsX2luLHA9ci5ob2xkLGs9ci5iaXRzLHY9dyx4PWcsTj0wO2U6Zm9yKDs7KXN3aXRjaChyLm1vZGUpe2Nhc2UgMTppZigwPT09ci53cmFwKXtyLm1vZGU9MTM7YnJlYWt9Zm9yKDtrPDE2Oyl7aWYoMD09PXcpYnJlYWsgZTt3LS0scCs9ZFttKytdPDxrLGsrPTh9aWYoMiZyLndyYXAmJjM1NjE1PT09cCl7ci5jaGVjaz0wLERbMF09MjU1JnAsRFsxXT1wPj4+OCYyNTUsci5jaGVjaz1pKHIuY2hlY2ssRCwyLDApLHA9MCxrPTAsci5tb2RlPTI7YnJlYWt9aWYoci5mbGFncz0wLHIuaGVhZCYmKHIuaGVhZC5kb25lPSExKSwhKDEmci53cmFwKXx8KCgoMjU1JnApPDw4KSsocD4+OCkpJTMxKXtlLm1zZz0iaW5jb3JyZWN0IGhlYWRlciBjaGVjayIsci5tb2RlPWM7YnJlYWt9aWYoOCE9KDE1JnApKXtlLm1zZz0idW5rbm93biBjb21wcmVzc2lvbiBtZXRob2QiLHIubW9kZT1jO2JyZWFrfWlmKGstPTQsUj04KygxNSYocD4+Pj00KSksMD09PXIud2JpdHMpci53Yml0cz1SO2Vsc2UgaWYoUj5yLndiaXRzKXtlLm1zZz0iaW52YWxpZCB3aW5kb3cgc2l6ZSIsci5tb2RlPWM7YnJlYWt9ci5kbWF4PTE8PFIsZS5hZGxlcj1yLmNoZWNrPTEsci5tb2RlPTUxMiZwPzEwOmYscD0wLGs9MDticmVhaztjYXNlIDI6Zm9yKDtrPDE2Oyl7aWYoMD09PXcpYnJlYWsgZTt3LS0scCs9ZFttKytdPDxrLGsrPTh9aWYoci5mbGFncz1wLDghPSgyNTUmci5mbGFncykpe2UubXNnPSJ1bmtub3duIGNvbXByZXNzaW9uIG1ldGhvZCIsci5tb2RlPWM7YnJlYWt9aWYoNTczNDQmci5mbGFncyl7ZS5tc2c9InVua25vd24gaGVhZGVyIGZsYWdzIHNldCIsci5tb2RlPWM7YnJlYWt9ci5oZWFkJiYoci5oZWFkLnRleHQ9cD4+OCYxKSw1MTImci5mbGFncyYmKERbMF09MjU1JnAsRFsxXT1wPj4+OCYyNTUsci5jaGVjaz1pKHIuY2hlY2ssRCwyLDApKSxwPTAsaz0wLHIubW9kZT0zO2Nhc2UgMzpmb3IoO2s8MzI7KXtpZigwPT09dylicmVhayBlO3ctLSxwKz1kW20rK108PGssays9OH1yLmhlYWQmJihyLmhlYWQudGltZT1wKSw1MTImci5mbGFncyYmKERbMF09MjU1JnAsRFsxXT1wPj4+OCYyNTUsRFsyXT1wPj4+MTYmMjU1LERbM109cD4+PjI0JjI1NSxyLmNoZWNrPWkoci5jaGVjayxELDQsMCkpLHA9MCxrPTAsci5tb2RlPTQ7Y2FzZSA0OmZvcig7azwxNjspe2lmKDA9PT13KWJyZWFrIGU7dy0tLHArPWRbbSsrXTw8ayxrKz04fXIuaGVhZCYmKHIuaGVhZC54ZmxhZ3M9MjU1JnAsci5oZWFkLm9zPXA+PjgpLDUxMiZyLmZsYWdzJiYoRFswXT0yNTUmcCxEWzFdPXA+Pj44JjI1NSxyLmNoZWNrPWkoci5jaGVjayxELDIsMCkpLHA9MCxrPTAsci5tb2RlPTU7Y2FzZSA1OmlmKDEwMjQmci5mbGFncyl7Zm9yKDtrPDE2Oyl7aWYoMD09PXcpYnJlYWsgZTt3LS0scCs9ZFttKytdPDxrLGsrPTh9ci5sZW5ndGg9cCxyLmhlYWQmJihyLmhlYWQuZXh0cmFfbGVuPXApLDUxMiZyLmZsYWdzJiYoRFswXT0yNTUmcCxEWzFdPXA+Pj44JjI1NSxyLmNoZWNrPWkoci5jaGVjayxELDIsMCkpLHA9MCxrPTB9ZWxzZSByLmhlYWQmJihyLmhlYWQuZXh0cmE9bnVsbCk7ci5tb2RlPTY7Y2FzZSA2OmlmKDEwMjQmci5mbGFncyYmKChBPXIubGVuZ3RoKT53JiYoQT13KSxBJiYoci5oZWFkJiYoUj1yLmhlYWQuZXh0cmFfbGVuLXIubGVuZ3RoLHIuaGVhZC5leHRyYXx8KHIuaGVhZC5leHRyYT1uZXcgQXJyYXkoci5oZWFkLmV4dHJhX2xlbikpLG4uYXJyYXlTZXQoci5oZWFkLmV4dHJhLGQsbSxBLFIpKSw1MTImci5mbGFncyYmKHIuY2hlY2s9aShyLmNoZWNrLGQsQSxtKSksdy09QSxtKz1BLHIubGVuZ3RoLT1BKSxyLmxlbmd0aCkpYnJlYWsgZTtyLmxlbmd0aD0wLHIubW9kZT03O2Nhc2UgNzppZigyMDQ4JnIuZmxhZ3Mpe2lmKDA9PT13KWJyZWFrIGU7QT0wO2Rve1I9ZFttK0ErK10sci5oZWFkJiZSJiZyLmxlbmd0aDw2NTUzNiYmKHIuaGVhZC5uYW1lKz1TdHJpbmcuZnJvbUNoYXJDb2RlKFIpKX13aGlsZShSJiZBPHcpO2lmKDUxMiZyLmZsYWdzJiYoci5jaGVjaz1pKHIuY2hlY2ssZCxBLG0pKSx3LT1BLG0rPUEsUilicmVhayBlfWVsc2Ugci5oZWFkJiYoci5oZWFkLm5hbWU9bnVsbCk7ci5sZW5ndGg9MCxyLm1vZGU9ODtjYXNlIDg6aWYoNDA5NiZyLmZsYWdzKXtpZigwPT09dylicmVhayBlO0E9MDtkb3tSPWRbbStBKytdLHIuaGVhZCYmUiYmci5sZW5ndGg8NjU1MzYmJihyLmhlYWQuY29tbWVudCs9U3RyaW5nLmZyb21DaGFyQ29kZShSKSl9d2hpbGUoUiYmQTx3KTtpZig1MTImci5mbGFncyYmKHIuY2hlY2s9aShyLmNoZWNrLGQsQSxtKSksdy09QSxtKz1BLFIpYnJlYWsgZX1lbHNlIHIuaGVhZCYmKHIuaGVhZC5jb21tZW50PW51bGwpO3IubW9kZT05O2Nhc2UgOTppZig1MTImci5mbGFncyl7Zm9yKDtrPDE2Oyl7aWYoMD09PXcpYnJlYWsgZTt3LS0scCs9ZFttKytdPDxrLGsrPTh9aWYocCE9PSg2NTUzNSZyLmNoZWNrKSl7ZS5tc2c9ImhlYWRlciBjcmMgbWlzbWF0Y2giLHIubW9kZT1jO2JyZWFrfXA9MCxrPTB9ci5oZWFkJiYoci5oZWFkLmhjcmM9ci5mbGFncz4+OSYxLHIuaGVhZC5kb25lPSEwKSxlLmFkbGVyPXIuY2hlY2s9MCxyLm1vZGU9ZjticmVhaztjYXNlIDEwOmZvcig7azwzMjspe2lmKDA9PT13KWJyZWFrIGU7dy0tLHArPWRbbSsrXTw8ayxrKz04fWUuYWRsZXI9ci5jaGVjaz11KHApLHA9MCxrPTAsci5tb2RlPTExO2Nhc2UgMTE6aWYoMD09PXIuaGF2ZWRpY3QpcmV0dXJuIGUubmV4dF9vdXQ9YixlLmF2YWlsX291dD1nLGUubmV4dF9pbj1tLGUuYXZhaWxfaW49dyxyLmhvbGQ9cCxyLmJpdHM9aywyO2UuYWRsZXI9ci5jaGVjaz0xLHIubW9kZT1mO2Nhc2UgZjppZig1PT09dHx8Nj09PXQpYnJlYWsgZTtjYXNlIDEzOmlmKHIubGFzdCl7cD4+Pj03Jmssay09NyZrLHIubW9kZT0yNzticmVha31mb3IoO2s8Mzspe2lmKDA9PT13KWJyZWFrIGU7dy0tLHArPWRbbSsrXTw8ayxrKz04fXN3aXRjaChyLmxhc3Q9MSZwLGstPTEsMyYocD4+Pj0xKSl7Y2FzZSAwOnIubW9kZT0xNDticmVhaztjYXNlIDE6aWYoeShyKSxyLm1vZGU9MjAsNj09PXQpe3A+Pj49MixrLT0yO2JyZWFrIGV9YnJlYWs7Y2FzZSAyOnIubW9kZT0xNzticmVhaztjYXNlIDM6ZS5tc2c9ImludmFsaWQgYmxvY2sgdHlwZSIsci5tb2RlPWN9cD4+Pj0yLGstPTI7YnJlYWs7Y2FzZSAxNDpmb3IocD4+Pj03Jmssay09NyZrO2s8MzI7KXtpZigwPT09dylicmVhayBlO3ctLSxwKz1kW20rK108PGssays9OH1pZigoNjU1MzUmcCkhPShwPj4+MTZeNjU1MzUpKXtlLm1zZz0iaW52YWxpZCBzdG9yZWQgYmxvY2sgbGVuZ3RocyIsci5tb2RlPWM7YnJlYWt9aWYoci5sZW5ndGg9NjU1MzUmcCxwPTAsaz0wLHIubW9kZT0xNSw2PT09dClicmVhayBlO2Nhc2UgMTU6ci5tb2RlPTE2O2Nhc2UgMTY6aWYoQT1yLmxlbmd0aCl7aWYoQT53JiYoQT13KSxBPmcmJihBPWcpLDA9PT1BKWJyZWFrIGU7bi5hcnJheVNldChoLGQsbSxBLGIpLHctPUEsbSs9QSxnLT1BLGIrPUEsci5sZW5ndGgtPUE7YnJlYWt9ci5tb2RlPWY7YnJlYWs7Y2FzZSAxNzpmb3IoO2s8MTQ7KXtpZigwPT09dylicmVhayBlO3ctLSxwKz1kW20rK108PGssays9OH1pZihyLm5sZW49MjU3KygzMSZwKSxwPj4+PTUsay09NSxyLm5kaXN0PTErKDMxJnApLHA+Pj49NSxrLT01LHIubmNvZGU9NCsoMTUmcCkscD4+Pj00LGstPTQsci5ubGVuPjI4Nnx8ci5uZGlzdD4zMCl7ZS5tc2c9InRvbyBtYW55IGxlbmd0aCBvciBkaXN0YW5jZSBzeW1ib2xzIixyLm1vZGU9YzticmVha31yLmhhdmU9MCxyLm1vZGU9MTg7Y2FzZSAxODpmb3IoO3IuaGF2ZTxyLm5jb2RlOyl7Zm9yKDtrPDM7KXtpZigwPT09dylicmVhayBlO3ctLSxwKz1kW20rK108PGssays9OH1yLmxlbnNbTVtyLmhhdmUrK11dPTcmcCxwPj4+PTMsay09M31mb3IoO3IuaGF2ZTwxOTspci5sZW5zW01bci5oYXZlKytdXT0wO2lmKHIubGVuY29kZT1yLmxlbmR5bixyLmxlbmJpdHM9NyxGPXtiaXRzOnIubGVuYml0c30sTj1zKDAsci5sZW5zLDAsMTksci5sZW5jb2RlLDAsci53b3JrLEYpLHIubGVuYml0cz1GLmJpdHMsTil7ZS5tc2c9ImludmFsaWQgY29kZSBsZW5ndGhzIHNldCIsci5tb2RlPWM7YnJlYWt9ci5oYXZlPTAsci5tb2RlPTE5O2Nhc2UgMTk6Zm9yKDtyLmhhdmU8ci5ubGVuK3IubmRpc3Q7KXtmb3IoO1U9KHo9ci5sZW5jb2RlW3AmKDE8PHIubGVuYml0cyktMV0pPj4+MTYmMjU1LEk9NjU1MzUmeiwhKChCPXo+Pj4yNCk8PWspOyl7aWYoMD09PXcpYnJlYWsgZTt3LS0scCs9ZFttKytdPDxrLGsrPTh9aWYoSTwxNilwPj4+PUIsay09QixyLmxlbnNbci5oYXZlKytdPUk7ZWxzZXtpZigxNj09PUkpe2ZvcihUPUIrMjtrPFQ7KXtpZigwPT09dylicmVhayBlO3ctLSxwKz1kW20rK108PGssays9OH1pZihwPj4+PUIsay09QiwwPT09ci5oYXZlKXtlLm1zZz0iaW52YWxpZCBiaXQgbGVuZ3RoIHJlcGVhdCIsci5tb2RlPWM7YnJlYWt9Uj1yLmxlbnNbci5oYXZlLTFdLEE9MysoMyZwKSxwPj4+PTIsay09Mn1lbHNlIGlmKDE3PT09SSl7Zm9yKFQ9QiszO2s8VDspe2lmKDA9PT13KWJyZWFrIGU7dy0tLHArPWRbbSsrXTw8ayxrKz04fWstPUIsUj0wLEE9MysoNyYocD4+Pj1CKSkscD4+Pj0zLGstPTN9ZWxzZXtmb3IoVD1CKzc7azxUOyl7aWYoMD09PXcpYnJlYWsgZTt3LS0scCs9ZFttKytdPDxrLGsrPTh9ay09QixSPTAsQT0xMSsoMTI3JihwPj4+PUIpKSxwPj4+PTcsay09N31pZihyLmhhdmUrQT5yLm5sZW4rci5uZGlzdCl7ZS5tc2c9ImludmFsaWQgYml0IGxlbmd0aCByZXBlYXQiLHIubW9kZT1jO2JyZWFrfWZvcig7QS0tOylyLmxlbnNbci5oYXZlKytdPVJ9fWlmKHIubW9kZT09PWMpYnJlYWs7aWYoMD09PXIubGVuc1syNTZdKXtlLm1zZz0iaW52YWxpZCBjb2RlIC0tIG1pc3NpbmcgZW5kLW9mLWJsb2NrIixyLm1vZGU9YzticmVha31pZihyLmxlbmJpdHM9OSxGPXtiaXRzOnIubGVuYml0c30sTj1zKDEsci5sZW5zLDAsci5ubGVuLHIubGVuY29kZSwwLHIud29yayxGKSxyLmxlbmJpdHM9Ri5iaXRzLE4pe2UubXNnPSJpbnZhbGlkIGxpdGVyYWwvbGVuZ3RocyBzZXQiLHIubW9kZT1jO2JyZWFrfWlmKHIuZGlzdGJpdHM9NixyLmRpc3Rjb2RlPXIuZGlzdGR5bixGPXtiaXRzOnIuZGlzdGJpdHN9LE49cygyLHIubGVucyxyLm5sZW4sci5uZGlzdCxyLmRpc3Rjb2RlLDAsci53b3JrLEYpLHIuZGlzdGJpdHM9Ri5iaXRzLE4pe2UubXNnPSJpbnZhbGlkIGRpc3RhbmNlcyBzZXQiLHIubW9kZT1jO2JyZWFrfWlmKHIubW9kZT0yMCw2PT09dClicmVhayBlO2Nhc2UgMjA6ci5tb2RlPTIxO2Nhc2UgMjE6aWYodz49NiYmZz49MjU4KXtlLm5leHRfb3V0PWIsZS5hdmFpbF9vdXQ9ZyxlLm5leHRfaW49bSxlLmF2YWlsX2luPXcsci5ob2xkPXAsci5iaXRzPWssbyhlLHgpLGI9ZS5uZXh0X291dCxoPWUub3V0cHV0LGc9ZS5hdmFpbF9vdXQsbT1lLm5leHRfaW4sZD1lLmlucHV0LHc9ZS5hdmFpbF9pbixwPXIuaG9sZCxrPXIuYml0cyxyLm1vZGU9PT1mJiYoci5iYWNrPS0xKTticmVha31mb3Ioci5iYWNrPTA7VT0oej1yLmxlbmNvZGVbcCYoMTw8ci5sZW5iaXRzKS0xXSk+Pj4xNiYyNTUsST02NTUzNSZ6LCEoKEI9ej4+PjI0KTw9ayk7KXtpZigwPT09dylicmVhayBlO3ctLSxwKz1kW20rK108PGssays9OH1pZihVJiYwPT0oMjQwJlUpKXtmb3IoTz1CLFo9VSxDPUk7VT0oej1yLmxlbmNvZGVbQysoKHAmKDE8PE8rWiktMSk+Pk8pXSk+Pj4xNiYyNTUsST02NTUzNSZ6LCEoTysoQj16Pj4+MjQpPD1rKTspe2lmKDA9PT13KWJyZWFrIGU7dy0tLHArPWRbbSsrXTw8ayxrKz04fXA+Pj49TyxrLT1PLHIuYmFjays9T31pZihwPj4+PUIsay09QixyLmJhY2srPUIsci5sZW5ndGg9SSwwPT09VSl7ci5tb2RlPTI2O2JyZWFrfWlmKDMyJlUpe3IuYmFjaz0tMSxyLm1vZGU9ZjticmVha31pZig2NCZVKXtlLm1zZz0iaW52YWxpZCBsaXRlcmFsL2xlbmd0aCBjb2RlIixyLm1vZGU9YzticmVha31yLmV4dHJhPTE1JlUsci5tb2RlPTIyO2Nhc2UgMjI6aWYoci5leHRyYSl7Zm9yKFQ9ci5leHRyYTtrPFQ7KXtpZigwPT09dylicmVhayBlO3ctLSxwKz1kW20rK108PGssays9OH1yLmxlbmd0aCs9cCYoMTw8ci5leHRyYSktMSxwPj4+PXIuZXh0cmEsay09ci5leHRyYSxyLmJhY2srPXIuZXh0cmF9ci53YXM9ci5sZW5ndGgsci5tb2RlPTIzO2Nhc2UgMjM6Zm9yKDtVPSh6PXIuZGlzdGNvZGVbcCYoMTw8ci5kaXN0Yml0cyktMV0pPj4+MTYmMjU1LEk9NjU1MzUmeiwhKChCPXo+Pj4yNCk8PWspOyl7aWYoMD09PXcpYnJlYWsgZTt3LS0scCs9ZFttKytdPDxrLGsrPTh9aWYoMD09KDI0MCZVKSl7Zm9yKE89QixaPVUsQz1JO1U9KHo9ci5kaXN0Y29kZVtDKygocCYoMTw8TytaKS0xKT4+TyldKT4+PjE2JjI1NSxJPTY1NTM1JnosIShPKyhCPXo+Pj4yNCk8PWspOyl7aWYoMD09PXcpYnJlYWsgZTt3LS0scCs9ZFttKytdPDxrLGsrPTh9cD4+Pj1PLGstPU8sci5iYWNrKz1PfWlmKHA+Pj49QixrLT1CLHIuYmFjays9Qiw2NCZVKXtlLm1zZz0iaW52YWxpZCBkaXN0YW5jZSBjb2RlIixyLm1vZGU9YzticmVha31yLm9mZnNldD1JLHIuZXh0cmE9MTUmVSxyLm1vZGU9MjQ7Y2FzZSAyNDppZihyLmV4dHJhKXtmb3IoVD1yLmV4dHJhO2s8VDspe2lmKDA9PT13KWJyZWFrIGU7dy0tLHArPWRbbSsrXTw8ayxrKz04fXIub2Zmc2V0Kz1wJigxPDxyLmV4dHJhKS0xLHA+Pj49ci5leHRyYSxrLT1yLmV4dHJhLHIuYmFjays9ci5leHRyYX1pZihyLm9mZnNldD5yLmRtYXgpe2UubXNnPSJpbnZhbGlkIGRpc3RhbmNlIHRvbyBmYXIgYmFjayIsci5tb2RlPWM7YnJlYWt9ci5tb2RlPTI1O2Nhc2UgMjU6aWYoMD09PWcpYnJlYWsgZTtpZihBPXgtZyxyLm9mZnNldD5BKXtpZigoQT1yLm9mZnNldC1BKT5yLndoYXZlJiZyLnNhbmUpe2UubXNnPSJpbnZhbGlkIGRpc3RhbmNlIHRvbyBmYXIgYmFjayIsci5tb2RlPWM7YnJlYWt9QT5yLnduZXh0PyhBLT1yLnduZXh0LFM9ci53c2l6ZS1BKTpTPXIud25leHQtQSxBPnIubGVuZ3RoJiYoQT1yLmxlbmd0aCksRT1yLndpbmRvd31lbHNlIEU9aCxTPWItci5vZmZzZXQsQT1yLmxlbmd0aDtBPmcmJihBPWcpLGctPUEsci5sZW5ndGgtPUE7ZG97aFtiKytdPUVbUysrXX13aGlsZSgtLUEpOzA9PT1yLmxlbmd0aCYmKHIubW9kZT0yMSk7YnJlYWs7Y2FzZSAyNjppZigwPT09ZylicmVhayBlO2hbYisrXT1yLmxlbmd0aCxnLS0sci5tb2RlPTIxO2JyZWFrO2Nhc2UgMjc6aWYoci53cmFwKXtmb3IoO2s8MzI7KXtpZigwPT09dylicmVhayBlO3ctLSxwfD1kW20rK108PGssays9OH1pZih4LT1nLGUudG90YWxfb3V0Kz14LHIudG90YWwrPXgseCYmKGUuYWRsZXI9ci5jaGVjaz1yLmZsYWdzP2koci5jaGVjayxoLHgsYi14KTphKHIuY2hlY2ssaCx4LGIteCkpLHg9Zywoci5mbGFncz9wOnUocCkpIT09ci5jaGVjayl7ZS5tc2c9ImluY29ycmVjdCBkYXRhIGNoZWNrIixyLm1vZGU9YzticmVha31wPTAsaz0wfXIubW9kZT0yODtjYXNlIDI4OmlmKHIud3JhcCYmci5mbGFncyl7Zm9yKDtrPDMyOyl7aWYoMD09PXcpYnJlYWsgZTt3LS0scCs9ZFttKytdPDxrLGsrPTh9aWYocCE9PSg0Mjk0OTY3Mjk1JnIudG90YWwpKXtlLm1zZz0iaW5jb3JyZWN0IGxlbmd0aCBjaGVjayIsci5tb2RlPWM7YnJlYWt9cD0wLGs9MH1yLm1vZGU9Mjk7Y2FzZSAyOTpOPTE7YnJlYWsgZTtjYXNlIGM6Tj0tMzticmVhayBlO2Nhc2UgMzE6cmV0dXJuLTQ7Y2FzZSAzMjpkZWZhdWx0OnJldHVybiBsfXJldHVybiBlLm5leHRfb3V0PWIsZS5hdmFpbF9vdXQ9ZyxlLm5leHRfaW49bSxlLmF2YWlsX2luPXcsci5ob2xkPXAsci5iaXRzPWssKHIud3NpemV8fHghPT1lLmF2YWlsX291dCYmci5tb2RlPGMmJihyLm1vZGU8Mjd8fDQhPT10KSkmJl8oZSxlLm91dHB1dCxlLm5leHRfb3V0LHgtZS5hdmFpbF9vdXQpLHYtPWUuYXZhaWxfaW4seC09ZS5hdmFpbF9vdXQsZS50b3RhbF9pbis9dixlLnRvdGFsX291dCs9eCxyLnRvdGFsKz14LHIud3JhcCYmeCYmKGUuYWRsZXI9ci5jaGVjaz1yLmZsYWdzP2koci5jaGVjayxoLHgsZS5uZXh0X291dC14KTphKHIuY2hlY2ssaCx4LGUubmV4dF9vdXQteCkpLGUuZGF0YV90eXBlPXIuYml0cysoci5sYXN0PzY0OjApKyhyLm1vZGU9PT1mPzEyODowKSsoMjA9PT1yLm1vZGV8fDE1PT09ci5tb2RlPzI1NjowKSwoMD09PXYmJjA9PT14fHw0PT09dCkmJjA9PT1OJiYoTj0tNSksTn0sci5pbmZsYXRlRW5kPWZ1bmN0aW9uKGUpe2lmKCFlfHwhZS5zdGF0ZSlyZXR1cm4gbDt2YXIgdD1lLnN0YXRlO3JldHVybiB0LndpbmRvdyYmKHQud2luZG93PW51bGwpLGUuc3RhdGU9bnVsbCwwfSxyLmluZmxhdGVHZXRIZWFkZXI9ZnVuY3Rpb24oZSx0KXt2YXIgcjtyZXR1cm4gZSYmZS5zdGF0ZT8wPT0oMiYocj1lLnN0YXRlKS53cmFwKT9sOihyLmhlYWQ9dCx0LmRvbmU9ITEsMCk6bH0sci5pbmZsYXRlU2V0RGljdGlvbmFyeT1mdW5jdGlvbihlLHQpe3ZhciByLG49dC5sZW5ndGg7cmV0dXJuIGUmJmUuc3RhdGU/MCE9PShyPWUuc3RhdGUpLndyYXAmJjExIT09ci5tb2RlP2w6MTE9PT1yLm1vZGUmJmEoMSx0LG4sMCkhPT1yLmNoZWNrPy0zOl8oZSx0LG4sbik/KHIubW9kZT0zMSwtNCk6KHIuaGF2ZWRpY3Q9MSwwKTpsfSxyLmluZmxhdGVJbmZvPSJwYWtvIGluZmxhdGUgKGZyb20gTm9kZWNhIHByb2plY3QpIn0seyIuLi91dGlscy9jb21tb24iOjEsIi4vYWRsZXIzMiI6MywiLi9jcmMzMiI6NSwiLi9pbmZmYXN0Ijo3LCIuL2luZnRyZWVzIjo5fV0sOTpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4uL3V0aWxzL2NvbW1vbiIpLGE9MTUsaT1bMyw0LDUsNiw3LDgsOSwxMCwxMSwxMywxNSwxNywxOSwyMywyNywzMSwzNSw0Myw1MSw1OSw2Nyw4Myw5OSwxMTUsMTMxLDE2MywxOTUsMjI3LDI1OCwwLDBdLG89WzE2LDE2LDE2LDE2LDE2LDE2LDE2LDE2LDE3LDE3LDE3LDE3LDE4LDE4LDE4LDE4LDE5LDE5LDE5LDE5LDIwLDIwLDIwLDIwLDIxLDIxLDIxLDIxLDE2LDcyLDc4XSxzPVsxLDIsMyw0LDUsNyw5LDEzLDE3LDI1LDMzLDQ5LDY1LDk3LDEyOSwxOTMsMjU3LDM4NSw1MTMsNzY5LDEwMjUsMTUzNywyMDQ5LDMwNzMsNDA5Nyw2MTQ1LDgxOTMsMTIyODksMTYzODUsMjQ1NzcsMCwwXSxsPVsxNiwxNiwxNiwxNiwxNywxNywxOCwxOCwxOSwxOSwyMCwyMCwyMSwyMSwyMiwyMiwyMywyMywyNCwyNCwyNSwyNSwyNiwyNiwyNywyNywyOCwyOCwyOSwyOSw2NCw2NF07dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCxyLGYsYyx1LGQsaCl7dmFyIG0sYix3LGcscCxrLHksXyx2LHg9aC5iaXRzLEE9MCxTPTAsRT0wLEI9MCxVPTAsST0wLE89MCxaPTAsQz0wLFI9MCxOPW51bGwsRj0wLFQ9bmV3IG4uQnVmMTYoMTYpLHo9bmV3IG4uQnVmMTYoMTYpLEQ9bnVsbCxNPTA7Zm9yKEE9MDtBPD1hO0ErKylUW0FdPTA7Zm9yKFM9MDtTPGY7UysrKVRbdFtyK1NdXSsrO2ZvcihVPXgsQj1hO0I+PTEmJjA9PT1UW0JdO0ItLSk7aWYoVT5CJiYoVT1CKSwwPT09QilyZXR1cm4gY1t1KytdPTIwOTcxNTIwLGNbdSsrXT0yMDk3MTUyMCxoLmJpdHM9MSwwO2ZvcihFPTE7RTxCJiYwPT09VFtFXTtFKyspO2ZvcihVPEUmJihVPUUpLFo9MSxBPTE7QTw9YTtBKyspaWYoWjw8PTEsKFotPVRbQV0pPDApcmV0dXJuLTE7aWYoWj4wJiYoMD09PWV8fDEhPT1CKSlyZXR1cm4tMTtmb3IoelsxXT0wLEE9MTtBPGE7QSsrKXpbQSsxXT16W0FdK1RbQV07Zm9yKFM9MDtTPGY7UysrKTAhPT10W3IrU10mJihkW3pbdFtyK1NdXSsrXT1TKTtpZigwPT09ZT8oTj1EPWQsaz0xOSk6MT09PWU/KE49aSxGLT0yNTcsRD1vLE0tPTI1NyxrPTI1Nik6KE49cyxEPWwsaz0tMSksUj0wLFM9MCxBPUUscD11LEk9VSxPPTAsdz0tMSxnPShDPTE8PFUpLTEsMT09PWUmJkM+ODUyfHwyPT09ZSYmQz41OTIpcmV0dXJuIDE7Zm9yKDs7KXt5PUEtTyxkW1NdPGs/KF89MCx2PWRbU10pOmRbU10+az8oXz1EW00rZFtTXV0sdj1OW0YrZFtTXV0pOihfPTk2LHY9MCksbT0xPDxBLU8sRT1iPTE8PEk7ZG97Y1twKyhSPj5PKSsoYi09bSldPXk8PDI0fF88PDE2fHZ8MH13aGlsZSgwIT09Yik7Zm9yKG09MTw8QS0xO1ImbTspbT4+PTE7aWYoMCE9PW0/KFImPW0tMSxSKz1tKTpSPTAsUysrLDA9PS0tVFtBXSl7aWYoQT09PUIpYnJlYWs7QT10W3IrZFtTXV19aWYoQT5VJiYoUiZnKSE9PXcpe2ZvcigwPT09TyYmKE89VSkscCs9RSxaPTE8PChJPUEtTyk7SStPPEImJiEoKFotPVRbSStPXSk8PTApOylJKyssWjw8PTE7aWYoQys9MTw8SSwxPT09ZSYmQz44NTJ8fDI9PT1lJiZDPjU5MilyZXR1cm4gMTtjW3c9UiZnXT1VPDwyNHxJPDwxNnxwLXV8MH19cmV0dXJuIDAhPT1SJiYoY1twK1JdPUEtTzw8MjR8NjQ8PDE2fDApLGguYml0cz1VLDB9fSx7Ii4uL3V0aWxzL2NvbW1vbiI6MX1dLDEwOltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPXsyOiJuZWVkIGRpY3Rpb25hcnkiLDE6InN0cmVhbSBlbmQiLDA6IiIsIi0xIjoiZmlsZSBlcnJvciIsIi0yIjoic3RyZWFtIGVycm9yIiwiLTMiOiJkYXRhIGVycm9yIiwiLTQiOiJpbnN1ZmZpY2llbnQgbWVtb3J5IiwiLTUiOiJidWZmZXIgZXJyb3IiLCItNiI6ImluY29tcGF0aWJsZSB2ZXJzaW9uIn19LHt9XSwxMTpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz1mdW5jdGlvbigpe3RoaXMuaW5wdXQ9bnVsbCx0aGlzLm5leHRfaW49MCx0aGlzLmF2YWlsX2luPTAsdGhpcy50b3RhbF9pbj0wLHRoaXMub3V0cHV0PW51bGwsdGhpcy5uZXh0X291dD0wLHRoaXMuYXZhaWxfb3V0PTAsdGhpcy50b3RhbF9vdXQ9MCx0aGlzLm1zZz0iIix0aGlzLnN0YXRlPW51bGwsdGhpcy5kYXRhX3R5cGU9Mix0aGlzLmFkbGVyPTB9fSx7fV0sIi9saWIvaW5mbGF0ZS5qcyI6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL3psaWIvaW5mbGF0ZSIpLGE9ZSgiLi91dGlscy9jb21tb24iKSxpPWUoIi4vdXRpbHMvc3RyaW5ncyIpLG89ZSgiLi96bGliL2NvbnN0YW50cyIpLHM9ZSgiLi96bGliL21lc3NhZ2VzIiksbD1lKCIuL3psaWIvenN0cmVhbSIpLGY9ZSgiLi96bGliL2d6aGVhZGVyIiksYz1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO2Z1bmN0aW9uIHUoZSl7aWYoISh0aGlzIGluc3RhbmNlb2YgdSkpcmV0dXJuIG5ldyB1KGUpO3RoaXMub3B0aW9ucz1hLmFzc2lnbih7Y2h1bmtTaXplOjE2Mzg0LHdpbmRvd0JpdHM6MCx0bzoiIn0sZXx8e30pO3ZhciB0PXRoaXMub3B0aW9uczt0LnJhdyYmdC53aW5kb3dCaXRzPj0wJiZ0LndpbmRvd0JpdHM8MTYmJih0LndpbmRvd0JpdHM9LXQud2luZG93Qml0cywwPT09dC53aW5kb3dCaXRzJiYodC53aW5kb3dCaXRzPS0xNSkpLCEodC53aW5kb3dCaXRzPj0wJiZ0LndpbmRvd0JpdHM8MTYpfHxlJiZlLndpbmRvd0JpdHN8fCh0LndpbmRvd0JpdHMrPTMyKSx0LndpbmRvd0JpdHM+MTUmJnQud2luZG93Qml0czw0OCYmMD09KDE1JnQud2luZG93Qml0cykmJih0LndpbmRvd0JpdHN8PTE1KSx0aGlzLmVycj0wLHRoaXMubXNnPSIiLHRoaXMuZW5kZWQ9ITEsdGhpcy5jaHVua3M9W10sdGhpcy5zdHJtPW5ldyBsLHRoaXMuc3RybS5hdmFpbF9vdXQ9MDt2YXIgcj1uLmluZmxhdGVJbml0Mih0aGlzLnN0cm0sdC53aW5kb3dCaXRzKTtpZihyIT09by5aX09LKXRocm93IG5ldyBFcnJvcihzW3JdKTtpZih0aGlzLmhlYWRlcj1uZXcgZixuLmluZmxhdGVHZXRIZWFkZXIodGhpcy5zdHJtLHRoaXMuaGVhZGVyKSx0LmRpY3Rpb25hcnkmJigic3RyaW5nIj09dHlwZW9mIHQuZGljdGlvbmFyeT90LmRpY3Rpb25hcnk9aS5zdHJpbmcyYnVmKHQuZGljdGlvbmFyeSk6IltvYmplY3QgQXJyYXlCdWZmZXJdIj09PWMuY2FsbCh0LmRpY3Rpb25hcnkpJiYodC5kaWN0aW9uYXJ5PW5ldyBVaW50OEFycmF5KHQuZGljdGlvbmFyeSkpLHQucmF3JiYocj1uLmluZmxhdGVTZXREaWN0aW9uYXJ5KHRoaXMuc3RybSx0LmRpY3Rpb25hcnkpKSE9PW8uWl9PSykpdGhyb3cgbmV3IEVycm9yKHNbcl0pfWZ1bmN0aW9uIGQoZSx0KXt2YXIgcj1uZXcgdSh0KTtpZihyLnB1c2goZSwhMCksci5lcnIpdGhyb3cgci5tc2d8fHNbci5lcnJdO3JldHVybiByLnJlc3VsdH11LnByb3RvdHlwZS5wdXNoPWZ1bmN0aW9uKGUsdCl7dmFyIHIscyxsLGYsdSxkPXRoaXMuc3RybSxoPXRoaXMub3B0aW9ucy5jaHVua1NpemUsbT10aGlzLm9wdGlvbnMuZGljdGlvbmFyeSxiPSExO2lmKHRoaXMuZW5kZWQpcmV0dXJuITE7cz10PT09fn50P3Q6ITA9PT10P28uWl9GSU5JU0g6by5aX05PX0ZMVVNILCJzdHJpbmciPT10eXBlb2YgZT9kLmlucHV0PWkuYmluc3RyaW5nMmJ1ZihlKToiW29iamVjdCBBcnJheUJ1ZmZlcl0iPT09Yy5jYWxsKGUpP2QuaW5wdXQ9bmV3IFVpbnQ4QXJyYXkoZSk6ZC5pbnB1dD1lLGQubmV4dF9pbj0wLGQuYXZhaWxfaW49ZC5pbnB1dC5sZW5ndGg7ZG97aWYoMD09PWQuYXZhaWxfb3V0JiYoZC5vdXRwdXQ9bmV3IGEuQnVmOChoKSxkLm5leHRfb3V0PTAsZC5hdmFpbF9vdXQ9aCksKHI9bi5pbmZsYXRlKGQsby5aX05PX0ZMVVNIKSk9PT1vLlpfTkVFRF9ESUNUJiZtJiYocj1uLmluZmxhdGVTZXREaWN0aW9uYXJ5KHRoaXMuc3RybSxtKSkscj09PW8uWl9CVUZfRVJST1ImJiEwPT09YiYmKHI9by5aX09LLGI9ITEpLHIhPT1vLlpfU1RSRUFNX0VORCYmciE9PW8uWl9PSylyZXR1cm4gdGhpcy5vbkVuZChyKSx0aGlzLmVuZGVkPSEwLCExO2QubmV4dF9vdXQmJigwIT09ZC5hdmFpbF9vdXQmJnIhPT1vLlpfU1RSRUFNX0VORCYmKDAhPT1kLmF2YWlsX2lufHxzIT09by5aX0ZJTklTSCYmcyE9PW8uWl9TWU5DX0ZMVVNIKXx8KCJzdHJpbmciPT09dGhpcy5vcHRpb25zLnRvPyhsPWkudXRmOGJvcmRlcihkLm91dHB1dCxkLm5leHRfb3V0KSxmPWQubmV4dF9vdXQtbCx1PWkuYnVmMnN0cmluZyhkLm91dHB1dCxsKSxkLm5leHRfb3V0PWYsZC5hdmFpbF9vdXQ9aC1mLGYmJmEuYXJyYXlTZXQoZC5vdXRwdXQsZC5vdXRwdXQsbCxmLDApLHRoaXMub25EYXRhKHUpKTp0aGlzLm9uRGF0YShhLnNocmlua0J1ZihkLm91dHB1dCxkLm5leHRfb3V0KSkpKSwwPT09ZC5hdmFpbF9pbiYmMD09PWQuYXZhaWxfb3V0JiYoYj0hMCl9d2hpbGUoKGQuYXZhaWxfaW4+MHx8MD09PWQuYXZhaWxfb3V0KSYmciE9PW8uWl9TVFJFQU1fRU5EKTtyZXR1cm4gcj09PW8uWl9TVFJFQU1fRU5EJiYocz1vLlpfRklOSVNIKSxzPT09by5aX0ZJTklTSD8ocj1uLmluZmxhdGVFbmQodGhpcy5zdHJtKSx0aGlzLm9uRW5kKHIpLHRoaXMuZW5kZWQ9ITAscj09PW8uWl9PSyk6cyE9PW8uWl9TWU5DX0ZMVVNIfHwodGhpcy5vbkVuZChvLlpfT0spLGQuYXZhaWxfb3V0PTAsITApfSx1LnByb3RvdHlwZS5vbkRhdGE9ZnVuY3Rpb24oZSl7dGhpcy5jaHVua3MucHVzaChlKX0sdS5wcm90b3R5cGUub25FbmQ9ZnVuY3Rpb24oZSl7ZT09PW8uWl9PSyYmKCJzdHJpbmciPT09dGhpcy5vcHRpb25zLnRvP3RoaXMucmVzdWx0PXRoaXMuY2h1bmtzLmpvaW4oIiIpOnRoaXMucmVzdWx0PWEuZmxhdHRlbkNodW5rcyh0aGlzLmNodW5rcykpLHRoaXMuY2h1bmtzPVtdLHRoaXMuZXJyPWUsdGhpcy5tc2c9dGhpcy5zdHJtLm1zZ30sci5JbmZsYXRlPXUsci5pbmZsYXRlPWQsci5pbmZsYXRlUmF3PWZ1bmN0aW9uKGUsdCl7cmV0dXJuKHQ9dHx8e30pLnJhdz0hMCxkKGUsdCl9LHIudW5nemlwPWR9LHsiLi91dGlscy9jb21tb24iOjEsIi4vdXRpbHMvc3RyaW5ncyI6MiwiLi96bGliL2NvbnN0YW50cyI6NCwiLi96bGliL2d6aGVhZGVyIjo2LCIuL3psaWIvaW5mbGF0ZSI6OCwiLi96bGliL21lc3NhZ2VzIjoxMCwiLi96bGliL3pzdHJlYW0iOjExfV19LHt9LFtdKSgiL2xpYi9pbmZsYXRlLmpzIil9KSk7dmFyIEE9di5leHBvcnRzO2NvbnN0IFM9e1VpbnQ4QXJyYXk6VWludDhBcnJheSxJbnQ4QXJyYXk6SW50OEFycmF5LFVpbnQxNkFycmF5OlVpbnQxNkFycmF5LEludDE2QXJyYXk6SW50MTZBcnJheSxVaW50MzJBcnJheTpVaW50MzJBcnJheSxJbnQzMkFycmF5OkludDMyQXJyYXksRmxvYXQzMkFycmF5OkZsb2F0MzJBcnJheSxGbG9hdDY0QXJyYXk6RmxvYXQ2NEFycmF5fSxFPXsifGIxIjpVaW50OEFycmF5LCI8YjEiOlVpbnQ4QXJyYXksIj5iMSI6VWludDhBcnJheSwifHUxIjpVaW50OEFycmF5LCI8dTEiOlVpbnQ4QXJyYXksIj51MSI6VWludDhBcnJheSwifGkxIjpJbnQ4QXJyYXksIjxpMSI6SW50OEFycmF5LCI+aTEiOkludDhBcnJheSwifHUyIjpVaW50MTZBcnJheSwiPHUyIjpVaW50MTZBcnJheSwifGkyIjpJbnQxNkFycmF5LCI8aTIiOkludDE2QXJyYXksInx1NCI6VWludDMyQXJyYXksIjx1NCI6VWludDMyQXJyYXksInxpNCI6SW50MzJBcnJheSwiPGk0IjpJbnQzMkFycmF5LCJ8dTgiOkIoVWludDMyQXJyYXkpLCI8dTgiOkIoVWludDMyQXJyYXkpLCJ8aTgiOkIoSW50MzJBcnJheSksIjxpOCI6QihJbnQzMkFycmF5KSwiPGY0IjpGbG9hdDMyQXJyYXksInxmNCI6RmxvYXQzMkFycmF5LCI8ZjgiOkZsb2F0NjRBcnJheSwifGY4IjpGbG9hdDY0QXJyYXl9O2Z1bmN0aW9uIEIoZSl7Y29uc3QgdD1mdW5jdGlvbih0LHIsbil7Y29uc3QgYT1uZXcgZSh0LHIsMipuKSxpPW5ldyBlKGEubGVuZ3RoKTtmb3IobGV0IGU9MDtlPGkubGVuZ3RoO2UrKylpW2VdPWFbMiplXTtyZXR1cm4gaX07cmV0dXJuIHQuQllURVNfUEVSX0VMRU1FTlQ9OCx0fWZ1bmN0aW9uIFUoZSx0KXtyZXR1cm4gZVt0XSsoZVt0KzFdPDw4KX1mdW5jdGlvbiBJKGUpe2NvbnN0IHQ9VShlLDYpO2lmKDEhPT10KXRocm93IG5ldyBFcnJvcihgVW5zdXBwb3J0ZWQgdmVyc2lvbjogJHt0fWApO2NvbnN0IHI9MTArVShlLDgpLG49SlNPTi5wYXJzZShmdW5jdGlvbihlLHQscil7cmV0dXJuIEFycmF5LmZyb20oZS5zbGljZSh0LHIpKS5tYXAoKGU9PlN0cmluZy5mcm9tQ2hhckNvZGUoZSkpKS5qb2luKCIiKX0oZSwxMCxyKS5yZXBsYWNlKC8nL2csJyInKS5yZXBsYWNlKC9cKC9nLCJbIikucmVwbGFjZSgvXCkvZywiXSIpLnJlcGxhY2UoL1RydWV8RmFsc2UvZywoZT0+ZS50b0xvd2VyQ2FzZSgpKSkucmVwbGFjZSgvXHMrL2csIiIpLnJlcGxhY2UoLyx9LywifSIpLnJlcGxhY2UoLyxcXS8sIl0iKSksYT1FW24uZGVzY3JdO2lmKCFhKXRocm93IG5ldyBFcnJvcihgVW5zdXBwb3J0ZWQgZGF0YSB0eXBlOiAiJHtuLmRlc2NyfSJgKTtjb25zdCBpPWUuc2xpY2Uociksbz1hPT09VWludDhBcnJheT9pOm5ldyBhKGkuYnVmZmVyLGkuYnl0ZU9mZnNldCxpLmJ5dGVMZW5ndGgvYS5CWVRFU19QRVJfRUxFTUVOVCk7cmV0dXJue3NoYXBlOm4uc2hhcGUsYnVmZmVyOm8uYnVmZmVyLGFycmF5VHlwZTpvLmNvbnN0cnVjdG9yLm5hbWV9fWZ1bmN0aW9uIE8oZSl7cmV0dXJuIEkoQS5pbmZsYXRlKGF0b2IoZSkpKX1jb25zdFtaLENdPSgoKT0+e2NvbnN0IGU9e30sdD17fSxyPXt9O3JldHVyblsobixhLGkpPT57YSBpbiBlfHwoZVthXT17fSk7Y29uc3Qgbz1lW2FdO2lmKCEoaSBpbiBvKSl7YSBpbiB0fHwodFthXT17fSxyW2FdPXt9KTtjb25zdCBlPXRbYV0sbz1yW2FdO3JldHVybiBpIGluIGV8fChvW2ldPW5ldyBQcm9taXNlKCh0PT57ZVtpXT10LHBvc3RNZXNzYWdlKHttZXRob2Q6InJlcXVlc3RDb2xvciIsa2V5Omksc2VlZDphLHBvb2w6bn0pfSkpKSxvW2ldfXJldHVybiBQcm9taXNlLnJlc29sdmUob1tpXSl9LCh7a2V5OmUsc2VlZDpyLGNvbG9yOm59KT0+e3Rbcl1bZV0obil9XX0pKCksUj17RGV0ZWN0aW9uOihlLHQpPT57aWYoInN0cmluZyI9PXR5cGVvZiBlLm1hc2spe2NvbnN0IHI9TyhlLm1hc2spLFtuLGFdPXIuc2hhcGU7ZS5tYXNrPXtkYXRhOnIsaW1hZ2U6bmV3IEFycmF5QnVmZmVyKGEqbio0KX0sdC5wdXNoKHIuYnVmZmVyKSx0LnB1c2goZS5tYXNrLmltYWdlKX19LERldGVjdGlvbnM6KGUsdCk9PntlLmRldGVjdGlvbnMuZm9yRWFjaCgoZT0+UltlLl9jbHNdKGUsdCkpKX0sSGVhdG1hcDooZSx0KT0+e2lmKCJzdHJpbmciPT10eXBlb2YgZS5tYXApe2NvbnN0IHI9TyhlLm1hcCksW24sYV09ci5zaGFwZTtlLm1hcD17ZGF0YTpyLGltYWdlOm5ldyBBcnJheUJ1ZmZlcihhKm4qNCl9LHQucHVzaChyLmJ1ZmZlciksdC5wdXNoKGUubWFwLmltYWdlKX19LFNlZ21lbnRhdGlvbjooZSx0KT0+e2lmKCJzdHJpbmciPT10eXBlb2YgZS5tYXNrKXtjb25zdCByPU8oZS5tYXNrKSxbbixhXT1yLnNoYXBlO2UubWFzaz17ZGF0YTpyLGltYWdlOm5ldyBBcnJheUJ1ZmZlcihhKm4qNCl9LHQucHVzaChyLmJ1ZmZlciksdC5wdXNoKGUubWFzay5pbWFnZSl9fX0sTj1lPT4oZS5faWQmJihlLmlkPWUuX2lkLGRlbGV0ZSBlLl9pZCksZSksRj0oZSx0LHI9IiIpPT57bGV0IG49W107Y29uc3QgYT1bXTtmb3IoY29uc3QgaSBpbiBlKXtjb25zdCBvPWVbaV07aWYobyl7aWYoby5fY2xzIGluIFImJlJbby5fY2xzXShvLG4pLG8uX2NscyBpbiB3KWlmKG8uX2NscyBpbiBiKXtjb25zdCBlPW9bYltvLl9jbHNdXTtBcnJheS5pc0FycmF5KGUpJiYob1tiW28uX2Nsc11dPWUubWFwKE4pKX1lbHNlIE4obyk7TFtvLl9jbHNdJiZhLnB1c2goTFtvLl9jbHNdKHIraSxvLHQpKX19cmV0dXJuIFByb21pc2UuYWxsKGEpLnRoZW4oKCgpPT5uKSl9O2xldCBUPW51bGwsej1udWxsO2NvbnN0IEQ9ZT0+KHt2YWx1ZTp0fSk9Pnt0JiZQcm9taXNlLmFsbCh0LmZyYW1lcy5tYXAoKGU9PkYoZSx0LmNvbG9yaW5nLCJmcmFtZXMuIikpKSkudGhlbigocj0+e3Bvc3RNZXNzYWdlKHttZXRob2Q6ImZyYW1lQ2h1bmsiLGZyYW1lczp0LmZyYW1lcyxyYW5nZTp0LnJhbmdlLHV1aWQ6ZX0sci5mbGF0KCkpfSkpfSxNPSh7Y29sb3Jpbmc6ZSxmcmFtZUNvdW50OnQsZnJhbWVOdW1iZXI6cixzYW1wbGVJZDpuLHV1aWQ6YSx1cmw6aX0pPT57VCYmVC5jYW5jZWwoKSx6PWEsVD0oKHtjaHVua1NpemU6ZSxjb2xvcmluZzp0LGZyYW1lQ291bnQ6cixmcmFtZU51bWJlcjpuLHNhbXBsZUlkOmEsdXJsOml9KT0+e2xldCBvPSExO2NvbnN0IHM9bmV3IFJlYWRhYmxlU3RyZWFtKHtwdWxsOnM9Pm4+cnx8bz8ocy5jbG9zZSgpLFByb21pc2UucmVzb2x2ZSgpKTpuZXcgUHJvbWlzZSgoKG8sbCk9PntmZXRjaChgJHtpfWZyYW1lcz9gK25ldyBVUkxTZWFyY2hQYXJhbXMoe2ZyYW1lTnVtYmVyOm4udG9TdHJpbmcoKSxudW1GcmFtZXM6ZS50b1N0cmluZygpLGZyYW1lQ291bnQ6ci50b1N0cmluZygpLHNhbXBsZUlkOmF9KSkudGhlbigoZT0+ZS5qc29uKCkpKS50aGVuKCgoe2ZyYW1lczplLHJhbmdlOnJ9KT0+e3MuZW5xdWV1ZSh7ZnJhbWVzOmUscmFuZ2U6cixjb2xvcmluZzp0fSksbj1yWzFdKzEsbygpfSkpLmNhdGNoKChlPT57bChlKX0pKX0pKSxjYW5jZWw6KCk9PntvPSEwfX0sbmV3IENvdW50UXVldWluZ1N0cmF0ZWd5KHtoaWdoV2F0ZXJNYXJrOjZ9KSk7cmV0dXJue3NhbXBsZUlkOmEsZnJhbWVOdW1iZXI6bixjaHVua1NpemU6ZSxyZWFkZXI6cy5nZXRSZWFkZXIoKSxjYW5jZWw6KCk9Pm89ITB9fSkoe2NvbG9yaW5nOmUsY2h1bmtTaXplOjIwLGZyYW1lQ291bnQ6dCxmcmFtZU51bWJlcjpyLHNhbXBsZUlkOm4sdXJsOml9KSxULnJlYWRlci5yZWFkKCkudGhlbihEKGEpKS5jYXRjaCgoKCk9PnBvc3RNZXNzYWdlKHttZXRob2Q6InJlcXVlc3RGcmFtZUNodW5rIixlcnJvcjohMH0pKSl9LEw9e0RldGVjdGlvbjphc3luYyhlLHQscik9PntpZighdC5tYXNrKXJldHVybjtjb25zdCBuPWF3YWl0IFooci5wb29sLHIuc2VlZCxyLmJ5TGFiZWw/dC5sYWJlbDplKSxhPW5ldyBVaW50MzJBcnJheSh0Lm1hc2suaW1hZ2UpLGk9bmV3IFNbdC5tYXNrLmRhdGEuYXJyYXlUeXBlXSh0Lm1hc2suZGF0YS5idWZmZXIpLG89ayhuKTtmb3IobGV0IHM9MDtzPGEubGVuZ3RoO3MrKylpW3NdJiYoYVtzXT1vKX0sRGV0ZWN0aW9uczphc3luYyhlLHQscik9Pntjb25zdCBuPXQuZGV0ZWN0aW9ucy5tYXAoKHQ9PkxbdC5fY2xzXShlLHQscikpKTthd2FpdCBQcm9taXNlLmFsbChuKX0sSGVhdG1hcDphc3luYyhlLHQscik9PntpZighdC5tYXApcmV0dXJuO2NvbnN0IG49bmV3IFVpbnQzMkFycmF5KHQubWFwLmltYWdlKSxhPW5ldyBTW3QubWFwLmRhdGEuYXJyYXlUeXBlXSh0Lm1hcC5kYXRhLmJ1ZmZlciksW2ksb109dC5yYW5nZT90LnJhbmdlOihzPWEpaW5zdGFuY2VvZiBGbG9hdDMyQXJyYXl8fHMgaW5zdGFuY2VvZiBGbG9hdDY0QXJyYXk/WzAsMV06WzAsMjU1XTt2YXIgcztjb25zdCBsPU1hdGgubWF4KE1hdGguYWJzKGkpLE1hdGguYWJzKG8pKSxmPWF3YWl0IFooci5wb29sLHIuc2VlZCxlKSxjPXIuYnlMYWJlbD9lPT57aWYoMD09PWUpcmV0dXJuIDA7Y29uc3QgdD1NYXRoLnJvdW5kKE1hdGgubWF4KGUtaSwwKS8oby1pKSooci5zY2FsZS5sZW5ndGgtMSkpO3JldHVybiBrKHIuc2NhbGVbdF0pfTplPT4wPT09ZT8wOmsoZixNYXRoLm1pbihsLE1hdGguYWJzKGUpKS9sKTtmb3IobGV0IHU9MDt1PG4ubGVuZ3RoO3UrKykwIT09YVt1XSYmKG5bdV09YyhhW3VdKSl9LFNlZ21lbnRhdGlvbjphc3luYyhlLHQscik9PntpZighdC5tYXNrKXJldHVybjtjb25zdCBuPW5ldyBVaW50MzJBcnJheSh0Lm1hc2suaW1hZ2UpLGE9bmV3IFNbdC5tYXNrLmRhdGEuYXJyYXlUeXBlXSh0Lm1hc2suZGF0YS5idWZmZXIpO2xldCBpPXIubWFza1RhcmdldHNbZV07aXx8KGk9ci5kZWZhdWx0TWFza1RhcmdldHMpO2NvbnN0IG89e307bGV0IHM7aSYmMT09PU9iamVjdC5rZXlzKGkpLmxlbmd0aCYmKHM9ayhhd2FpdCBaKHIucG9vbCxyLnNlZWQsZSkpKTtjb25zdCBsPWU9PigoZT1NYXRoLnJvdW5kKE1hdGguYWJzKGUpKSVyLnRhcmdldHMubGVuZ3RoKWluIG98fChvW2VdPWsoci50YXJnZXRzW2VdKSksb1tlXSk7Zm9yKGxldCBmPTA7ZjxuLmxlbmd0aDtmKyspMCE9PWFbZl0mJihuW2ZdPXN8fGwoYVtmXSkpfX07b25tZXNzYWdlPWU9Pnt2YXJ7ZGF0YTp0fT1lLHI9dCx7bWV0aG9kOm59PXIsYT1fX29ialJlc3QocixbIm1ldGhvZCJdKTtzd2l0Y2gobil7Y2FzZSJwcm9jZXNzU2FtcGxlIjpyZXR1cm4gdm9pZCgoe3NhbXBsZTplLHV1aWQ6dCxjb2xvcmluZzpyfSk9PntOKGUpO2xldCBuPVtGKGUscildO2UuZnJhbWVzJiZlLmZyYW1lcy5sZW5ndGgmJihuPVsuLi5uLC4uLmUuZnJhbWVzLm1hcCgoZT0+RihlLHIsImZyYW1lcy4iKSkpLmZsYXQoKV0pLFByb21pc2UuYWxsKG4pLnRoZW4oKHI9Pntwb3N0TWVzc2FnZSh7bWV0aG9kOiJwcm9jZXNzU2FtcGxlIixzYW1wbGU6ZSx1dWlkOnR9LHIuZmxhdCgpKX0pKX0pKGEpO2Nhc2UicmVxdWVzdEZyYW1lQ2h1bmsiOnJldHVybiB2b2lkKCh7dXVpZDplfSk9PntlPT09eiYmVCYmVC5yZWFkZXIucmVhZCgpLnRoZW4oRChlKSkuY2F0Y2goKCgpPT5wb3N0TWVzc2FnZSh7bWV0aG9kOiJyZXF1ZXN0RnJhbWVDaHVuayIsZXJyb3I6ITB9KSkpfSkoYSk7Y2FzZSJzZXRTdHJlYW0iOnJldHVybiB2b2lkIE0oYSk7Y2FzZSJyZXNvbHZlQ29sb3IiOnJldHVybiB2b2lkIEMoYSk7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoInVua25vd24gbWV0aG9kIil9fX0oKTsK")],{type:"text/javascript;charset=utf-8"});function Jn(){const e=(window.URL||window.webkitURL).createObjectURL(Bn);try{return new Worker(e)}finally{(window.URL||window.webkitURL).revokeObjectURL(e)}}function An(e,t,n,s){return Math.sqrt((n-e)*(n-e)+(s-t)*(s-t))}function _n(e,t,n,s){return e*n+t*s}function Qn([e,t],[n,s],[a,l]){const i=An(n,s,a,l),[o,r]=function(e,t,n,s,a,l){const i=a-n,o=l-s,r=_n(e-n,t-s,i,o)/_n(i,o,i,o);return[r*i+n,r*o+s]}(e,t,n,s,a,l);return An(n,s,o,r)<i&&An(a,l,o,r)<i?An(e,t,o,r):Math.min(An(e,t,n,s),An(e,t,a,l))}const $n=e=>{if(0===e.length)return[0,0,1,1];let t=Math.min(...e.map((([e])=>e))),n=Math.min(...e.map((([e,t])=>t))),s=Math.max(...e.map((([e])=>e)))-t,a=Math.max(...e.map((([e,t])=>t)))-n;return 0===s&&(t-=.05,s=.1),0===a&&(n-=.05,a+=.1),[t,n,s,a]},qn=([e,t],[n,s,a,l])=>{if(e/t>a/l){const n=a*t/e;s+=(l-n)/2,l+=n-l}else{const s=l*e/t;n+=(a-s)/2,a+=s-a}return[n,s,a,l]},es=e=>{const{top:t,left:n,width:s,height:a}=e.getBoundingClientRect();return[n,t,s,a]},ts=([e,t],[n,s])=>e/t<n/s?e/n:t/s,ns=(e,t,[n,s],[a,l],i=!0)=>{const o=n*e,r=s*e,c=a/l;n/s<c?l=(a=o*(i?1.1:1))/c:a=(l=r*(i?1.1:1))*c;const d=(r-l)/2-Math.max((s-l)/2,0);if(l>s){t[1]>-d&&(t[1]=-d);const e=-d-l;t[1]-s<e&&(t[1]-=t[1]-s-e)}else t[1]=-d;const m=(o-a)/2-Math.max((n-a)/2,0);if(a>n){t[0]>-m&&(t[0]=-m);const e=-m-a;t[0]-n<e&&(t[0]-=t[0]-n-e)}else t[0]=-m;return t},ss=([e,t],[n,s],a,l)=>{const i=ts([e,t],[n,s]);return e*e/(n*i*a)<16&&(a=e*e/(n*i*16)),t*t/(s*i*a)<16&&(a=t*t/(s*i*16)),Math.max(a,1-l)},as=(e,t)=>{const n=(e,t)=>Array.isArray(t)||t instanceof Function?t:"object"!=typeof t?void 0===t?e:t:null===t?t:k(n,e,t);return k(n,e,t)},ls=e=>{const t=new Jn;return e?(t.addEventListener("message",(n=>{var{data:s}=n,a=s,{method:l}=a,i=c(a,["method"]);l in e&&e[l].forEach((e=>e(t,i)))})),t):t},is=(e,t)=>t.reduce(((t,n)=>n[0]<=e&&n[1]>=e?n[0]===n[1]?t:n[0]===e?[...t,[e+1,n[1]]]:n[1]===e?[...t,[n[0],e-1]]:[...t,[n[0],e-1],[e+1,n[1]]]:[...t,n]),[]),os=(e,t)=>{(t=[...t]).push(e),t.sort(((e,t)=>e[0]-t[0]));let n=0;for(;n<t.length-1;){var s=t[n],a=t[n+1];s[1]>=a[0]-1?(s[1]=Math.max(s[1],a[1]),t.splice(n+1,1)):n++}return t},rs=(()=>{let e=null;return()=>(null==e&&(e=window.devicePixelRatio?window.devicePixelRatio:1),e)})(),cs=()=>window.process&&window.process.versions&&Boolean(window.process.versions.electron),ds=window.location.host,ms=window.location.pathname+(window.location.pathname.endsWith("/")?"":"/"),us=cs()?parseInt({}.FIFTYONE_SERVER_PORT)||5151:parseInt(window.location.port),hs=cs()?"localhost":window.location.hostname;class ps{constructor(e,t,n){if(this.children=[],this.events={},this.isShown(e)){this.element=this.createHTMLElement(t,n);for(const[e,s]of Object.entries(this.getEvents()))this.events[e]=e=>s({event:e,update:t,dispatchEvent:n}),this.element&&this.element.addEventListener(e,this.events[e])}}applyChildren(e){this.children=e||[]}isShown(e){return!0}render(e,t){const n=this.renderSelf(e,t);return this.children.forEach((s=>{if(!s.isShown(e.config))return;const a=s.render(e,t);a&&a.parentNode!==this.element&&n&&n.appendChild(a)})),n}getEvents(){return{}}removeEvents(){for(const[e,t]of Object.entries(this.events))this.element.removeEventListener(e,t)}attachEvents(){for(const[e,t]of Object.entries(this.events))this.element.addEventListener(e,t)}}const gs=(e,t=!1)=>(n,s)=>{if((!n.options.showTooltip||n.config.thumbnail||n.disableOverlays)&&!t)return;let a=s.length&&s[0].containsPoint(n)&&!t?s[0].getPointInfo(n):null;n.frameNumber&&a&&(a.frameNumber=n.frameNumber),e("tooltip",a?r(o({},a),{coordinates:n.cursorCoordinates}):null)},fs=function(e,t){const n=document.createElement("label");n.classList.add("_lookerLabel_rilxo_10"),n.innerHTML=e;const s=document.createElement("input");s.setAttribute("type","checkbox"),s.checked=t;const a=document.createElement("span");return a.classList.add("_lookerCheckbox_rilxo_18"),n.appendChild(s),n.appendChild(a),[n,s]},bs="_invisible_m8b2r_16";class ys extends ps{constructor(){super(...arguments),this.width=0,this.height=0,this.mousedown=!1,this.hideControlsTimeout=null,this.start=[0,0],this.wheelTimeout=null,this.hide=!0}getEvents(){return{click:({event:e,update:t,dispatchEvent:n})=>{t({showOptions:!1},((t,s)=>{if(t.config.thumbnail||t.disableOverlays)return;let a=!1;if(this.mousedownCoordinates&&(a=e.pageX!==this.mousedownCoordinates[0]||e.pageY!==(null==this?void 0:this.mousedownCoordinates[1])),!a&&s.length){const e=s[0];e.containsPoint(t)&&n("select",e.getSelectData(t))}}))},mouseleave:({dispatchEvent:e})=>{this.mousedown=!1,e("tooltip",null)},mousemove:({event:e,update:t,dispatchEvent:n})=>{this.hideControlsTimeout&&clearTimeout(this.hideControlsTimeout),this.hideControlsTimeout=setTimeout((()=>t((({showOptions:e,hoveringControls:t})=>(this.hideControlsTimeout=null,e||t?{}:{showControls:!1})))),3500),t((t=>{if(t.config.thumbnail)return{};const n={cursorCoordinates:[e.pageX,e.pageY],rotate:0,showControls:!0};return this.mousedown?(n.pan=this.getPan([e.pageX,e.pageY]),n.panning=!0,n):n}),gs(n))},mousedown:({event:e,update:t})=>{t((({config:{thumbnail:t},pan:[n,s]})=>(t||(e.preventDefault(),this.mousedown=!0,this.mousedownCoordinates=[e.pageX,e.pageY],this.start=[e.pageX-n,e.pageY-s]),{})))},mouseup:({event:e,update:t})=>{t((t=>(this.mousedown=!1,t.config.thumbnail||!t.panning?{}:(e.preventDefault(),{panning:!1,pan:this.getPan([e.pageX,e.pageY])}))))},wheel:({event:e,update:t,dispatchEvent:n})=>{requestAnimationFrame((()=>{t((({config:{thumbnail:s,dimensions:a},pan:[l,i],scale:o,windowBBox:[r,c,d,m],options:{zoomPad:u}})=>{if(s)return{};e.preventDefault(),e.stopImmediatePropagation();const h=e.x-r,p=e.y-c,g=(h-l)/o,f=(p-i)/o,b=ss([d,m],a,e.deltaY<0?1.09*o:o/1.09,u);return o===b?{}:(this.wheelTimeout&&clearTimeout(this.wheelTimeout),this.wheelTimeout=setTimeout((()=>{this.wheelTimeout=null,t((e=>({wheeling:!1,disableOverlays:Boolean(e.playing||e.seeking)})),((e,t)=>gs(n,e.disableOverlays)(e,t)))}),200),{pan:[h-g*b,p-f*b],scale:b,cursorCoordinates:[e.pageX,e.pageY],wheeling:!0,disableOverlays:!0})}),gs(n,!0))}))}}}createHTMLElement(e){const t=document.createElement("canvas");return t.classList.add("_lookerCanvas_m8b2r_5",bs),this.hideControlsTimeout=setTimeout((()=>e((({showOptions:e,hoveringControls:t})=>(this.hideControlsTimeout=null,e||t?{}:{showControls:!1})))),3500),t}renderSelf({loaded:e,error:t,config:{thumbnail:n},disabled:s,reloading:a,panning:l,windowBBox:[i,o,r,c],mouseIsOnOverlay:d,disableOverlays:m}){if(this.width!==r){const e=rs();this.element.width=r*e,this.width=r}if(this.height!==c){const e=rs();this.element.height=c*e,this.height=c}const u=this.cursor;l?"all-scroll"!==u&&(this.cursor="all-scroll"):n||d&&!m?"pointer"!==u&&(this.cursor="pointer"):n?"unset"!==u&&(this.cursor="unset"):"default"!==u&&(this.cursor="default"),this.cursor!==u&&(this.element.style.cursor=this.cursor);const h=!e||s||a||t;return this.hide!==h&&(this.hide=h,this.hide?this.element.classList.add(bs):this.element.classList.remove(bs)),this.element}getPan([e,t]){const[n,s]=this.start;return[e-n,t-s]}}const vs=Object.freeze({arrowLeft:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Cpath fill='rgb(238, 238, 238)' d='M20,10V14H11L14.5,17.5L12.08,19.92L4.16,12L12.08,4.08L14.5,6.5L11,10H20Z' /%3E%3C/svg%3E",arrowRight:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Cpath fill='rgb(238, 238, 238)' d='M4,10V14H13L9.5,17.5L11.92,19.92L19.84,12L11.92,4.08L9.5,6.5L13,10H4Z' /%3E%3C/svg%3E",fullscreen:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='24' viewBox='0 0 24 24' width='24'%3E%3Cpath fill='rgb(238, 238, 238)' d='M5,5H10V7H7V10H5V5M14,5H19V10H17V7H14V5M17,14H19V19H14V17H17V14M10,17V19H5V14H7V17H10Z' /%3E%3C/svg%3E",fullscreenExit:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='24' viewBox='0 0 24 24' width='24'%3E%3Cpath fill='rgb(238, 238, 238)' d='M14,14H19V16H16V19H14V14M5,14H10V19H8V16H5V14M8,5H10V10H5V8H8V5M19,8V10H14V5H16V8H19Z' /%3E%3C/svg%3E",help:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Cpath fill='rgb(238, 238, 238)' d='M15.07,11.25L14.17,12.17C13.45,12.89 13,13.5 13,15H11V14.5C11,13.39 11.45,12.39 12.17,11.67L13.41,10.41C13.78,10.05 14,9.55 14,9C14,7.89 13.1,7 12,7A2,2 0 0,0 10,9H8A4,4 0 0,1 12,5A4,4 0 0,1 16,9C16,9.88 15.64,10.67 15.07,11.25M13,19H11V17H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2Z' /%3E%3C/svg%3E",minus:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='24' viewBox='0 0 24 24' width='24'%3E%3Cpath fill='rgb(238, 238, 238)' d='M20 14H4V10H20V14Z' /%3E%3C/svg%3E",plus:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='24' viewBox='0 0 24 24' width='24'%3E%3Cpath fill='rgb(238, 238, 238)' d='M20 14H14V20H10V14H4V10H10V4H14V10H20V14Z' /%3E%3C/svg%3E",options:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Cpath fill='rgb(238, 238, 238)' d='M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z' /%3E%3C/svg%3E"});function xs(e,t,n,s){const a=new t.node(e,n,s);if(!a.isShown(e))return a;let l=new Array;return l=t.children?t.children.map((t=>xs(e,t,n,s))):l,a.applyChildren(l),a}const ws=function(e,t=!1){let n="";return t&&e<=10?n+="0"+e:n=0===e?"0":`${e}`,n},ks=(e,t,n)=>(e===t&&(e-=.1*(1/n)),Math.floor(e*n+1)),Es=(e,t)=>((e-=1)+.01)/t,Ss=(e,t,n)=>`${e} / ${ks(t,t,n)}`,Ls=(e,t,n)=>{const s=Math.floor(n/3600)>0;let a=0,l=Es(e,t);s&&(a=Math.floor(l/3600)),l%=3600;const i=Math.floor(l/60),o=l%60;return s?ws(a)+":"+ws(i,!0)+":"+ws(+o.toFixed(0),!0):ws(i)+":"+ws(+o.toFixed(0),!0)};const Ts=e=>{let t=[],n=[],s=[];const a=e=>{e.muted=!0,e.preload="metadata",e.loop=!1},l=e=>()=>{if(!e.paused)throw new Error("Release playing video");if(a(e),n.length){n.shift()([e,l(e)])}else s.push(e)};return[()=>{if(s.length){const e=s.shift();return Promise.resolve([e,l(e)])}if(t.length<e){const e=document.createElement("video");return e.preload="metadata",e.muted=!0,e.loop=!1,t.push(e),Promise.resolve([e,l(e)])}return new Promise((e=>{n.push(e)}))},()=>{n.forEach(a),s=[],n=[],t=[]}]},[Zs,Cs]=Ts(1),[Ps,Rs]=Ts(6);const Is=e=>Object.fromEntries(Object.entries(e).reduce(((e,[t,n])=>Array.isArray(n.eventKeys)?[...e,...n.eventKeys.map((e=>[e,n]))]:[...e,[n.eventKeys||n.shortcut,n]]),[])),Ws={title:"Escape context",shortcut:"Esc",eventKeys:"Escape",detail:"Escape the current context",action:(e,t,n)=>{e((({hasDefaultZoom:s,showHelp:a,showOptions:l,options:{fullscreen:i,showJSON:o,selectedLabels:r}})=>a?{showHelp:!1}:l?{showOptions:!1}:o?(t("options",{showJSON:!1}),{options:{showJSON:!1}}):s?i?(Ks.action(e,t,n),{}):r.length?(t("clear"),{}):(t("close"),{}):{setZoom:!0}))}},Ms={title:"Next sample",shortcut:"&#8594;",eventKeys:"ArrowRight",detail:"Go to the next sample",action:(e,t)=>{t("next")}},Xs={title:"Previous sample",shortcut:"&#8592;",eventKeys:"ArrowLeft",detail:"Go to the previous sample",action:(e,t)=>{t("previous")}},Ns={title:"Display help",eventKeys:["/","?"],shortcut:"?",detail:"Display this help window",action:(e,t)=>{e((({showHelp:e,config:{thumbnail:n}})=>n?{}:e?{showHelp:!1}:(t("options",{showJSON:!1}),{showHelp:!0,options:{showJSON:!1}})))}},Gs={title:"Zoom in",eventKeys:["+","="],shortcut:"+",detail:"Zoom in on the sample",action:e=>{e((({scale:e,windowBBox:[t,n,s,a],config:{dimensions:l},pan:[i,o],options:{zoomPad:r}})=>{const c=s/2,d=a/2,m=(c-i)/e,u=(d-o)/e,h=ss([s,a],l,1.09*e,r);return{scale:h,pan:[c-m*h,d-u*h]}}))}},Ys={title:"Zoom  out",eventKeys:["-","_"],shortcut:"-",detail:"Zoom out on the sample",action:e=>{e((({scale:e,windowBBox:[t,n,s,a],config:{dimensions:l},pan:[i,o],options:{zoomPad:r}})=>{const c=s/2,d=a/2,m=(c-i)/e,u=(d-o)/e,h=ss([s,a],l,e/1.09,r);return{scale:h,pan:[c-m*h,d-u*h]}}))}},Vs={title:"Crop to content",shortcut:"z",detail:"Crop on visible labels",action:e=>{e((({disableOverlays:e})=>({zoomToContent:!e})))}},Fs={title:"Settings",shortcut:"s",detail:"Toggle the settings panel",action:e=>{e((({showOptions:e,config:{thumbnail:t}})=>t?{}:e?{showOptions:!1,disableControls:!1}:{disableControls:!1,showControls:!0,showOptions:!0}))}},Ks={title:"Fullscreen",shortcut:"f",detail:"Toggle fullscreen mode",action:(e,t)=>{e((({config:{thumbnail:e},options:{fullscreen:t}})=>e?{}:{options:{fullscreen:!t}}),(({config:{thumbnail:e},options:{fullscreen:n}})=>{e||t("fullscreen",n)}))}},Os={title:"JSON",shortcut:"j",detail:"View JSON",action:(e,t)=>{let n=null;e((({disableOverlays:e,config:{thumbnail:t},options:{showJSON:s}})=>t?{}:(n=!e&&!s,n?{showHelp:!1,options:{showJSON:n}}:{options:{showJSON:!1}}))),null!==n&&t("options",{showJSON:n})}},zs={escape:Ws,next:Ms,previous:Xs,rotateNext:{title:"Rotate label backward",shortcut:"&#8593;",eventKeys:"ArrowDown",detail:"Rotate the current label to the back",action:(e,t)=>e((({disableOverlays:e,rotate:t})=>e?{}:{rotate:t+1}),((e,n)=>{gs(t)(e,n)}))},rotatePrevious:{title:"Rotate label forward",shortcut:"&#8595;",eventKeys:"ArrowUp",detail:"Rotate the bottom label to the back",action:(e,t)=>e((({disableOverlays:e,rotate:t})=>e?{}:{rotate:Math.max(0,t-1)}),((e,n)=>{gs(t)(e,n)}))},help:Ns,zoomIn:Gs,zoomOut:Ys,cropToContent:Vs,resetZoom:{title:"Reset zoom",shortcut:"r",detail:"Reset zoom to default",action:e=>{e({setZoom:!0})}},controlsToggle:{title:"Controls",shortcut:"c",detail:"Toggle controls",action:e=>{e((({config:{thumbnail:e},showControls:t})=>e?{}:t?{showControls:!1,disableControls:!1}:{disableControls:!1,showControls:!0}))}},settings:Fs,fullscreen:Ks,json:Os,wheel:{title:"Zoom",shortcut:"Wheel",eventKeys:null,detail:"Zoom in and out",action:()=>null}},Ds=Is(zs),Hs={title:"Next frame",eventKeys:[".",">"],shortcut:">",detail:"Seek to the next frame",action:(e,t)=>{e((({frameNumber:e,duration:t,playing:n,config:{frameRate:s,support:a,thumbnail:l},lockedToSupport:i})=>{if(n||l)return{};const o=i?a[1]:ks(t,t,s);return{frameNumber:Math.min(o,e+1)}}),((e,n)=>gs(t)(e,n)))}},Us={title:"Previous frame",eventKeys:[",","<"],shortcut:"<",detail:"Seek to the previous frame",action:(e,t)=>{e((({frameNumber:e,playing:t,config:{support:n,thumbnail:s},lockedToSupport:a})=>t||s?{}:{frameNumber:Math.max(a?n[0]:1,e-1)}),((e,n)=>gs(t)(e,n)))}},js={title:"Play / pause",shortcut:"Space",eventKeys:" ",detail:"Play or pause the video",action:(e,t)=>{e((({frameNumber:e,playing:n,duration:s,config:{frameRate:a,support:l,thumbnail:i},lockedToSupport:o})=>{if(i)return{};const r=o?l[0]:1,c=o?l[1]:ks(s,s,a);return t("options",{showJSON:!1}),{playing:!n&&r!==c,frameNumber:c===e?o?l[0]:1:e,options:{showJSON:!1}}}))}},Bs={title:"Mute / unmute",shortcut:"m",detail:"Mute or unmute the video",action:(e,t)=>{e((({options:{volume:e},config:{thumbnail:n}})=>n?{}:(t("options",{volume:e=0===e?.5:0}),{options:{volume:e}})))}},Js=(e,t)=>{e((({config:{thumbnail:e}})=>e?{}:(t("options",{playbackRate:1}),{options:{playbackRate:1}})))},As={title:"Seek to",detail:"Seek to 0%, 10%, 20%... of the video",shortcut:"0-9",eventKeys:["0","1","2","3","4","5","6","7","8","9"],action:(e,t,n)=>{e((({duration:e,config:{frameRate:s,support:a},lockedToSupport:l})=>{const i=ks(e,e,s),o=l?a[1]-a[0]:i,r=l?a[0]:1;return t("options",{showJSON:!1}),{frameNumber:Math.max(1,Math.round(parseInt(n,10)/10*o)+r),options:{showJSON:!1}}}))}},_s={title:"Support lock",filter:e=>Boolean(e.support),detail:"Toggle the lock on the support frame(s)",shortcut:"l",action:e=>{e((({lockedToSupport:e,config:{support:t},frameNumber:n})=>({lockedToSupport:!!t&&!e,frameNumber:n<t[0]||n>t[1]?t[0]:n})))}},Qs={title:"Escape context",shortcut:"Esc",eventKeys:"Escape",detail:"Escape the current context",action:(e,t,n)=>{e((({hasDefaultZoom:s,showHelp:a,showOptions:l,frameNumber:i,config:{support:o},options:{fullscreen:r,showJSON:c,selectedLabels:d},lockedToSupport:m})=>a?{showHelp:!1}:l?{showOptions:!1}:c?(t("options",{showJSON:!1}),{options:{showJSON:!1}}):!m&&Boolean(o)?{frameNumber:o[0],lockedToSupport:!0}:1!==i?{frameNumber:1,playing:!1}:s?r?(Ks.action(e,t,n),{}):d.length?(t("clear"),{}):(t("close"),{}):{setZoom:!0}))}},$s=r(o({},zs),{escape:Qs,muteUnmute:Bs,playPause:js,nextFrame:Hs,previousFrame:Us,seekTo:As,supportLock:_s}),qs=Is($s);class ea extends ps{getEvents(){return{click:({event:e,update:t})=>{e.stopPropagation(),e.preventDefault(),t({showHelp:!1})},dblclick:({event:e})=>{e.stopPropagation(),e.preventDefault()}}}createHTMLElement(e){return this.createHelpPanel(e,zs)}isShown({thumbnail:e}){return!e}renderSelf({showHelp:e}){return this.showHelp===e||(e?(this.element.style.opacity="0.9",this.element.style.display="flex"):(this.element.style.opacity="0.0",this.element.style.display="none"),this.showHelp=e),this.element}createHelpPanel(e,t){const n=document.createElement("div"),s=document.createElement("div");s.innerText="Help",s.classList.add("_lookerPanelHeader_gkq4n_44"),n.classList.add("_lookerPanel_gkq4n_5");const a=document.createElement("div");a.classList.add("_lookerPanelContainer_gkq4n_29");const l=document.createElement("div");l.classList.add("_lookerPanelVerticalContainer_gkq4n_38"),l.appendChild(n),a.appendChild(l);const i=document.createElement("div");i.classList.add("_lookerPanelFlex_gkq4n_69");const o=document.createElement("div");o.classList.add("_lookerHelpPanelItems_a2ufi_5"),this.items=o;const r=document.createElement("img");r.src="assets/close.47fb979b.svg",r.classList.add("_lookerPanelClose_gkq4n_50"),r.onclick=()=>e({showHelp:!1}),n.appendChild(r);const c=["Wheel","Esc"];return Object.values(t).sort(((e,t)=>e.shortcut.length!==t.shortcut.length?c.includes(t.shortcut)?1:c.includes(e.shortcut)?-1:t.shortcut.length-e.shortcut.length:e.shortcut>t.shortcut?1:-1)).forEach(na(o)),i.appendChild(s),i.appendChild(o),n.append(i),a}}class ta extends ea{createHTMLElement(e){let t=null;return e((({config:e})=>(t=e,{}))),this.createHelpPanel(e,Object.fromEntries(Object.entries($s).filter((([e,n])=>!n.filter||n.filter(t)))))}}const na=e=>t=>{const n=document.createElement("div");n.classList.add("_lookerShortcutValue_a2ufi_32"),n.innerHTML=t.shortcut;const s=document.createElement("div");s.classList.add("_lookerShortcutTitle_a2ufi_37"),s.innerText=t.title;const a=document.createElement("div");a.classList.add("_lookerShortcutDetail_a2ufi_42"),a.innerText=t.detail,e.appendChild(n),e.appendChild(s),e.appendChild(a)};const sa="_lookerControlActive_aetrq_54",aa="_lookerClickable_aetrq_130",la="_lookerArrow_aetrq_134",ia="_lookerTime_aetrq_149";class oa extends ps{getEvents(){return{click:({update:e,event:t,dispatchEvent:n})=>{t.stopPropagation(),t.preventDefault(),Ms.action(e,n,null,!0)},mouseenter:({update:e})=>{e({hoveringControls:!0})},mouseleave:({update:e})=>{e({hoveringControls:!1})}}}createHTMLElement(){const e=document.createElement("img");return e.classList.add(la),e.src=vs.arrowRight,e.style.right="0.5rem",e}isShown({thumbnail:e}){return!e}renderSelf({showControls:e,disableControls:t,options:{hasNext:n}}){return e=e&&!t&&n,this.showControls===e||(e?(this.element.style.opacity="0.9",this.element.style.height="unset",this.element.style.display="block"):(this.element.style.opacity="0.0",this.element.style.height="0",this.element.style.display="none"),this.showControls=e),this.element}}class ra extends ps{getEvents(){return{click:({update:e,event:t,dispatchEvent:n})=>{t.stopPropagation(),t.preventDefault(),Xs.action(e,n,null,!0)},mouseenter:({update:e})=>{e({hoveringControls:!0})},mouseleave:({update:e})=>{e({hoveringControls:!1})}}}createHTMLElement(){const e=document.createElement("img");return e.src=vs.arrowLeft,e.classList.add(la),e.style.left="0.5rem",e}isShown({thumbnail:e}){return!e}renderSelf({showControls:e,disableControls:t,options:{hasPrevious:n}}){return e=e&&!t&&n,this.showControls===e||(e?(this.element.style.opacity="0.9",this.element.style.height="unset",this.element.style.display="block"):(this.element.style.opacity="0.0",this.element.style.height="0",this.element.style.display="none"),this.showControls=e),this.element}}class ca extends ps{constructor(){super(...arguments),this.showControls=!1}getEvents(){return{mouseenter:({update:e})=>{e({hoveringControls:!0})},mouseleave:({update:e})=>{e({hoveringControls:!1})}}}createHTMLElement(){const e=document.createElement("div");return e.classList.add("_lookerControls_aetrq_5"),e}isShown({thumbnail:e}){return!e}renderSelf({showControls:e,disableControls:t,error:n,loaded:s}){return e=e&&!t&&!n&&s,this.showControls===e||(e?(this.element.style.opacity="0.9",this.element.style.height="unset"):(this.element.style.opacity="0.0",this.element.style.height="0"),this.showControls=e),this.element}}class da extends ps{getEvents(){return{click:({event:e,update:t,dispatchEvent:n})=>{e.stopPropagation(),e.preventDefault(),Ks.action(t,n)}}}createHTMLElement(){const e=document.createElement("img");return e.classList.add(aa),e.style.padding="2px",e.style.gridArea="2 / 12 / 2 / 12",e}renderSelf({options:{fullscreen:e}}){return this.fullscreen!==e&&(this.fullscreen=e,e?this.element.classList.add(sa):this.element.classList.remove(sa),this.element.src=e?vs.fullscreenExit:vs.fullscreen,this.element.title="Toggle fullscreen (f)"),this.element}}class ma extends ps{getEvents(){return{click:({event:e,update:t,dispatchEvent:n})=>{e.stopPropagation(),e.preventDefault(),Gs.action(t,n)}}}createHTMLElement(){const e=document.createElement("img");return e.classList.add(aa),e.style.padding="2px",e.src=vs.plus,e.title="Zoom in (+)",e.style.gridArea="2 / 10 / 2 / 10",e}renderSelf(){return this.element}}class ua extends ps{getEvents(){return{click:({event:e,update:t,dispatchEvent:n})=>{e.stopPropagation(),e.preventDefault(),Ys.action(t,n)}}}createHTMLElement(){const e=document.createElement("img");return e.classList.add(aa),e.style.padding="2px",e.src=vs.minus,e.title="Zoom out (-)",e.style.gridArea="2 / 9 / 2 / 9",e}renderSelf(){return this.element}}class ha extends ps{getEvents(){return{click:({event:e,update:t,dispatchEvent:n})=>{e.stopPropagation(),e.preventDefault(),Ns.action(t,n)}}}createHTMLElement(){const e=document.createElement("img");return e.classList.add(aa),e.style.padding="2px",e.src=vs.help,e.title="Help (?)",e.style.gridArea="2 / 14 / 2 / 14",e}renderSelf({showHelp:e}){return this.active!==e&&(e?this.element.classList.add(sa):this.element.classList.remove(sa),this.active=e),this.element}}class pa extends ps{getEvents(){return{click:({event:e,update:t,dispatchEvent:n})=>{e.stopPropagation(),e.preventDefault(),Fs.action(t,n)}}}createHTMLElement(){const e=document.createElement("img");return e.classList.add(aa),e.style.padding="2px",e.src=vs.options,e.title="Settings (s)",e.style.gridArea="2 / 15 / 2 / 15",e}renderSelf({showOptions:e}){return this.active!==e&&(e?this.element.classList.add(sa):this.element.classList.remove(sa),this.active=e),this.element}}class ga extends ps{getEvents(){return{click:({event:e,update:t,dispatchEvent:n})=>{e.stopPropagation(),e.preventDefault(),Vs.action(t,n)}}}createHTMLElement(){const e=document.createElement("img");return e.style.padding="2px",e.src="assets/crop.607519b3.svg",e.title=`${Vs.title} (${Vs.shortcut})`,e.style.gridArea="2 / 11 / 2 / 11",e}renderSelf({disableOverlays:e}){return this.disabled!==e&&(this.element.style.opacity=e?"0.5":"1",this.element.style.cursor=e?"unset":"pointer",this.disabled=e),this.element}}class fa extends ps{getEvents(){return{click:({event:e,update:t,dispatchEvent:n})=>{e.stopPropagation(),e.preventDefault(),Os.action(t,n)}}}createHTMLElement(){const e=document.createElement("img");return e.style.padding="2px",e.src="assets/json.9847d1d5.svg",e.title=`${Os.title} (${Os.shortcut})`,e.style.gridArea="2 / 13 / 2 / 13",e}renderSelf({disableOverlays:e,options:{showJSON:t}}){return this.disabled!==e&&(this.element.style.opacity=e?"0.5":"1",this.element.style.cursor=e?"unset":"pointer",this.disabled=e),this.active!==t&&(t?this.element.classList.add(sa):this.element.classList.remove(sa),this.active=t),this.element}}class ba extends ps{constructor(){super(...arguments),this.errorElement=null}createHTMLElement(){return null}renderSelf({error:e,config:{thumbnail:t},options:{mimetype:n}}){if(e&&!this.errorElement){this.errorElement=document.createElement("div"),this.errorElement.classList.add("_lookerErrorPage_sfdgp_5");const s=document.createElement("img");if(s.src="assets/error.3f1a5768.svg",this.errorElement.appendChild(s),t)this.errorElement.style.cursor="pointer";else if(!0===e){const e=n.startsWith("video/"),t=document.createElement("p"),s=document.createElement("div");if(t.innerText=`This ${e?"video":"image"} failed to load. The file may not exist, or its type (${n}) may be unsupported.`,s.appendChild(t),this.errorElement.appendChild(s),e){const e=document.createElement("p");e.innerHTML="You can use\n              <code>\n                <a>\n                  fiftyone.utils.video.reencode_videos()\n                </a>\n              </code>\n              to re-encode videos in a supported format.",e.querySelector("a").addEventListener("click",(()=>ya("https://voxel51.com/docs/fiftyone/api/fiftyone.utils.video.html#fiftyone.utils.video.reencode_videos"))),s.appendChild(e)}}else{const e=document.createElement("p"),t=document.createElement("div");e.innerText="Something went wrong",t.appendChild(e),this.errorElement.appendChild(t)}}return this.errorElement}}const ya=e=>{let t;if(va())try{t=require("electron").shell.openExternal}catch{}return t?n=>{n.preventDefault(),t(e)}:null},va=()=>window.process&&window.process.versions&&Boolean(window.process.versions.electron);class xa extends ps{getEvents(){return{click:({event:e,update:t})=>{e.stopPropagation(),e.preventDefault(),t({options:{showJSON:!1}})},dblclick:({event:e})=>{e.stopPropagation(),e.preventDefault()}}}createHTMLElement(e,t){const n=document.createElement("div");n.classList.add("_lookerPanel_gkq4n_5");const s=document.createElement("div");s.classList.add("_lookerJSONPanel_p3yv7_5"),s.classList.add("_lookerPanelContainer_gkq4n_29");const a=document.createElement("div");a.classList.add("_lookerPanelVerticalContainer_gkq4n_38"),a.appendChild(n),s.appendChild(a),n.appendChild(document.createElement("pre")),n.onclick=e=>e.stopPropagation();const l=document.createElement("img");l.src="assets/close.47fb979b.svg",l.classList.add("_lookerPanelClose_gkq4n_50"),l.onclick=()=>{e({options:{showJSON:!1}}),t("options",{showJSON:!1})},l.title="Close JSON",a.appendChild(l);const i=document.createElement("img");return i.src="assets/clipboard.35e8b8b9.svg",i.classList.add("_lookerCopyJSON_p3yv7_24"),i.onclick=e=>{e.stopPropagation(),t("copy")},i.title="Copy JSON to clipboard",a.appendChild(i),s}isShown({thumbnail:e}){return!e}renderSelf({options:{showJSON:e}}){return this.json===e||(e?(this.element.style.opacity="0.9",this.element.style.display="flex"):(this.element.style.opacity="0.0",this.element.style.display="none"),this.json=e),this.element}}const wa="_lookerFullscreen_zwgek_38";class ka extends ps{getEvents(){return{keydown:({event:e,update:t,dispatchEvent:n})=>{if(e.altKey||e.ctrlKey||e.metaKey)return;const s=e;t((({SHORTCUTS:e,error:a})=>(!a&&s.key in e&&e[s.key].action(t,n,s.key,s.shiftKey),{})))},mouseenter:({update:e,dispatchEvent:t})=>{t("mouseenter"),e((({config:{thumbnail:e}})=>e?{hovering:!0}:{hovering:!0,showControls:!0}))},mouseleave:({update:e,dispatchEvent:t})=>{t("mouseleave"),e({hovering:!1,disableControls:!1,showControls:!1,showOptions:!1,panning:!1})}}}createHTMLElement(){const e=document.createElement("div");return e.classList.add("_looker_zwgek_16"),e.tabIndex=-1,e}renderSelf({hovering:e,error:t,config:{thumbnail:n},options:{fullscreen:s,inSelectionMode:a}}){!n&&e&&this.element!==document.activeElement&&this.element.focus(),t&&!n&&this.element.classList.add("_lookerError_zwgek_31");const l=this.element.classList.contains(wa);return s&&!l?this.element.classList.add(wa):!s&&l&&this.element.classList.remove(wa),n&&a!==this.selection&&(this.selection=a,this.element.title=a?Hn:"Click to expand"),this.element}}class Ea extends ps{constructor(){super(...arguments),this.showOptions=!1}getEvents(){return{click:({event:e})=>{e.stopPropagation(),e.preventDefault()},dblclick:({event:e})=>{e.stopPropagation(),e.preventDefault()},mouseenter:({update:e})=>{e({hoveringControls:!0})},mouseleave:({update:e})=>{e({hoveringControls:!1})}}}createHTMLElement(){const e=document.createElement("div");return e.classList.add("_lookerOptionsPanel_ym7lk_5"),e}isShown({thumbnail:e}){return!e}renderSelf({showOptions:e}){return this.showOptions===e||(e?(this.element.style.opacity="0.9",this.element.style.display="grid"):(this.element.style.opacity="0.0",this.element.style.display="none"),this.showOptions=e),this.element}}class Sa extends ps{getEvents(){return{click:({event:e,update:t,dispatchEvent:n})=>{e.stopPropagation(),e.preventDefault(),t((({options:{loop:e}})=>(n("options",{loop:!e}),{options:{loop:!e}})))}}}createHTMLElement(){return[this.label,this.checkbox]=fs("Loop video",!1),Ra([this.label])}renderSelf({options:{loop:e}}){return this.checkbox.checked=e,this.element}}class La extends ps{getEvents(){return{click:({event:e,update:t})=>{e.stopPropagation(),e.preventDefault(),t((({options:{onlyShowHoveredLabel:e}})=>({options:{onlyShowHoveredLabel:!e}})))}}}createHTMLElement(){return[this.label,this.checkbox]=fs("Only show hovered label",!1),Ra([this.label])}renderSelf({options:{onlyShowHoveredLabel:e}}){return this.checkbox.checked=e,this.element}}class Ta extends ps{getEvents(){return{click:({event:e,update:t,dispatchEvent:n})=>{e.stopPropagation(),e.preventDefault(),t((({options:{showConfidence:e}})=>(n("options",{showConfidence:!e}),{options:{showConfidence:!e}})))}}}createHTMLElement(){return[this.label,this.checkbox]=fs("Show confidence",!1),Ra([this.label])}renderSelf({options:{showConfidence:e}}){return this.checkbox.checked=e,this.element}}class Za extends ps{getEvents(){return{click:({event:e,update:t,dispatchEvent:n})=>{e.stopPropagation(),e.preventDefault(),t((({options:{showIndex:e}})=>(n("options",{showIndex:!e}),{options:{showIndex:!e}})))}}}createHTMLElement(){return[this.label,this.checkbox]=fs("Show index",!1),Ra([this.label])}renderSelf({options:{showIndex:e}}){return this.checkbox.checked=e,this.element}}class Ca extends ps{getEvents(){return{click:({event:e,update:t,dispatchEvent:n})=>{e.stopPropagation(),e.preventDefault(),t((({options:{showLabel:e}})=>(n("options",{showLabel:!e}),{options:{showLabel:!e}})))}}}createHTMLElement(){return[this.label,this.checkbox]=fs("Show label",!1),Ra([this.label])}renderSelf({options:{showLabel:e}}){return this.checkbox.checked=e,this.element}}class Pa extends ps{getEvents(){return{click:({event:e,update:t,dispatchEvent:n})=>{e.stopPropagation(),e.preventDefault(),t((({options:{showTooltip:e}})=>(n("options",{showTooltip:!e}),{options:{showTooltip:!e}})))}}}createHTMLElement(){return[this.label,this.checkbox]=fs("Show tooltip",!1),Ra([this.label])}renderSelf({options:{showTooltip:e}}){return this.checkbox.checked=e,this.element}}const Ra=function(e){const t=document.createElement("div");t.classList.add("_lookerOptionsInput_ym7lk_39");for(const n of e)t.appendChild(n);return t};class Ia extends ps{getEvents(){return{click:({event:e,update:t,dispatchEvent:n})=>{e.stopPropagation(),e.preventDefault(),t((({options:{useFrameNumber:e}})=>(n("options",{useFrameNumber:!e}),{options:{useFrameNumber:!e}})))}}}createHTMLElement(){return[this.label,this.checkbox]=fs("Use frame number",!1),Ra([this.label])}renderSelf({options:{useFrameNumber:e}}){return this.checkbox.checked=e,this.element}}const Wa={},Ma=(e,t=1)=>{const n=`${e}${t=Math.round(255*t)}`;if(n in Wa)return Wa[n];let s,a,l;return[s,a,l]="string"==typeof e?(e=>{let t,n,s;if(e.startsWith("#"))[t,n,s]=Ga(e);else if(e.startsWith("rgb")){let a=e.indexOf(",")>-1?",":" ";[t,n,s]=e.slice(4).split(")")[0].split(a)}else e.startsWith("hsl")&&([t,n,s]=Ya(e));return[t,n,s]})(e):e,Wa[n]=jn?s<<24|a<<16|l<<8|t:t<<24|l<<16|a<<8|s,Wa[n]},Xa=e=>{const t=new Uint32Array(1);return t[0]=e,[...new Uint8Array(t.buffer)]},Na=([e,t,n,s])=>`rgba(${e},${t},${n},${s/255})`,Ga=e=>{let t=0,n=0,s=0;return 4==e.length?(t=+("0x"+e[1]+e[1]),n=+("0x"+e[2]+e[2]),s=+("0x"+e[3]+e[3])):7==e.length&&(t=+("0x"+e[1]+e[2]),n=+("0x"+e[3]+e[4]),s=+("0x"+e[5]+e[6])),[t,n,s]},Ya=e=>{let t,n,s,a=e.indexOf(",")>-1?",":" ",[l,i,o]=e.slice(4).split(")")[0].split(a);if(l/=360,i/=100,o/=100,0===i)t=n=s=o;else{const e=(e,t,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e),a=o<.5?o*(1+i):o+i-o*i,r=2*o-a;t=e(r,a,l+1/3),n=e(r,a,l),s=e(r,a,l-1/3)}return[t,n,s]},Va=(()=>{let e=null;const t=e=>{const t=1e4*Math.sin(e+1);return t-Math.floor(t)};let n={};return(s,a)=>{if(JSON.stringify(e)!==JSON.stringify(s)&&(n={},e=s),a in n)return n[a];s=[...s],a>0&&(s=((e,n)=>{let s,a,l=e.length;for(;l;)a=Math.floor(t(n)*l--),s=e[l],e[l]=e[a],e[a]=s,++n;return e})(s,a));let l={},i=0;return n[a]=e=>(e in l||(l[e]=s[i%s.length],i++),l[e]),n[a]}})(),Fa=(e,t,n)=>Va(e,t)(n);class Ka extends ps{constructor(){super(...arguments),this.activePaths=[]}createHTMLElement(){const e=document.createElement("div");return e.classList.add("_lookerTags_ejznv_5"),e}isShown({thumbnail:e}){return e}renderSelf({config:{fieldSchema:e},options:{filter:t,activePaths:n,coloring:s,fieldsMap:a,mimetype:l,timeZone:i}},o){if(Oa(n,this.activePaths)&&this.colorByValue===s.byLabel&&this.colorSeed===s.seed)return this.element;const r=n.reduce(((n,r)=>{if(r.startsWith("tags.")&&Array.isArray(o.tags)&&o.tags.includes(r.slice(5))){const e=r.slice(5);n.push({color:Fa(s.pool,s.seed,r),title:e,value:e})}else if(r.startsWith("_label_tags.")){const e=r.slice("_label_tags.".length),t=o._label_tags[e]||0;if(t>0){const a=`${e}: ${t}`;n=[...n,{color:Fa(s.pool,s.seed,r),title:a,value:a}]}}else if(o[r]&&On.includes(o[r]._cls)){const e=o[r]._cls,a=e in zn;let i=(a?o[r][zn[e]]:[o[r]]).filter((e=>t[r](e)&&(l.includes("video")||Kn.includes(e._cls)))).map((e=>"Regression"===e._cls?e.value:e.label));"Regression"!==e?(i=Object.entries(i.reduce(((e,t)=>(e[t]||(e[t]=0),e[t]+=1,e)),{})),n=[...n,...i.map((([e,t])=>({color:Fa(s.pool,s.seed,s.byLabel?e:r),title:`${r}: ${e}`,value:a?`${za(e)}: ${t.toLocaleString()}`:za(e)})))]):n=[...n,...i.map((e=>({color:Fa(s.pool,s.seed,r),title:`${r}: ${e}`,value:za(e)})))]}else if(Ha(e[r])){let l=r;!o[r]&&a&&a[r]&&(l=a[r]);let c=o[l];const d=e[r],m=Ua(d,["fiftyone.core.fields.DateField"]),u=Ua(d,["fiftyone.core.fields.DateTimeField"]),h=Ua(d,["fiftyone.core.fields.FrameSupportField"]);if([void 0,null].includes(c))return n;const p=e=>{u&&e?e=((e,t)=>{const n="2-digit",s=36e5,a={timeZone:t,year:"numeric",day:n,month:n,hour:n,minute:n,second:n};return e%6e4||delete a.second,e%s||delete a.minute,e%864e5||delete a.hour,new Intl.DateTimeFormat("en-ZA",a).format(e).replaceAll("/","-")})(e,i):m&&e?e=(e=>{const t="2-digit",n={timeZone:"UTC",year:"numeric",day:t,month:t};return new Intl.DateTimeFormat("en-ZA",n).format(e).replaceAll("/","-")})(e):h&&Array.isArray(e)&&(e=`[${e.map(za).join(", ")}]`);const t=za(e);n=[...n,{color:Fa(s.pool,s.seed,s.byLabel?e:r),title:e,value:t}]};Array.isArray(c)&&!h||h&&"number"!=typeof c[0]||(c=[c]),(u||m)&&(c=c.map((e=>e.datetime)));const g=!t[r]||h||u||m?c:c.filter((e=>t[r](e))),f=[...g].sort().slice(0,3);f.forEach((e=>p(e)));const b=g.length-f.length;b>0&&p(`+${b} more`)}return n}),[]);return this.colorByValue=s.byLabel,this.colorSeed=s.seed,this.activePaths=[...n],this.element.innerHTML="",r.forEach((({value:e,color:t,title:n})=>{const s=document.createElement("div");s.innerHTML=e,s.title=n,s.style.backgroundColor=t,this.element.appendChild(s)})),this.element}}const Oa=(e,t)=>{if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0},za=e=>"string"==typeof e?e:"number"==typeof e?(e=e%1==0?e.toFixed(0):e<.001?e.toFixed(6):e.toFixed(3),Number(e).toLocaleString()):!0===e?"True":!1===e?"False":[void 0,null].includes(e)?"None":null,Da=new Set(["fiftyone.core.fields.BooleanField","fiftyone.core.fields.DateField","fiftyone.core.fields.DateTimeField","fiftyone.core.fields.FloatField","fiftyone.core.fields.FrameNumberField","fiftyone.core.fields.FrameSupportField","fiftyone.core.fields.IntField","fiftyone.core.fields.ObjectIdField","fiftyone.core.fields.StringField"]),Ha=e=>e&&(Da.has(e.ftype)||Da.has(e.subfield)),Ua=(e,t)=>e&&t.some((t=>t===e.ftype||t===e.subfield));class ja extends ps{getEvents(){return{click:({event:e,update:t,dispatchEvent:n})=>{t((({options:{selected:t,inSelectionMode:s}})=>s&&e.shiftKey?{}:(e.stopPropagation(),e.preventDefault(),n("selectthumbnail"),{options:{selected:!t}})))}}}createHTMLElement(){[this.label,this.checkbox]=fs("",!1),this.checkbox.checked=!1;const e=document.createElement("div");return e.classList.add("_lookerThumbnailSelector_h26h6_5"),e.appendChild(this.label),e.title=Hn,e}isShown({thumbnail:e}){return e}renderSelf({hovering:e,options:{selected:t,inSelectionMode:n}}){const s=e||t||n;return this.shown!==s&&(s?this.element.classList.add("_showSelector_h26h6_30"):this.element.classList.remove("_showSelector_h26h6_30"),this.shown=s),this.selected!==t&&(this.selected=t,this.checkbox.checked=t),this.element}}class Ba extends ps{createHTMLElement(){const e=document.createElement("div");return e.classList.add(ia),e.style.gridArea="2 / 3 / 2 / 3",e}renderSelf({duration:e,config:{frameRate:t,frameNumber:n}}){return e&&(this.element.innerHTML=Ss(n,e,t)),this.element}}class Ja extends ps{getEvents(){return{error:({event:e,dispatchEvent:t})=>{t("error",{event:e})},loadedmetadata:({update:e})=>{e((({config:{frameNumber:e,frameRate:t}})=>(this.element.currentTime=Es(e,t),{duration:this.element.duration})))},seeked:({update:e,dispatchEvent:t})=>{e({loaded:!0}),t("loaded")}}}createHTMLElement(e){return this.imageSource=document.createElement("canvas"),this.imageSource.style.imageRendering="pixelated",e((({config:{thumbnail:t,dimensions:n,src:s,frameRate:a,frameNumber:l}})=>{this.imageSource.width=n[0],this.imageSource.height=n[1],this.src=s;return(t?Ps:Zs)().then((([t,n])=>{const i=()=>{requestAnimationFrame((()=>{requestAnimationFrame((()=>{setTimeout((()=>{const s=this.imageSource.getContext("2d");s.imageSmoothingEnabled=!1,s.drawImage(t,0,0),n(),t.removeEventListener("seeked",i),e({loaded:!0,duration:t.duration})}),20)}))}))};t.addEventListener("seeked",i);const o=s=>{s.path&&s.path[0]&&(s=s.path[0].error),s.originalTarget&&(s=s.originalTarget.error),t.removeEventListener("error",o),n(),e({error:!0})},r=()=>{t.currentTime=Es(l,a),e({duration:t.duration}),t.removeEventListener("error",o),t.removeEventListener("loadedmetadata",r)};t.src=s,t.addEventListener("error",o),t.addEventListener("loadedmetadata",r)})),{}})),null}renderSelf(){return null}}class Aa extends ps{constructor(){super(...arguments),this.src=""}getEvents(){return{load:({update:e})=>{this.imageSource=this.element,e({loaded:!0})},error:({event:e,dispatchEvent:t})=>{t("error",{event:e})}}}createHTMLElement(){const e=new Image;return e.loading="eager",e}renderSelf({config:{src:e}}){return this.src!==e&&(this.src=e,this.element.setAttribute("src",e)),null}}class _a extends ps{constructor(){super(...arguments),this.buffering=!1}isShown({thumbnail:e}){return e}createHTMLElement(){const e=document.createElement("div");return e.style.height="5px",e.style.position="absolute",e.style.bottom="0",e.style.width="100%",e.style.backgroundImage="linear-gradient(\n      130deg,\n      rgba(225, 100, 40, 0) 0%,\n      rgb(225, 100, 40) 50%,\n      rgba(225, 100, 40, 0) 100%\n    )",e.classList.add("_lookerLoader_zwgek_16"),e}renderSelf({duration:e,buffering:t,hovering:n,waitingForVideo:s,error:a,lockedToSupport:l,config:{frameRate:i,support:o}}){if((t||s)&&n&&!a===this.buffering)return this.element;const r=l?o[0]:1,c=l?o[1]:ks(e,e,i);return this.buffering=(t||s)&&n&&!a&&r!==c,this.buffering?this.element.style.display="block":this.element.style.display="none",this.element}}class Qa extends ps{constructor(){super(...arguments),this.locked=null,this.singleFrame=null}getEvents(){return{click:({event:e,update:t,dispatchEvent:n})=>{e.preventDefault(),e.stopPropagation(),js.action(t,n)}}}createHTMLElement(){this.pause=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.pause.setAttribute("height","24"),this.pause.setAttribute("width","24"),this.pause.setAttribute("viewBox","0 0 24 24");let e=document.createElementNS("http://www.w3.org/2000/svg","path");e.setAttribute("fill","rgb(238, 238, 238)"),e.setAttribute("d","M6 19h4V5H6v14zm8-14v14h4V5h-4z"),this.pause.appendChild(e),e=document.createElementNS("http://www.w3.org/2000/svg","path"),e.setAttribute("fill","none"),e.setAttribute("d","M0 0h24v24H0z"),this.pause.appendChild(e),this.play=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.play.setAttribute("height","24"),this.play.setAttribute("width","24"),this.play.setAttribute("viewBox","0 0 24 24"),e=document.createElementNS("http://www.w3.org/2000/svg","path"),e.setAttribute("fill","rgb(238, 238, 238)"),e.setAttribute("d","M8 5v14l11-7z"),this.play.appendChild(e),e=document.createElementNS("http://www.w3.org/2000/svg","path"),e.setAttribute("fill","none"),e.setAttribute("d","M0 0h24v24H0z"),this.buffering=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.buffering.classList.add("_bufferingCircle_wynh6_5"),this.buffering.setAttribute("viewBox","12 12 24 24");const t=document.createElementNS("http://www.w3.org/2000/svg","circle");t.setAttribute("cx","24"),t.setAttribute("cy","24"),t.setAttribute("r","9"),t.setAttribute("stroke-width","2"),t.setAttribute("stroke","rgb(238, 238, 238)"),t.setAttribute("fill","none"),t.classList.add("_bufferingPath_wynh6_21"),this.buffering.appendChild(t);const n=document.createElement("div");return n.style.marginTop="2px",n.style.position="relative",n.style.height="24px",n.style.width="24px",n.style.gridArea="2 / 2 / 2 / 2",n}renderSelf({playing:e,buffering:t,loaded:n,duration:s,lockedToSupport:a,config:{frameRate:l,support:i}}){let o=!1;if(null===this.singleFrame&&n&&this.locked!==a&&(this.singleFrame=a?i[0]===i[1]:1===ks(s,s,l),this.locked=a,o=!0),e===this.isPlaying&&this.isBuffering===t&&n||(this.element.innerHTML="",t||!n?(this.element.appendChild(this.buffering),this.element.title="Loading",this.element.style.cursor="default"):e?(this.element.appendChild(this.pause),this.element.title="Pause (space)",this.element.style.cursor="pointer"):(this.element.appendChild(this.play),this.element.title="Play (space)",this.element.style.cursor="pointer"),this.isPlaying=e,this.isBuffering=t||!n),o){this.play.children[0].setAttribute("fill",this.singleFrame?"rgb(138, 138, 138)":"rgb(238, 238, 238)"),this.element.style.cursor=this.singleFrame?"unset":"pointer",this.element.title=this.singleFrame?"Only one frame":"Play (space)"}return this.element}}class $a extends ps{getEvents(){return{mouseenter:({update:e})=>{e({seekBarHovering:!0})},mousedown:({update:e})=>{e({seeking:!0,seekBarHovering:!0,options:{showJSON:!1}})},mouseleave:({update:e})=>{e((({seeking:e})=>({seekBarHovering:e})))}}}createHTMLElement(){const e=document.createElement("div");return e.classList.add("_lookerThumb_wynh6_94"),e}renderSelf({seeking:e,seekBarHovering:t,frameNumber:n,duration:s,config:{frameRate:a}}){if(null!==s){const e=(n-1)/(ks(s,s,a)-1)*100;this.element.style.setProperty("--progress",`${Math.max(0,e-.5)}%`),this.element.value=e}const l=e||t;return l!==this.active&&(this.active=l,l?this.element.classList.add("_lookerThumbSeeking_wynh6_111"):this.element.classList.remove("_lookerThumbSeeking_wynh6_111")),this.element}}class qa extends ps{getEvents(){return{mousedown:({update:e})=>{e({seeking:!0,options:{showJSON:!1}})},mouseenter:({update:e})=>{e({seekBarHovering:!0})},mouseleave:({update:e})=>{e((({seeking:e})=>({seekBarHovering:e})))}}}createHTMLElement(){const e=document.createElement("input");return e.setAttribute("type","range"),e.setAttribute("min","0"),e.setAttribute("max","100"),e.classList.add("_lookerSeekBar_wynh6_84"),e}renderSelf({frameNumber:e,config:{frameRate:t,support:n,thumbnail:s},duration:a,buffers:l,lockedToSupport:i}){if(s)return this.element;if(null!==a){const s=ks(a,a,t),o=i?(n[0]-1)/(s-1)*100:0;this.element.style.setProperty("--start",`${o}%`);const r=i?(n[1]-1)/(s-1)*100:100;this.element.style.setProperty("--end",`${r}%`);let c=100;if(s-1>0){let t=0;for(let n=0;n<l.length;n++)if(l[n][0]<=e&&l[n][1]>=e){t=n;break}c=(l[t][1]-1)/(s-1)*100}this.element.style.setProperty("--buffer-progress",`${Math.min(c,r)}%`);const d=(e-1)/(s-1)*100;this.element.style.display="block",this.element.style.setProperty("--progress",`${d}%`),this.element.value=d}else this.element.style.display="none";return this.element}}class el extends ps{createHTMLElement(){const e=document.createElement("div");return e.classList.add(ia),e.style.gridArea="2 / 5 / 2 / 5",e}renderSelf({frameNumber:e,duration:t,config:{frameRate:n},options:{useFrameNumber:s}}){if("number"!=typeof t)return this.element.innerHTML="",this.element;const a=s?Ss(e,t,n):((e,t,n)=>`${Ls(e,t,n)} / ${Ls(ks(n,n,t),t,n)}`)(e,n,t);return this.element.innerHTML=a,this.element}}class tl extends ps{constructor(){super(...arguments),this.loop=!1,this.playbackRate=1,this.waitingToPause=!1,this.waitingToPlay=!1,this.waitingToRelease=!1}getEvents(){return{error:({update:e,event:t,dispatchEvent:n})=>{this.releaseVideo(),e({error:!0}),n("error",{event:t})},loadedmetadata:({update:e})=>{e((({config:{frameRate:e},frameNumber:t})=>(this.element.currentTime=Es(t,e),{duration:this.element.duration})))},seeked:({update:e,dispatchEvent:t})=>{requestAnimationFrame((()=>{requestAnimationFrame((()=>{e((({loaded:e,playing:t,options:{autoplay:n}})=>e?{waitingForVideo:!1}:{loaded:!0,playing:n||t,waitingForVideo:!1})),t("load")}))}))},play:({update:e,dispatchEvent:t})=>{const n=t=>{e((({duration:e,playing:n,options:{loop:s},config:{frameRate:a,support:l},lockedToSupport:i})=>{let o=ks(t,e,a);const r=i?l[1]:ks(e,e,a);if(o>=r){const e=i?l[0]:1;n=s,o=s?e:r}else this.frameNumber=o;return{frameNumber:o,playing:n}}),(({playing:e,seeking:t,buffering:s})=>{!e||t||s||this.requestCallback(n)}))};e((({frameNumber:e})=>({playing:!0,disableOverlays:!0,frameNumber:e,rotate:0})),((e,s)=>{gs(t,e.playing)(e,s),this.requestCallback(n)}))},pause:({update:e,dispatchEvent:t})=>{e({disableOverlays:!1},((e,n)=>gs(t,!1)(e,n)))},timeupdate:({dispatchEvent:e,update:t})=>{t((({duration:t,config:{frameRate:n}})=>(e("timeupdate",{frameNumber:ks(this.element.currentTime,t,n)}),{})))}}}createHTMLElement(e){return this.update=e,this.element=null,e((({config:{thumbnail:t,dimensions:n,src:s,frameRate:a,support:l}})=>(this.src=s,this.posterFrame=l?l[0]:1,t?(this.canvas=document.createElement("canvas"),this.canvas.width=n[0],this.canvas.height=n[1],this.canvas.style.imageRendering="pixelated",Ps().then((([t,n])=>{const i=s=>{s.path&&s.path[0]&&(s=s.path[0].error),s.originalTarget&&(s=s.originalTarget.error),t.removeEventListener("error",i),t.removeEventListener("seeked",o),n(),e({error:!0})},o=()=>{requestAnimationFrame((()=>{requestAnimationFrame((()=>{setTimeout((()=>{const e=this.canvas.getContext("2d");e.imageSmoothingEnabled=!1,e.drawImage(t,0,0),n(),t.removeEventListener("seeked",o),t.removeEventListener("error",i),this.update({hasPoster:!0,duration:t.duration,loaded:!0})}),20)}))}))},r=()=>{t.addEventListener("seeked",o),t.currentTime=l?Es(l[0],a):0,t.removeEventListener("loadedmetadata",r)};t.addEventListener("error",i),t.addEventListener("loadedmetadata",r),t.src=s}))):(this.element=document.createElement("video"),this.element.preload="metadata",this.element.src=s),{}))),this.requestCallback=e=>{requestAnimationFrame((()=>{this.element&&e(this.element.currentTime)}))},this.element}acquireVideo(){let e=!1;return this.update((({waitingForVideo:t,error:n})=>t||n?{}:(Zs().then((([e,t])=>{this.update((({frameNumber:n,hovering:s,config:{frameRate:a,thumbnail:l}})=>(this.element=e,this.release=t,!s&&l||this.waitingToRelease?this.releaseVideo():(this.attachEvents(),this.frameNumber=Es(n,a),this.element.currentTime=Es(n,a),this.element.src=this.src),{})))})),e=!0,{waitingForVideo:!0}))),e}releaseVideo(){if(this.waitingToPause||this.waitingToPlay||!this.element)return this.waitingToRelease=!0,this.imageSource=this.canvas,void(this.canvas&&this.update((({waitingForVideo:e})=>e?{waitingForVideo:!1}:{})));!this.element.paused&&this.element.pause(),this.waitingToRelease=!1,this.removeEvents(),this.element=null,this.release&&this.release(),this.release=null,this.update({waitingForVideo:!1,frameNumber:this.posterFrame,playing:!1})}renderSelf({options:{loop:e,volume:t,playbackRate:n},config:{frameRate:s,thumbnail:a},frameNumber:l,seeking:i,playing:o,loaded:r,buffering:c,hovering:d,hasPoster:m,destroyed:u}){if(u&&this.releaseVideo(),this.element){if(a&&!d)return this.releaseVideo(),null}else if(d&&a){if(this.acquireVideo())return null}return m&&l===this.posterFrame?this.imageSource=this.canvas:this.imageSource=this.element,this.element?(r&&o&&!i&&!c&&this.element.paused&&(this.waitingToPlay=!0,this.element.play().then((()=>{if(this.waitingToPlay=!1,this.waitingToPause&&this.element&&this.element.pause(),this.waitingToPause=!1,this.waitingToRelease)return this.releaseVideo(),null}))),!r||o&&!i&&!c||this.element.paused||(this.waitingToPlay?this.waitingToPause=!0:this.element.pause()),this.loop!==e&&(this.element.loop=e,this.loop=e),this.playbackRate!==n&&(this.element.playbackRate=n,this.playbackRate=n),this.volume!==t&&(this.element.volume=t,this.volume=t),this.frameNumber!==l&&(this.element.currentTime=Es(l,s),this.frameNumber=l),null):null}}const nl=({seeking:e,duration:t,config:{frameRate:n,support:s},lockedToSupport:a},l)=>{if(t&&e){const e=l.currentTarget,{width:i,left:o}=e.getBoundingClientRect(),r=ks(t,t,n),c=Math.min(Math.max(1,Math.round((l.clientX+6-o)/i*r)),r);return{frameNumber:c,lockedToSupport:!!s&&(a&&c>=s[0]&&c<=s[1])}}return{}};const sl={node:class extends ps{getEvents(){return{}}createHTMLElement(){const e=document.createElement("div");return e.classList.add("_lookerVolume_wynh6_31"),e}renderSelf(){return this.element}},children:[{node:class extends ps{getEvents(){return{click:({event:e,update:t,dispatchEvent:n})=>{e.stopPropagation(),e.preventDefault(),Bs.action(t,n)}}}createHTMLElement(){const e=document.createElement("img");return e.classList.add(aa),e.style.padding="2px",e}renderSelf({options:{volume:e}}){return 0===e===this.muted||(this.muted=0===e,this.muted?(this.element.title="Unmute (m)",this.element.src="assets/volumeOff.453beb30.svg"):(this.element.title="Mute (m)",this.element.src="assets/volume.603995f5.svg")),this.element}}},{node:class extends ps{getEvents(){return{click:({event:e})=>{e.stopPropagation()},input:({update:e,dispatchEvent:t})=>{const n=this.element.valueAsNumber;t("options",{volume:n}),e({options:{volume:n}})}}}createHTMLElement(){const e=document.createElement("input");return e.setAttribute("type","range"),e.setAttribute("min","0"),e.setAttribute("max","1"),e.setAttribute("step","0.01"),e}renderSelf({options:{volume:e}}){return this.volume!==e&&(this.element.style.setProperty("--volume",100*e+"%"),this.element.value=e.toFixed(4),this.element.title=`Volume ${(100*e).toFixed(0)}%`,this.volume=e),this.element}}}]};const al={node:class extends ps{getEvents(){return{}}createHTMLElement(){const e=document.createElement("div");return e.classList.add("_lookerPlaybackRate_wynh6_30"),e}renderSelf(){return this.element}},children:[{node:class extends ps{getEvents(){return{click:({event:e,update:t,dispatchEvent:n})=>{e.stopPropagation(),e.preventDefault(),Js(t,n)}}}createHTMLElement(){const e=document.createElement("img");return e.classList.add(aa),e.style.padding="2px",e.title="Reset playback rate (p)",e.src="assets/playbackRate.c6d444cb.svg",e}renderSelf(){return this.element}}},{node:class extends ps{getEvents(){return{click:({event:e})=>{e.stopPropagation()},input:({update:e,dispatchEvent:t})=>{t("options",{playbackRate:this.element.valueAsNumber}),e({options:{playbackRate:this.element.valueAsNumber}})}}}createHTMLElement(){const e=document.createElement("input");return e.setAttribute("type","range"),e.setAttribute("min","0.1"),e.setAttribute("max","2"),e.setAttribute("step","0.1"),e}renderSelf({options:{playbackRate:e},config:{frameRate:t}}){return this.playbackRate!==e&&(this.element.title=`${e.toFixed(1)}x ${(t*e).toFixed(2)} fps`,this.element.style.setProperty("--playback",e/2*100+"%"),this.element.value=e.toFixed(4),this.playbackRate=e),this.element}}}]};class ll extends ps{isShown(e){return Boolean(e.support)}getEvents(){return{click:({event:e,update:t,dispatchEvent:n})=>{e.stopPropagation(),e.preventDefault(),_s.action(t,n)}}}createHTMLElement(){const e=document.createElement("img");return e.style.padding="2px",e.title=`${_s.title} (${_s.shortcut})`,e.style.gridArea="2 / 8 / 2 / 8",e.style.cursor="pointer",e}renderSelf({lockedToSupport:e}){return this.active!==e&&(e?this.element.classList.add(sa):this.element.classList.remove(sa),this.element.src=e?"assets/lock.ec7ff80a.svg":"assets/lockOpen.26f88635.svg",this.active=e),this.element}}const il=(e,t,n)=>{var s,a;return xs(e,{node:(s=ka,a=function(){return{mouseenter:({update:e})=>{e((({config:{thumbnail:e}})=>e?{playing:!0}:{}))},mouseleave:({update:e})=>{e((({config:{thumbnail:e,support:t}})=>e?{frameNumber:Boolean(t)?t[0]:1,playing:!1}:{seeking:!1,seekBarHovering:!1}))},mousemove:({event:e,update:t})=>{t((t=>nl(t,e)))},mouseup:({event:e,update:t})=>{t((t=>r(o({},nl(t,e)),{seeking:!1})))}}},class extends s{getEvents(){const e=super.getEvents(),t=a();return Object.entries(t).forEach((([t,n])=>{const s=e[t];e[t]=e=>{s&&s(e),n&&n(e)}})),e}}),children:[{node:tl},{node:ys},{node:ba},{node:Ka},{node:ja},{node:xa},{node:_a},{node:ta},{node:ca,children:[{node:qa},{node:$a},{node:Qa},{node:el},al,sl,{node:ll},{node:ma},{node:ua},{node:ga},{node:da},{node:fa},{node:pa},{node:ha}]},{node:ra},{node:oa},{node:Ea,children:[{node:Sa},{node:La},{node:Ta},{node:Za},{node:Ca},{node:Pa},{node:Ia}]}]},t,n)},ol=(e,t,n)=>{const[s,a,l,i]=e.canvasBBox;return[s+l*t,a+i*n]},rl=e=>{let t=0;const n=e=>{if(e instanceof ArrayBuffer)t+=e.byteLength;else if(null!=e)switch(typeof e){case"number":t+=8;break;case"string":t+=2*e.length;break;case"boolean":t+=4;break;case"object":var s=Object.prototype.toString.call(e).slice(8,-1);if("Object"===s||"Array"===s)for(var a in e)e.hasOwnProperty(a)&&n(e[a]);else t+=2*e.toString().length}};return n(e),t},cl=(e,t,n)=>{e.strokeStyle=n,e.beginPath(),e.moveTo(...ol(t,0,0)),e.lineTo(...ol(t,1,0)),e.lineTo(...ol(t,1,1)),e.lineTo(...ol(t,0,1)),e.closePath(),e.stroke()},dl=(e,t,n)=>{e.lineWidth=t.strokeWidth,e.setLineDash([]),cl(e,t,n),e.setLineDash([t.dashLength]),cl(e,t,"#ffffff"),e.setLineDash([])};var ml,ul;(ul=ml||(ml={}))[ul.NONE=0]="NONE",ul[ul.CONTENT=1]="CONTENT",ul[ul.BORDER=2]="BORDER";const hl=(e,t,n)=>!(e.options.activePaths&&!e.options.activePaths.includes(t))&&(!e.options.filter||!e.options.filter[t]||e.options.filter[t](n));class pl{constructor(e,t){this.field=e,this.label=t}isShown(e){return hl(e,this.field,this.label)}isSelected(e){return e.options.selectedLabels.includes(this.label.id)}getColor({options:e}){if(!this.color){const t=e.coloring.byLabel?this.label.label:this.field;this.color=Fa(e.coloring.pool,e.coloring.seed,t)}return this.color}getSizeBytes(){return rl(this.label)}getSelectData(e){return{id:this.label.id,field:this.field,frameNumber:e.frameNumber}}}class gl{constructor(e){this.labels=e,this.labelBoundingBoxes={}}getColor(e,t,n){const s="Regression"===n._cls?t:e.options.coloring.byLabel?n.label:t;return Fa(e.options.coloring.pool,e.options.coloring.seed,s)}isShown(e){return this.getFiltered(e).length>0}getSelectData(e){const{label:{id:t},field:n}=this.getPointInfo(e);return{id:t,field:n}}getMouseDistance(e){return this.getPointInfo(e)?0:1/0}containsPoint(e){return this.getPointInfo(e)?ml.CONTENT:ml.NONE}getPointInfo(e){const t=this.getFilteredAndFlat(e),[n,s]=e.config.dimensions;let a;for(const[l,i]of t){const t=this.labelBoundingBoxes[i.id];if(t){let[o,r,c,d]=t;[o,r,c,d]=[o*n,r*s,c*n,d*s];const[m,u]=e.pixelCoordinates;m>=o&&u>=r&&m<=o+c&&u<=r+d&&(a={field:l,label:i,type:i._cls,color:this.getColor(e,l,i)})}}return a}draw(e,t){const n=this.getFilteredAndFlat(t),s=Math.max(...n.map((([n,s])=>e.measureText(this.getLabelText(t,s)).width))),a={};let l=t.textPad;n.forEach((([n,i])=>{const o=this.strokeClassification(e,t,l,s,n,i);l=o.top,o.box&&(a[i.id]=o.box)})),this.labelBoundingBoxes=a}getPoints(e){return this.getFilteredAndFlat(e).length?bl():[]}getSizeBytes(){let e=100;return this.labels.forEach((([t,n])=>{n.forEach((t=>{e+=rl(t)}))})),e}getFiltered(e){return this.labels.map((([t,n])=>[t,n.filter((n=>Kn.includes(n._cls)&&hl(e,t,n)))]))}getFilteredAndFlat(e,t=!0){let n=[];if(this.getFiltered(e).forEach((([e,t])=>{n=[...n,...t.map((t=>[e,t]))]})),t){const t=Object.fromEntries(e.options.activePaths.map((e=>[e,[]])));n.forEach((([e,n])=>{t[e].push(n)})),n=e.options.activePaths.reduce(((e,n)=>[...e,...t[n].map((e=>[n,e]))]),[]),n.sort(((e,t)=>e[0]===t[0]?e[1].label&&t[1].label&&e[1].label<t[1].label?-1:e[1].label>t[1].label?1:0:-1))}return n}isSelected(e,t){return e.options.selectedLabels.includes(t.id)}strokeClassification(e,t,n,s,a,l){const i=this.getLabelText(t,l);if(0===i.length)return{top:n};const o=this.getColor(t,a,l),[r,c]=t.canvasBBox,d=e.globalAlpha;e.globalAlpha=t.options.alpha;let[m,u,h,p]=[t.textPad+r,n+c,3*t.textPad+s,t.fontSize+3*t.textPad];return e.beginPath(),e.fillStyle=o,e.moveTo(m,u),e.lineTo(m+h,u),e.lineTo(m+h,u+p),e.lineTo(m,u+p),e.closePath(),e.fill(),e.globalAlpha=d,e.fillStyle="#ffffff",e.fillText(i,m+t.textPad,u+p-t.textPad),this.strokeBorder(e,t,[m,u,h,p],o),this.isSelected(t,l)&&this.strokeBorder(e,t,[m,u,h,p],"#ffffff",t.dashLength),m-=r,u-=c,{top:u+p+2*t.textPad,box:[(m-t.textPad/2)/t.canvasBBox[2],u/t.canvasBBox[3],(h+t.textPad/2)/t.canvasBBox[2],(p+t.textPad)/t.canvasBBox[3]]}}getLabelText(e,t){let n=e.options.showLabel?`${yl(t)}`:"";return e.options.showConfidence&&!isNaN(t.confidence)&&(n.length&&(n+=" "),n+=`(${Number(t.confidence).toFixed(2)})`),n}strokeBorder(e,t,[n,s,a,l],i,o){e.beginPath(),e.lineWidth=t.strokeWidth,e.strokeStyle=i,e.setLineDash(o?[o]:[]),e.moveTo(n,s),e.lineTo(n+a,s),e.lineTo(n+a,s+l),e.lineTo(n,s+l),e.closePath(),e.stroke()}needsLabelUpdate(){return!1}getLabelData(){return[]}updateLabelData(){}}class fl extends gl{getFiltered(e){return this.labels.map((([t,n])=>[t,n.filter((n=>{const s=hl(e,t,n)&&n.label;return"TemporalDetection"===n._cls?s&&n.support[0]<=e.frameNumber&&n.support[1]>=e.frameNumber:s}))]))}}const bl=e=>[],yl=e=>"Regression"===e._cls?e.value:e.label,vl=(e,t)=>{const n=e.options.activePaths,s=Object.fromEntries(n.map((e=>[e,[]])));let a=null;for(const h of t)h instanceof gl?a=h:h.field&&h.field in s&&h.isShown(e)&&s[h.field].push(h);let l=n.reduce(((e,t)=>[...e,...s[t]]),[]);if(a&&!e.config.thumbnail&&(l=[a,...l]),t.length<1)return[l,0];if(e.config.thumbnail||!e.cursorCoordinates)return[l,0];const[i,o]=e.pixelCoordinates;let r=l.filter((t=>t.containsPoint(e,[i,o])>ml.NONE)).sort(((t,n)=>t.getMouseDistance(e,[i,o])-n.getMouseDistance(e,[i,o])));const c=l.filter((t=>t instanceof gl||t.containsPoint(e,[i,o])===ml.NONE));let d=e.rotate;var m,u;return 0!==e.rotate&&([r,d]=(m=r,u=e.rotate,u=Math.min(u,m.length-1),[[...m.slice(u),...m.slice(0,u)],u])),e.options.onlyShowHoveredLabel?[r.length?[r[0]]:[],d]:[[...r,...c],d]};class xl extends pl{constructor(e,t){if(super(e,t),this.label.mask){const[e,t]=this.label.mask.data.shape;this.canvas=document.createElement("canvas"),this.canvas.width=t,this.canvas.height=e,this.imageData=new ImageData(new Uint8ClampedArray(this.label.mask.image),t,e);const n=this.canvas.getContext("2d");n.imageSmoothingEnabled=!1,n.clearRect(0,0,this.label.mask.data.shape[1],this.label.mask.data.shape[0]),n.putImageData(this.imageData,0,0)}}containsPoint(e){const[t,n,s,a]=this.getDrawnBBox(e),[l,i]=e.pixelCoordinates;return l>=t&&i>=n&&l<=t+s&&i<=n+a?ml.CONTENT:this.isInHeader(e)?ml.BORDER:ml.NONE}draw(e,t){this.label.mask&&this.drawMask(e,t),!t.config.thumbnail&&this.drawLabelText(e,t),this.strokeRect(e,t,this.getColor(t)),this.isSelected(t)&&this.strokeRect(e,t,"#ffffff",t.dashLength)}getMouseDistance(e){const[t,n]=e.pixelCoordinates,[s,a,l,i]=this.getDrawnBBox(e);if(this.isInHeader(e))return 0;const o=[Qn([t,n],[s,a],[s+l,a]),Qn([t,n],[s+l,a],[s+l,a+i]),Qn([t,n],[s+l,a+i],[s,a+i]),Qn([t,n],[s,a+i],[s,a])];return Math.min(...o)}getPointInfo(e){return{color:this.getColor(e),field:this.field,label:this.label,type:"Detection"}}getPoints(){return wl([this.label])}drawLabelText(e,t){const n=this.getLabelText(t);if(!n.length)return void(this.labelBoundingBox=null);const s=this.getColor(t),[a,l,i,o]=this.label.bounding_box;e.beginPath(),e.fillStyle=s;let[r,c]=ol(t,a,l);[r,c]=[r-t.strokeWidth/2,c],e.moveTo(r,c);const{width:d}=e.measureText(n),m=t.fontSize,u=3*t.textPad+t.strokeWidth,h=r+d+u,p=c-m-u;e.lineTo(h,c),e.lineTo(h,p),e.lineTo(r,p),e.closePath(),e.fill(),e.fillStyle="#ffffff";const g=t.textPad+t.strokeWidth;e.fillText(n,r+g,c-g);const f=(m+u)/t.canvasBBox[3];this.labelBoundingBox=[a-t.strokeWidth/t.canvasBBox[2],l-f,(d+u+t.strokeWidth/2)/t.canvasBBox[2],f+t.strokeWidth/t.canvasBBox[3]]}drawMask(e,t){const[n,s,a,l]=this.label.bounding_box,[i,o]=ol(t,n,s),r=e.globalAlpha;e.globalAlpha=t.options.alpha,e.drawImage(this.canvas,i,o,a*t.canvasBBox[2],l*t.canvasBBox[3]),e.globalAlpha=r}getLabelText(e){let t=this.label.label&&e.options.showLabel?`${this.label.label}`:"";return e.options.showIndex&&!isNaN(this.label.index)&&(t.length&&(t+=" "),t+=`${Number(this.label.index).toLocaleString()}`),!e.options.showConfidence||isNaN(this.label.confidence)&&!Fn.has(this.label.confidence)||(t.length&&(t+=" "),t+=`(${"number"==typeof this.label.confidence?Number(this.label.confidence).toFixed(2):this.label.confidence})`),t}isInHeader(e){if(!this.labelBoundingBox)return!1;const[t,n]=e.config.dimensions,[s,a]=e.pixelCoordinates;let[l,i,o,r]=this.labelBoundingBox;return[l,i,o,r]=[l*t,i*n,o*t,r*n],s>=l&&a>=i&&s<=l+o&&a<=i+r}strokeRect(e,t,n,s){const[a,l,i,o]=this.label.bounding_box;e.beginPath(),e.lineWidth=t.strokeWidth,e.strokeStyle=n,e.setLineDash(s?[s]:[]),e.moveTo(...ol(t,a,l)),e.lineTo(...ol(t,a+i,l)),e.lineTo(...ol(t,a+i,l+o)),e.lineTo(...ol(t,a,l+o)),e.closePath(),e.stroke()}getDrawnBBox(e){const[t,n]=e.config.dimensions;let[s,a,l,i]=this.label.bounding_box;const o=e.strokeWidth/e.canvasBBox[2],r=e.strokeWidth/e.canvasBBox[3];return[(s-o)*t,(a-r)*n,(l+2*o)*t,(i+2*r)*n]}}const wl=e=>{let t=[];return e.forEach((e=>{const[n,s,a,l]=e.bounding_box;t=[...t,[n,s],[n+a,s],[n+a,s+l],[n,s+l]]})),t},kl={exports:{}},El=kl.exports;!function(e){if("object"==typeof El&&void 0!==kl)kl.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).pako=e()}}((function(){return function e(t,n,s){function a(i,o){if(!n[i]){if(!t[i]){var r="function"==typeof require&&require;if(!o&&r)return r(i,!0);if(l)return l(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[i]={exports:{}};t[i][0].call(d.exports,(function(e){return a(t[i][1][e]||e)}),d,d.exports,e,t,n,s)}return n[i].exports}for(var l="function"==typeof require&&require,i=0;i<s.length;i++)a(s[i]);return a}({1:[function(e,t,n){var s="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function a(e,t){return Object.prototype.hasOwnProperty.call(e,t)}n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var s in n)a(n,s)&&(e[s]=n[s])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var l={arraySet:function(e,t,n,s,a){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+s),a);else for(var l=0;l<s;l++)e[a+l]=t[n+l]},flattenChunks:function(e){var t,n,s,a,l,i;for(s=0,t=0,n=e.length;t<n;t++)s+=e[t].length;for(i=new Uint8Array(s),a=0,t=0,n=e.length;t<n;t++)l=e[t],i.set(l,a),a+=l.length;return i}},i={arraySet:function(e,t,n,s,a){for(var l=0;l<s;l++)e[a+l]=t[n+l]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,l)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,i))},n.setTyped(s)},{}],2:[function(e,t,n){var s=e("./common"),a=!0,l=!0;try{String.fromCharCode.apply(null,[0])}catch(c){a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(c){l=!1}for(var i=new s.Buf8(256),o=0;o<256;o++)i[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;function r(e,t){if(t<65534&&(e.subarray&&l||!e.subarray&&a))return String.fromCharCode.apply(null,s.shrinkBuf(e,t));for(var n="",i=0;i<t;i++)n+=String.fromCharCode(e[i]);return n}i[254]=i[254]=1,n.string2buf=function(e){var t,n,a,l,i,o=e.length,r=0;for(l=0;l<o;l++)55296==(64512&(n=e.charCodeAt(l)))&&l+1<o&&56320==(64512&(a=e.charCodeAt(l+1)))&&(n=65536+(n-55296<<10)+(a-56320),l++),r+=n<128?1:n<2048?2:n<65536?3:4;for(t=new s.Buf8(r),i=0,l=0;i<r;l++)55296==(64512&(n=e.charCodeAt(l)))&&l+1<o&&56320==(64512&(a=e.charCodeAt(l+1)))&&(n=65536+(n-55296<<10)+(a-56320),l++),n<128?t[i++]=n:n<2048?(t[i++]=192|n>>>6,t[i++]=128|63&n):n<65536?(t[i++]=224|n>>>12,t[i++]=128|n>>>6&63,t[i++]=128|63&n):(t[i++]=240|n>>>18,t[i++]=128|n>>>12&63,t[i++]=128|n>>>6&63,t[i++]=128|63&n);return t},n.buf2binstring=function(e){return r(e,e.length)},n.binstring2buf=function(e){for(var t=new s.Buf8(e.length),n=0,a=t.length;n<a;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,s,a,l,o=t||e.length,c=new Array(2*o);for(s=0,n=0;n<o;)if((a=e[n++])<128)c[s++]=a;else if((l=i[a])>4)c[s++]=65533,n+=l-1;else{for(a&=2===l?31:3===l?15:7;l>1&&n<o;)a=a<<6|63&e[n++],l--;l>1?c[s++]=65533:a<65536?c[s++]=a:(a-=65536,c[s++]=55296|a>>10&1023,c[s++]=56320|1023&a)}return r(c,s)},n.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+i[e[n]]>t?n:t}},{"./common":1}],3:[function(e,t,n){t.exports=function(e,t,n,s){for(var a=65535&e|0,l=e>>>16&65535|0,i=0;0!==n;){n-=i=n>2e3?2e3:n;do{l=l+(a=a+t[s++]|0)|0}while(--i);a%=65521,l%=65521}return a|l<<16|0}},{}],4:[function(e,t,n){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],5:[function(e,t,n){var s=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var s=0;s<8;s++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t,n,a){var l=s,i=a+n;e^=-1;for(var o=a;o<i;o++)e=e>>>8^l[255&(e^t[o])];return-1^e}},{}],6:[function(e,t,n){t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],7:[function(e,t,n){t.exports=function(e,t){var n,s,a,l,i,o,r,c,d,m,u,h,p,g,f,b,y,v,x,w,k,E,S,L,T;n=e.state,s=e.next_in,L=e.input,a=s+(e.avail_in-5),l=e.next_out,T=e.output,i=l-(t-e.avail_out),o=l+(e.avail_out-257),r=n.dmax,c=n.wsize,d=n.whave,m=n.wnext,u=n.window,h=n.hold,p=n.bits,g=n.lencode,f=n.distcode,b=(1<<n.lenbits)-1,y=(1<<n.distbits)-1;e:do{p<15&&(h+=L[s++]<<p,p+=8,h+=L[s++]<<p,p+=8),v=g[h&b];t:for(;;){if(h>>>=x=v>>>24,p-=x,0===(x=v>>>16&255))T[l++]=65535&v;else{if(!(16&x)){if(0==(64&x)){v=g[(65535&v)+(h&(1<<x)-1)];continue t}if(32&x){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}w=65535&v,(x&=15)&&(p<x&&(h+=L[s++]<<p,p+=8),w+=h&(1<<x)-1,h>>>=x,p-=x),p<15&&(h+=L[s++]<<p,p+=8,h+=L[s++]<<p,p+=8),v=f[h&y];n:for(;;){if(h>>>=x=v>>>24,p-=x,!(16&(x=v>>>16&255))){if(0==(64&x)){v=f[(65535&v)+(h&(1<<x)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(k=65535&v,p<(x&=15)&&(h+=L[s++]<<p,(p+=8)<x&&(h+=L[s++]<<p,p+=8)),(k+=h&(1<<x)-1)>r){e.msg="invalid distance too far back",n.mode=30;break e}if(h>>>=x,p-=x,k>(x=l-i)){if((x=k-x)>d&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(E=0,S=u,0===m){if(E+=c-x,x<w){w-=x;do{T[l++]=u[E++]}while(--x);E=l-k,S=T}}else if(m<x){if(E+=c+m-x,(x-=m)<w){w-=x;do{T[l++]=u[E++]}while(--x);if(E=0,m<w){w-=x=m;do{T[l++]=u[E++]}while(--x);E=l-k,S=T}}}else if(E+=m-x,x<w){w-=x;do{T[l++]=u[E++]}while(--x);E=l-k,S=T}for(;w>2;)T[l++]=S[E++],T[l++]=S[E++],T[l++]=S[E++],w-=3;w&&(T[l++]=S[E++],w>1&&(T[l++]=S[E++]))}else{E=l-k;do{T[l++]=T[E++],T[l++]=T[E++],T[l++]=T[E++],w-=3}while(w>2);w&&(T[l++]=T[E++],w>1&&(T[l++]=T[E++]))}break}}break}}while(s<a&&l<o);s-=w=p>>3,h&=(1<<(p-=w<<3))-1,e.next_in=s,e.next_out=l,e.avail_in=s<a?a-s+5:5-(s-a),e.avail_out=l<o?o-l+257:257-(l-o),n.hold=h,n.bits=p}},{}],8:[function(e,t,n){var s=e("../utils/common"),a=e("./adler32"),l=e("./crc32"),i=e("./inffast"),o=e("./inftrees"),r=-2,c=12,d=30;function m(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function u(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function h(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new s.Buf32(852),t.distcode=t.distdyn=new s.Buf32(592),t.sane=1,t.back=-1,0):r}function p(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,h(e)):r}function g(e,t){var n,s;return e&&e.state?(s=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?r:(null!==s.window&&s.wbits!==t&&(s.window=null),s.wrap=n,s.wbits=t,p(e))):r}function f(e,t){var n,s;return e?(s=new u,e.state=s,s.window=null,0!==(n=g(e,t))&&(e.state=null),n):r}var b,y,v=!0;function x(e){if(v){var t;for(b=new s.Buf32(512),y=new s.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(o(1,e.lens,0,288,b,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;o(2,e.lens,0,32,y,0,e.work,{bits:5}),v=!1}e.lencode=b,e.lenbits=9,e.distcode=y,e.distbits=5}function w(e,t,n,a){var l,i=e.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new s.Buf8(i.wsize)),a>=i.wsize?(s.arraySet(i.window,t,n-i.wsize,i.wsize,0),i.wnext=0,i.whave=i.wsize):((l=i.wsize-i.wnext)>a&&(l=a),s.arraySet(i.window,t,n-a,l,i.wnext),(a-=l)?(s.arraySet(i.window,t,n-a,a,0),i.wnext=a,i.whave=i.wsize):(i.wnext+=l,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=l))),0}n.inflateReset=p,n.inflateReset2=g,n.inflateResetKeep=h,n.inflateInit=function(e){return f(e,15)},n.inflateInit2=f,n.inflate=function(e,t){var n,u,h,p,g,f,b,y,v,k,E,S,L,T,Z,C,P,R,I,W,M,X,N,G,Y=0,V=new s.Buf8(4),F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return r;(n=e.state).mode===c&&(n.mode=13),g=e.next_out,h=e.output,b=e.avail_out,p=e.next_in,u=e.input,f=e.avail_in,y=n.hold,v=n.bits,k=f,E=b,X=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;v<16;){if(0===f)break e;f--,y+=u[p++]<<v,v+=8}if(2&n.wrap&&35615===y){n.check=0,V[0]=255&y,V[1]=y>>>8&255,n.check=l(n.check,V,2,0),y=0,v=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&y)<<8)+(y>>8))%31){e.msg="incorrect header check",n.mode=d;break}if(8!=(15&y)){e.msg="unknown compression method",n.mode=d;break}if(v-=4,M=8+(15&(y>>>=4)),0===n.wbits)n.wbits=M;else if(M>n.wbits){e.msg="invalid window size",n.mode=d;break}n.dmax=1<<M,e.adler=n.check=1,n.mode=512&y?10:c,y=0,v=0;break;case 2:for(;v<16;){if(0===f)break e;f--,y+=u[p++]<<v,v+=8}if(n.flags=y,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=d;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=d;break}n.head&&(n.head.text=y>>8&1),512&n.flags&&(V[0]=255&y,V[1]=y>>>8&255,n.check=l(n.check,V,2,0)),y=0,v=0,n.mode=3;case 3:for(;v<32;){if(0===f)break e;f--,y+=u[p++]<<v,v+=8}n.head&&(n.head.time=y),512&n.flags&&(V[0]=255&y,V[1]=y>>>8&255,V[2]=y>>>16&255,V[3]=y>>>24&255,n.check=l(n.check,V,4,0)),y=0,v=0,n.mode=4;case 4:for(;v<16;){if(0===f)break e;f--,y+=u[p++]<<v,v+=8}n.head&&(n.head.xflags=255&y,n.head.os=y>>8),512&n.flags&&(V[0]=255&y,V[1]=y>>>8&255,n.check=l(n.check,V,2,0)),y=0,v=0,n.mode=5;case 5:if(1024&n.flags){for(;v<16;){if(0===f)break e;f--,y+=u[p++]<<v,v+=8}n.length=y,n.head&&(n.head.extra_len=y),512&n.flags&&(V[0]=255&y,V[1]=y>>>8&255,n.check=l(n.check,V,2,0)),y=0,v=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((S=n.length)>f&&(S=f),S&&(n.head&&(M=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),s.arraySet(n.head.extra,u,p,S,M)),512&n.flags&&(n.check=l(n.check,u,S,p)),f-=S,p+=S,n.length-=S),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===f)break e;S=0;do{M=u[p+S++],n.head&&M&&n.length<65536&&(n.head.name+=String.fromCharCode(M))}while(M&&S<f);if(512&n.flags&&(n.check=l(n.check,u,S,p)),f-=S,p+=S,M)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===f)break e;S=0;do{M=u[p+S++],n.head&&M&&n.length<65536&&(n.head.comment+=String.fromCharCode(M))}while(M&&S<f);if(512&n.flags&&(n.check=l(n.check,u,S,p)),f-=S,p+=S,M)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;v<16;){if(0===f)break e;f--,y+=u[p++]<<v,v+=8}if(y!==(65535&n.check)){e.msg="header crc mismatch",n.mode=d;break}y=0,v=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=c;break;case 10:for(;v<32;){if(0===f)break e;f--,y+=u[p++]<<v,v+=8}e.adler=n.check=m(y),y=0,v=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=g,e.avail_out=b,e.next_in=p,e.avail_in=f,n.hold=y,n.bits=v,2;e.adler=n.check=1,n.mode=c;case c:if(5===t||6===t)break e;case 13:if(n.last){y>>>=7&v,v-=7&v,n.mode=27;break}for(;v<3;){if(0===f)break e;f--,y+=u[p++]<<v,v+=8}switch(n.last=1&y,v-=1,3&(y>>>=1)){case 0:n.mode=14;break;case 1:if(x(n),n.mode=20,6===t){y>>>=2,v-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=d}y>>>=2,v-=2;break;case 14:for(y>>>=7&v,v-=7&v;v<32;){if(0===f)break e;f--,y+=u[p++]<<v,v+=8}if((65535&y)!=(y>>>16^65535)){e.msg="invalid stored block lengths",n.mode=d;break}if(n.length=65535&y,y=0,v=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(S=n.length){if(S>f&&(S=f),S>b&&(S=b),0===S)break e;s.arraySet(h,u,p,S,g),f-=S,p+=S,b-=S,g+=S,n.length-=S;break}n.mode=c;break;case 17:for(;v<14;){if(0===f)break e;f--,y+=u[p++]<<v,v+=8}if(n.nlen=257+(31&y),y>>>=5,v-=5,n.ndist=1+(31&y),y>>>=5,v-=5,n.ncode=4+(15&y),y>>>=4,v-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=d;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;v<3;){if(0===f)break e;f--,y+=u[p++]<<v,v+=8}n.lens[F[n.have++]]=7&y,y>>>=3,v-=3}for(;n.have<19;)n.lens[F[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,N={bits:n.lenbits},X=o(0,n.lens,0,19,n.lencode,0,n.work,N),n.lenbits=N.bits,X){e.msg="invalid code lengths set",n.mode=d;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;C=(Y=n.lencode[y&(1<<n.lenbits)-1])>>>16&255,P=65535&Y,!((Z=Y>>>24)<=v);){if(0===f)break e;f--,y+=u[p++]<<v,v+=8}if(P<16)y>>>=Z,v-=Z,n.lens[n.have++]=P;else{if(16===P){for(G=Z+2;v<G;){if(0===f)break e;f--,y+=u[p++]<<v,v+=8}if(y>>>=Z,v-=Z,0===n.have){e.msg="invalid bit length repeat",n.mode=d;break}M=n.lens[n.have-1],S=3+(3&y),y>>>=2,v-=2}else if(17===P){for(G=Z+3;v<G;){if(0===f)break e;f--,y+=u[p++]<<v,v+=8}v-=Z,M=0,S=3+(7&(y>>>=Z)),y>>>=3,v-=3}else{for(G=Z+7;v<G;){if(0===f)break e;f--,y+=u[p++]<<v,v+=8}v-=Z,M=0,S=11+(127&(y>>>=Z)),y>>>=7,v-=7}if(n.have+S>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=d;break}for(;S--;)n.lens[n.have++]=M}}if(n.mode===d)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=d;break}if(n.lenbits=9,N={bits:n.lenbits},X=o(1,n.lens,0,n.nlen,n.lencode,0,n.work,N),n.lenbits=N.bits,X){e.msg="invalid literal/lengths set",n.mode=d;break}if(n.distbits=6,n.distcode=n.distdyn,N={bits:n.distbits},X=o(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,N),n.distbits=N.bits,X){e.msg="invalid distances set",n.mode=d;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(f>=6&&b>=258){e.next_out=g,e.avail_out=b,e.next_in=p,e.avail_in=f,n.hold=y,n.bits=v,i(e,E),g=e.next_out,h=e.output,b=e.avail_out,p=e.next_in,u=e.input,f=e.avail_in,y=n.hold,v=n.bits,n.mode===c&&(n.back=-1);break}for(n.back=0;C=(Y=n.lencode[y&(1<<n.lenbits)-1])>>>16&255,P=65535&Y,!((Z=Y>>>24)<=v);){if(0===f)break e;f--,y+=u[p++]<<v,v+=8}if(C&&0==(240&C)){for(R=Z,I=C,W=P;C=(Y=n.lencode[W+((y&(1<<R+I)-1)>>R)])>>>16&255,P=65535&Y,!(R+(Z=Y>>>24)<=v);){if(0===f)break e;f--,y+=u[p++]<<v,v+=8}y>>>=R,v-=R,n.back+=R}if(y>>>=Z,v-=Z,n.back+=Z,n.length=P,0===C){n.mode=26;break}if(32&C){n.back=-1,n.mode=c;break}if(64&C){e.msg="invalid literal/length code",n.mode=d;break}n.extra=15&C,n.mode=22;case 22:if(n.extra){for(G=n.extra;v<G;){if(0===f)break e;f--,y+=u[p++]<<v,v+=8}n.length+=y&(1<<n.extra)-1,y>>>=n.extra,v-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;C=(Y=n.distcode[y&(1<<n.distbits)-1])>>>16&255,P=65535&Y,!((Z=Y>>>24)<=v);){if(0===f)break e;f--,y+=u[p++]<<v,v+=8}if(0==(240&C)){for(R=Z,I=C,W=P;C=(Y=n.distcode[W+((y&(1<<R+I)-1)>>R)])>>>16&255,P=65535&Y,!(R+(Z=Y>>>24)<=v);){if(0===f)break e;f--,y+=u[p++]<<v,v+=8}y>>>=R,v-=R,n.back+=R}if(y>>>=Z,v-=Z,n.back+=Z,64&C){e.msg="invalid distance code",n.mode=d;break}n.offset=P,n.extra=15&C,n.mode=24;case 24:if(n.extra){for(G=n.extra;v<G;){if(0===f)break e;f--,y+=u[p++]<<v,v+=8}n.offset+=y&(1<<n.extra)-1,y>>>=n.extra,v-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=d;break}n.mode=25;case 25:if(0===b)break e;if(S=E-b,n.offset>S){if((S=n.offset-S)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=d;break}S>n.wnext?(S-=n.wnext,L=n.wsize-S):L=n.wnext-S,S>n.length&&(S=n.length),T=n.window}else T=h,L=g-n.offset,S=n.length;S>b&&(S=b),b-=S,n.length-=S;do{h[g++]=T[L++]}while(--S);0===n.length&&(n.mode=21);break;case 26:if(0===b)break e;h[g++]=n.length,b--,n.mode=21;break;case 27:if(n.wrap){for(;v<32;){if(0===f)break e;f--,y|=u[p++]<<v,v+=8}if(E-=b,e.total_out+=E,n.total+=E,E&&(e.adler=n.check=n.flags?l(n.check,h,E,g-E):a(n.check,h,E,g-E)),E=b,(n.flags?y:m(y))!==n.check){e.msg="incorrect data check",n.mode=d;break}y=0,v=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;v<32;){if(0===f)break e;f--,y+=u[p++]<<v,v+=8}if(y!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=d;break}y=0,v=0}n.mode=29;case 29:X=1;break e;case d:X=-3;break e;case 31:return-4;case 32:default:return r}return e.next_out=g,e.avail_out=b,e.next_in=p,e.avail_in=f,n.hold=y,n.bits=v,(n.wsize||E!==e.avail_out&&n.mode<d&&(n.mode<27||4!==t))&&w(e,e.output,e.next_out,E-e.avail_out),k-=e.avail_in,E-=e.avail_out,e.total_in+=k,e.total_out+=E,n.total+=E,n.wrap&&E&&(e.adler=n.check=n.flags?l(n.check,h,E,e.next_out-E):a(n.check,h,E,e.next_out-E)),e.data_type=n.bits+(n.last?64:0)+(n.mode===c?128:0)+(20===n.mode||15===n.mode?256:0),(0===k&&0===E||4===t)&&0===X&&(X=-5),X},n.inflateEnd=function(e){if(!e||!e.state)return r;var t=e.state;return t.window&&(t.window=null),e.state=null,0},n.inflateGetHeader=function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?r:(n.head=t,t.done=!1,0):r},n.inflateSetDictionary=function(e,t){var n,s=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?r:11===n.mode&&a(1,t,s,0)!==n.check?-3:w(e,t,s,s)?(n.mode=31,-4):(n.havedict=1,0):r},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":1,"./adler32":3,"./crc32":5,"./inffast":7,"./inftrees":9}],9:[function(e,t,n){var s=e("../utils/common"),a=15,l=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],i=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],r=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,c,d,m,u,h){var p,g,f,b,y,v,x,w,k,E=h.bits,S=0,L=0,T=0,Z=0,C=0,P=0,R=0,I=0,W=0,M=0,X=null,N=0,G=new s.Buf16(16),Y=new s.Buf16(16),V=null,F=0;for(S=0;S<=a;S++)G[S]=0;for(L=0;L<c;L++)G[t[n+L]]++;for(C=E,Z=a;Z>=1&&0===G[Z];Z--);if(C>Z&&(C=Z),0===Z)return d[m++]=20971520,d[m++]=20971520,h.bits=1,0;for(T=1;T<Z&&0===G[T];T++);for(C<T&&(C=T),I=1,S=1;S<=a;S++)if(I<<=1,(I-=G[S])<0)return-1;if(I>0&&(0===e||1!==Z))return-1;for(Y[1]=0,S=1;S<a;S++)Y[S+1]=Y[S]+G[S];for(L=0;L<c;L++)0!==t[n+L]&&(u[Y[t[n+L]]++]=L);if(0===e?(X=V=u,v=19):1===e?(X=l,N-=257,V=i,F-=257,v=256):(X=o,V=r,v=-1),M=0,L=0,S=T,y=m,P=C,R=0,f=-1,b=(W=1<<C)-1,1===e&&W>852||2===e&&W>592)return 1;for(;;){x=S-R,u[L]<v?(w=0,k=u[L]):u[L]>v?(w=V[F+u[L]],k=X[N+u[L]]):(w=96,k=0),p=1<<S-R,T=g=1<<P;do{d[y+(M>>R)+(g-=p)]=x<<24|w<<16|k|0}while(0!==g);for(p=1<<S-1;M&p;)p>>=1;if(0!==p?(M&=p-1,M+=p):M=0,L++,0==--G[S]){if(S===Z)break;S=t[n+u[L]]}if(S>C&&(M&b)!==f){for(0===R&&(R=C),y+=T,I=1<<(P=S-R);P+R<Z&&!((I-=G[P+R])<=0);)P++,I<<=1;if(W+=1<<P,1===e&&W>852||2===e&&W>592)return 1;d[f=M&b]=C<<24|P<<16|y-m|0}}return 0!==M&&(d[y+M]=S-R<<24|64<<16|0),h.bits=C,0}},{"../utils/common":1}],10:[function(e,t,n){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],11:[function(e,t,n){t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],"/lib/inflate.js":[function(e,t,n){var s=e("./zlib/inflate"),a=e("./utils/common"),l=e("./utils/strings"),i=e("./zlib/constants"),o=e("./zlib/messages"),r=e("./zlib/zstream"),c=e("./zlib/gzheader"),d=Object.prototype.toString;function m(e){if(!(this instanceof m))return new m(e);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new r,this.strm.avail_out=0;var n=s.inflateInit2(this.strm,t.windowBits);if(n!==i.Z_OK)throw new Error(o[n]);if(this.header=new c,s.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=l.string2buf(t.dictionary):"[object ArrayBuffer]"===d.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=s.inflateSetDictionary(this.strm,t.dictionary))!==i.Z_OK))throw new Error(o[n])}function u(e,t){var n=new m(t);if(n.push(e,!0),n.err)throw n.msg||o[n.err];return n.result}m.prototype.push=function(e,t){var n,o,r,c,m,u=this.strm,h=this.options.chunkSize,p=this.options.dictionary,g=!1;if(this.ended)return!1;o=t===~~t?t:!0===t?i.Z_FINISH:i.Z_NO_FLUSH,"string"==typeof e?u.input=l.binstring2buf(e):"[object ArrayBuffer]"===d.call(e)?u.input=new Uint8Array(e):u.input=e,u.next_in=0,u.avail_in=u.input.length;do{if(0===u.avail_out&&(u.output=new a.Buf8(h),u.next_out=0,u.avail_out=h),(n=s.inflate(u,i.Z_NO_FLUSH))===i.Z_NEED_DICT&&p&&(n=s.inflateSetDictionary(this.strm,p)),n===i.Z_BUF_ERROR&&!0===g&&(n=i.Z_OK,g=!1),n!==i.Z_STREAM_END&&n!==i.Z_OK)return this.onEnd(n),this.ended=!0,!1;u.next_out&&(0!==u.avail_out&&n!==i.Z_STREAM_END&&(0!==u.avail_in||o!==i.Z_FINISH&&o!==i.Z_SYNC_FLUSH)||("string"===this.options.to?(r=l.utf8border(u.output,u.next_out),c=u.next_out-r,m=l.buf2string(u.output,r),u.next_out=c,u.avail_out=h-c,c&&a.arraySet(u.output,u.output,r,c,0),this.onData(m)):this.onData(a.shrinkBuf(u.output,u.next_out)))),0===u.avail_in&&0===u.avail_out&&(g=!0)}while((u.avail_in>0||0===u.avail_out)&&n!==i.Z_STREAM_END);return n===i.Z_STREAM_END&&(o=i.Z_FINISH),o===i.Z_FINISH?(n=s.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===i.Z_OK):o!==i.Z_SYNC_FLUSH||(this.onEnd(i.Z_OK),u.avail_out=0,!0)},m.prototype.onData=function(e){this.chunks.push(e)},m.prototype.onEnd=function(e){e===i.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=m,n.inflate=u,n.inflateRaw=function(e,t){return(t=t||{}).raw=!0,u(e,t)},n.ungzip=u},{"./utils/common":1,"./utils/strings":2,"./zlib/constants":4,"./zlib/gzheader":6,"./zlib/inflate":8,"./zlib/messages":10,"./zlib/zstream":11}]},{},[])("/lib/inflate.js")}));const Sl={Uint8Array:Uint8Array,Int8Array:Int8Array,Uint16Array:Uint16Array,Int16Array:Int16Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Float32Array:Float32Array,Float64Array:Float64Array};const Ll=e=>[[0,0],[0,1],[1,0],[1,1]];class Tl extends pl{constructor(e,t){super(e,t)}containsPoint(e){return this.getDistanceAndPoint(e)[0]<=e.pointRadius?ml.BORDER:ml.NONE}draw(e,t){const n=this.getColor(t),s=this.isSelected(t);e.lineWidth=0;for(const a of this.label.points){e.fillStyle=n,e.beginPath();const[l,i]=ol(t,...a);e.arc(l,i,s?2*t.pointRadius:t.pointRadius,0,2*Math.PI),e.fill(),s&&(e.fillStyle="#ffffff",e.beginPath(),e.arc(l,i,t.pointRadius,0,2*Math.PI),e.fill())}}getMouseDistance(e){return this.getDistanceAndPoint(e)[0]}getPointInfo(e){return{color:this.getColor(e),field:this.field,label:this.label,point:this.getDistanceAndPoint(e)[1],type:"Keypoint"}}getPoints(){return Zl([this.label])}getDistanceAndPoint(e){const t=[];let{canvasBBox:[n,s,a,l],pointRadius:i,relativeCoordinates:[o,r]}=e;i=this.isSelected(e)?2*i:i;for(const[c,d]of this.label.points){const e=An(o*a,r*l,c*a,d*l);e<=1.15*i?t.push([0,[c,d]]):t.push([e,[c,d]])}return t.sort(((e,t)=>e[0]-t[0]))[0]}}const Zl=e=>{let t=[];return e.forEach((e=>{t=[...t,...e.points]})),t};class Cl extends pl{containsPoint(e){const t=1.15*e.strokeWidth/ts([e.windowBBox[2],e.windowBBox[3]],e.config.dimensions);return this.getMouseDistance(e)<=t?ml.BORDER:(this.label.closed||this.label.filled)&&this.label.points.some((t=>this.isPointInPath(e,t)))?ml.CONTENT:ml.NONE}draw(e,t){const n=this.getColor(t),s=this.isSelected(t);for(const a of this.label.points)a.length<2||(this.strokePath(e,t,a,n,this.label.filled),s&&this.strokePath(e,t,a,"#ffffff",!1,t.dashLength))}getMouseDistance(e){const t=[],[n,s]=e.config.dimensions,a=e.pixelCoordinates;for(const l of this.label.points){for(let e=0;e<l.length-1;e++)t.push(Qn(a,[n*l[e][0],s*l[e][1]],[n*l[e+1][0],s*l[e+1][1]]));this.label.closed&&t.push(Qn(a,[n*l[0][0],s*l[0][1]],[n*l[l.length-1][0],s*l[l.length-1][1]]))}return Math.min(...t)}getPointInfo(e){return{field:this.field,label:this.label,type:"Polyline",color:this.getColor(e)}}getPoints(){return Pl([this.label])}strokePath(e,t,n,s,a,l){e.beginPath(),e.lineWidth=t.strokeWidth,e.strokeStyle=s,e.setLineDash(l?[l]:[]),e.moveTo(...ol(t,n[0][0],n[0][1]));for(const[i,o]of n.slice(1))e.lineTo(...ol(t,i,o));if(a){e.fillStyle=s;const n=e.globalAlpha;e.globalAlpha=t.options.alpha,e.fill(),e.globalAlpha=n}this.label.closed&&e.closePath(),e.stroke()}isPointInPath(e,t){const[n,s]=e.config.dimensions,[a,l]=e.pixelCoordinates;let i=!1;this.label.closed&&(t=[...t,t[0]]);for(let o=0,r=t.length-1;o<t.length;r=o++){let e=t[o][0],c=t[o][1],d=t[r][0],m=t[r][1];[e,c]=[e*n,c*s],[d,m]=[d*n,m*s];c>l!=m>l&&a<(d-e)*(l-c)/(m-c)+e&&(i=!i)}return i}}const Pl=e=>{let t=[];return e.forEach((e=>{e.points.forEach((e=>{t=[...t,...e]}))})),t};const Rl=e=>[[0,0],[0,1],[1,0],[1,1]],Il=e=>(t,n)=>[new e(t,n)],Wl=(e,t)=>(n,s)=>s[t].map((t=>new e(n,t))),Ml={Detection:Il(xl),Detections:Wl(xl,"detections"),Heatmap:Il(class{constructor(e,t){if(this.field=e,this.label=t,this.label.map){this.targets=new Sl[this.label.map.data.arrayType](this.label.map.data.buffer),this.range=this.label.range?t.range:(n=this.targets)instanceof Float32Array||n instanceof Float64Array?[0,1]:[0,255];const[e,s]=this.label.map.data.shape;this.canvas=document.createElement("canvas"),this.canvas.width=s,this.canvas.height=e,this.imageData=new ImageData(new Uint8ClampedArray(this.label.map.image),s,e);const a=this.canvas.getContext("2d");a.imageSmoothingEnabled=!1,a.clearRect(0,0,this.label.map.data.shape[1],this.label.map.data.shape[0]),a.putImageData(this.imageData,0,0)}var n}containsPoint(e){const{pixelCoordinates:[t,n],config:{dimensions:[s,a]}}=e;return t>=0&&t<=s&&n>=0&&n<=a&&this.getTarget(e)?ml.CONTENT:ml.NONE}draw(e,t){const n=this.canvas.getContext("2d");n.imageSmoothingEnabled=!1,n.clearRect(0,0,this.label.map.data.shape[1],this.label.map.data.shape[0]),n.putImageData(this.imageData,0,0);const[s,a]=ol(t,0,0),[l,i]=ol(t,1,1),o=e.globalAlpha;e.globalAlpha=t.options.alpha,e.drawImage(this.canvas,s,a,l-s,i-a),e.globalAlpha=o,this.isSelected(t)&&dl(e,t,Fa(t.options.coloring.pool,t.options.coloring.seed,this.field))}getMouseDistance(e){return this.containsPoint(e)?0:1/0}getPointInfo(e){const t=this.getTarget(e);return{color:Na(Xa(this.getColor(e,t))),label:r(o({},this.label),{map:{shape:this.label.map?this.label.map.data.shape:null}}),field:this.field,target:t,type:"Heatmap"}}getSelectData(){return{id:this.label.id,field:this.field}}isSelected(e){return e.options.selectedLabels.includes(this.label.id)}isShown(e){return e.options.activePaths.includes(this.field)}getPoints(){return Ll()}getSizeBytes(){return rl(this.label)}getIndex(e){const[t,n]=this.getMapCoordinates(e);return t<0||n<0?-1:this.label.map.data.shape[1]*n+t}getMapCoordinates({pixelCoordinates:[e,t],config:{dimensions:[n,s]}}){const[a,l]=this.label.map.data.shape;return[Math.floor(e*(l/n)),Math.floor(t*(a/s))]}getColor(e,t){const[n,s]=this.range;if(0===t)return 0;if(e.options.coloring.byLabel){const a=Math.round(Math.max(t-n,0)/(s-n)*(e.options.coloring.scale.length-1));return Ma(e.options.coloring.scale[a])}const a=Fa(e.options.coloring.pool,e.options.coloring.seed,this.field),l=Math.max(Math.abs(n),Math.abs(s));return t=Math.min(l,Math.abs(t))/l,Ma(a,t/l)}getTarget(e){const t=this.getIndex(e);return t<0?null:this.targets[t]}}),Keypoint:Il(Tl),Keypoints:Wl(Tl,"keypoints"),Polyline:Il(Cl),Polylines:Wl(Cl,"polylines"),Segmentation:Il(class{constructor(e,t){if(this.field=e,this.label=t,this.label.mask){this.targets=new Sl[this.label.mask.data.arrayType](this.label.mask.data.buffer);const[e,t]=this.label.mask.data.shape;this.canvas=document.createElement("canvas"),this.canvas.width=t,this.canvas.height=e,this.imageData=new ImageData(new Uint8ClampedArray(this.label.mask.image),t,e);const n=this.canvas.getContext("2d");n.imageSmoothingEnabled=!1,n.clearRect(0,0,this.label.mask.data.shape[1],this.label.mask.data.shape[0]),n.putImageData(this.imageData,0,0)}}containsPoint(e){const{pixelCoordinates:[t,n],config:{dimensions:[s,a]}}=e;return t>=0&&t<=s&&n>=0&&n<=a&&this.getTarget(e)?ml.CONTENT:ml.NONE}draw(e,t){if(!this.targets)return;const[n,s]=ol(t,0,0),[a,l]=ol(t,1,1),i=e.globalAlpha;e.globalAlpha=t.options.alpha,e.drawImage(this.canvas,n,s,a-n,l-s),e.globalAlpha=i,this.isSelected(t)&&dl(e,t,Fa(t.options.coloring.pool,t.options.coloring.seed,this.field))}getMouseDistance(e){return this.containsPoint(e)?0:1/0}getPointInfo(e){const t=this.getTarget(e),n=e.options.coloring;let s=n.maskTargets[this.field];s&&s[this.field],s||(s=n.defaultMaskTargets);return{color:s&&1===Object.keys(s).length?Fa(e.options.coloring.pool,e.options.coloring.seed,this.field):n.targets[Math.round(Math.abs(t))%n.targets.length],label:r(o({},this.label),{mask:{shape:this.label.mask.data.shape?this.label.mask.data.shape:null}}),field:this.field,target:t,type:"Segmentation"}}getSelectData(){return{id:this.label.id,field:this.field}}isSelected(e){return e.options.selectedLabels.includes(this.label.id)}isShown(e){return e.options.activePaths.includes(this.field)}getPoints(){return Rl()}getSizeBytes(){return rl(this.label)}getIndex(e){const[t,n]=this.getMaskCoordinates(e);return t<0||n<0?-1:this.label.mask.data.shape[1]*n+t}getMaskCoordinates({pixelCoordinates:[e,t],config:{dimensions:[n,s]}}){const[a,l]=this.label.mask.data.shape;return[Math.floor(e*(l/n)),Math.floor(t*(a/s))]}getTarget(e){const t=this.getIndex(e);return t<0?null:this.targets[t]}})},Xl={Detection:e=>wl([e]),Detections:e=>wl(e.detections),Heatmap:e=>Ll(),Keypoint:e=>Zl([e]),Keypoints:e=>Zl(e.keypoints),Polyline:e=>Pl([e]),Poylines:e=>Pl(e.polylines),Segmentation:e=>Rl()},Nl=(e,t=!1)=>{const n=[];let s=[];for(const a in e){const t=e[a];if(t)if(t._cls in Ml){const e=Ml[t._cls](a,t,void 0);s=[...s,...e]}else On.includes(t._cls)&&n.push([a,t._cls in zn?t[zn[t._cls]]:[t]])}if(n.length>0){const e=t?new fl(n):new gl(n);s.push(e)}return s},Gl={activePaths:[],selectedLabels:[],showConfidence:!1,showIndex:!1,showJSON:!1,showLabel:!1,showTooltip:!1,onlyShowHoveredLabel:!1,filter:null,coloring:{byLabel:!1,pool:["#000000"],scale:null,seed:0,maskTargets:{},defaultMaskTargets:null,targets:["#000000"]},smoothMasks:!0,hasNext:!1,hasPrevious:!1,fullscreen:!1,zoomPad:.1,selected:!1,fieldsMap:{},inSelectionMode:!1,timeZone:"UTC",mimetype:"",alpha:.7},Yl=r(o({},Gl),{useFrameNumber:!0,zoom:!1}),Vl=r(o({},Gl),{zoom:!1}),Fl=r(o({},Gl),{autoplay:!1,loop:!1,playbackRate:1,useFrameNumber:!1,volume:0,frameFieldsMap:{}}),Kl=(e,t)=>{const n=t.map((t=>t.getPoints(e))).flat();let[s,a]=e.config.dimensions,[l,i]=[s,a];const o=l/i,{center:[r,c],box:[d,m,u,h]}=(([e,t],[n,s,a,l])=>{const i=a/l;let[o,r,c,d]=[n,s,a,l];return c*e<16&&(c=16/e,d=c/i,o=n+a/2-c/2,r=s+l/2-d/2),d*t<16&&(d=16/t,c=d*i,o=n+a/2-c/2,r=s+l/2-d/2),{center:[n+a/2,s+l/2],box:[o,r,c,d]}})([l,i],$n(n)),[p,g,f,b]=e.windowBBox;let y=f/b,v=1,x=[0,0];const w=1-e.options.zoomPad;y<o?(v=Math.max(1,1/u),l=f*v,i=l/o,!e.config.thumbnail&&h*i>b&&(v=Math.max(1,b*v/(h*i)),l=f*v,i=l/o)):(v=Math.max(1,1/h),i=b*v,l=i*o,!e.config.thumbnail&&u*l>f&&(v=Math.max(1,f*v/(u*l)),i=b*v,l=i*o));return x=[-l*r-(v*f-l)/2+f/2,-i*c-(v*b-i)/2+b/2],(l*w>f&&i*w>b||!e.config.thumbnail)&&(v*=w,x[0]=x[0]*w+u*l*(1-w)/2,x[1]=x[1]*w+h*i*(1-w)/2),x=ns(v,x,[f,b],[s,a],!e.config.thumbnail),as(e,{scale:v,pan:x})},Ol={requestColor:[(e,{key:t,pool:n,seed:s})=>{e.postMessage({method:"resolveColor",key:t,seed:s,color:Fa(n,s,t)})}]},zl=(()=>{const e=[];for(let n=0;n<1;n++)e.push(ls(Ol));let t=-1;return()=>(t++,t%=1,e[t])})();class Dl{constructor(e,t,n={}){this.eventTarget=new EventTarget,this.updater=this.makeUpdate(),this.state=this.getInitialState(t,n),this.loadSample(e),this.state.options.mimetype=(e=>e.metadata&&e.metadata.mime_type||v.getType(e.filepath)||"image/jpg")(e),this.state.config.thumbnail||(this.state.showControls=!0),this.pluckedOverlays=[],this.currentOverlays=[],this.lookerElement=this.getElements(t),this.canvas=this.lookerElement.children[1].element,this.ctx=this.canvas.getContext("2d"),this.resizeObserver=new ResizeObserver((()=>{const e=es(this.lookerElement.element);e[2]&&e[3]&&this.lookerElement&&this.updater({windowBBox:e})}))}loadOverlays(e){this.sampleOverlays=Nl(e)}pluckOverlays(e){return this.sampleOverlays}dispatchEvent(e,t){"error"===e&&this.updater({error:t.error||!0}),this.eventTarget.dispatchEvent(new CustomEvent(e,{detail:t}))}dispatchImpliedEvents(e,t){}getDispatchEvent(){return(e,t)=>{"copy"!==e?"selectthumbnail"!==e?this.dispatchEvent(e,t):this.dispatchEvent(e,this.sample.id):this.getSample().then((e=>S(JSON.stringify(e,null,4))))}}makeUpdate(){return(e,t)=>{const n=e instanceof Function?e(this.state):e;if(!this.lookerElement||0===Object.keys(n).length&&!t)return;if(this.previousState=this.state,this.state=as(this.state,n),!this.state.windowBBox||this.state.destroyed||!this.state.overlaysPrepared)return;if(this.pluckedOverlays=this.pluckOverlays(this.state),this.state=this.postProcess(),[this.currentOverlays,this.state.rotate]=vl(this.state,this.pluckedOverlays),this.state.mouseIsOnOverlay=Boolean(this.currentOverlays.length)&&this.currentOverlays[0].containsPoint(this.state)>ml.NONE,t&&t(this.state,this.currentOverlays),this.dispatchImpliedEvents(this.previousState,this.state),this.state.options.showJSON){const e=this.lookerElement.element.querySelectorAll("pre")[0];this.getSample().then((t=>{e.innerHTML=L(t,Un)}))}const s=this.ctx;if(this.lookerElement.render(this.state,this.sample),!this.state.loaded||this.state.destroyed||this.waiting)return;s.lineWidth=this.state.strokeWidth,s.font=`bold ${this.state.fontSize.toFixed(2)}px Palanquin`,s.textAlign="left",s.textBaseline="bottom",s.imageSmoothingEnabled=!1,s.setTransform(1,0,0,1,0,0);const a=rs();s.clearRect(0,0,this.state.windowBBox[2]*a,this.state.windowBBox[3]*a),s.translate(this.state.pan[0]*a,this.state.pan[1]*a);const l=this.state.scale*a;s.scale(l,l);const[i,o,r,c]=this.state.canvasBBox;s.drawImage(this.getImageSource(),0,0,this.state.config.dimensions[0],this.state.config.dimensions[1],i,o,r,c),s.globalAlpha=Math.min(1,this.state.options.alpha/.7);for(let d=this.currentOverlays.length-1;d>=0;d--)this.currentOverlays[d].draw(s,this.state);s.globalAlpha=1}}addEventListener(e,t,...n){this.eventTarget.addEventListener(e,t,...n)}removeEventListener(e,t,...n){this.eventTarget.removeEventListener(e,t,...n)}attach(e,t){"string"==typeof e&&(e=document.getElementById(e)),e!==this.lookerElement.element.parentElement?(this.lookerElement.element.parentElement&&(this.resizeObserver.disconnect(),this.lookerElement.element.parentElement.removeChild(this.lookerElement.element)),this.updater({windowBBox:t?[0,0,...t]:es(e)}),e.appendChild(this.lookerElement.element),!t&&this.resizeObserver.observe(e)):this.state.disabled&&this.updater({disabled:!1})}resize(e){this.updater({windowBBox:[0,0,...e]})}detach(){this.resizeObserver.disconnect(),this.lookerElement.element.parentNode&&this.lookerElement.element.parentNode.removeChild(this.lookerElement.element)}updateSample(e){this.loadSample(e)}getSample(){let e=o({},this.sample);return Promise.resolve(Ql(this.state,e,this.state.options.fieldsMap))}getCurrentSampleLabels(){const e=[];return this.currentOverlays.forEach((t=>{if(t instanceof gl)t.getFilteredAndFlat(this.state).forEach((([t,n])=>{e.push({field:t,label_id:n.id,sample_id:this.sample.id})}));else{const{id:n,field:s}=t.getSelectData(this.state);e.push({label_id:n,field:s,sample_id:this.sample.id})}})),e}get waiting(){return!1}destroy(){this.resizeObserver.disconnect(),this.lookerElement.element.parentElement&&this.lookerElement.element.parentElement.removeChild(this.lookerElement.element),this.updater({destroyed:!0})}disable(){this.updater({disabled:!0})}getImageSource(){return this.lookerElement.children[0].imageSource}getInitialBaseState(){return{disabled:!1,cursorCoordinates:[0,0],pixelCoordinates:[0,0],relativeCoordinates:[0,0],disableControls:!1,hovering:!1,hoveringControls:!1,showControls:!1,showHelp:!1,showOptions:!1,loaded:!1,scale:1,pan:[0,0],rotate:0,panning:!1,strokeWidth:3,dashLength:8,fontSize:16,wheeling:!1,transformedWindowBBox:null,windowBBox:null,transformedMediaBBox:null,mediaBBox:null,canvasBBox:null,textPad:4,pointRadius:4,mouseIsOnOverlay:!1,overlaysPrepared:!1,disableOverlays:!1,zoomToContent:!1,setZoom:!0,hasDefaultZoom:!0,SHORTCUTS:Ds,error:null,destroyed:!1,reloading:!1}}postProcess(){let[e,t,n,s]=this.state.windowBBox;return this.state.pan=ns(this.state.scale,this.state.pan,[n,s],this.state.config.dimensions),this.state.mediaBBox=qn(this.state.config.dimensions,this.state.windowBBox),this.state.transformedWindowBBox=[e+this.state.pan[0],t+this.state.pan[1],this.state.scale*n,this.state.scale*s],this.state.transformedMediaBBox=qn(this.state.config.dimensions,this.state.transformedWindowBBox),this.state.canvasBBox=[this.state.mediaBBox[0]-this.state.windowBBox[0],this.state.mediaBBox[1]-this.state.windowBBox[1],this.state.mediaBBox[2],this.state.mediaBBox[3]],this.state.relativeCoordinates=[(this.state.cursorCoordinates[0]-this.state.transformedMediaBBox[0])/this.state.transformedMediaBBox[2],(this.state.cursorCoordinates[1]-this.state.transformedMediaBBox[1])/this.state.transformedMediaBBox[3]],this.state.pixelCoordinates=[this.state.relativeCoordinates[0]*this.state.config.dimensions[0],this.state.relativeCoordinates[1]*this.state.config.dimensions[1]],this.state.fontSize=16/this.state.scale,this.state.pointRadius=4/this.state.scale,this.state.strokeWidth=3/this.state.scale,this.state.dashLength=8/this.state.scale,this.state.config.thumbnail&&(this.state.strokeWidth/=3),this.state.textPad=4/this.state.scale,this.state.hasDefaultZoom=this.hasDefaultZoom(this.state,this.pluckedOverlays),this.state}hasResized(){var e,t;return Boolean(!(null==(e=this.previousState)?void 0:e.windowBBox)||!(null==(t=this.state)?void 0:t.windowBBox)||this.previousState.windowBBox.some(((e,t)=>e!==this.state.windowBBox[t])))}loadSample(e){const t=x(),n=zl(),s=({data:{sample:e,uuid:a}})=>{a===t&&(this.sample=e,this.loadOverlays(e),this.updater({overlaysPrepared:!0,disabled:!1,reloading:!1}),n.removeEventListener("message",s))};n.addEventListener("message",s),n.postMessage({method:"processSample",coloring:this.state.options.coloring,sample:e,uuid:t})}}class Hl extends Dl{getElements(e){return((e,t,n)=>xs(e,{node:ka,children:[{node:Ja},{node:ys},{node:ba},{node:Ka},{node:ja},{node:xa},{node:ea},{node:ca,children:[{node:Ba},{node:ma},{node:ua},{node:ga},{node:da},{node:fa},{node:pa},{node:ha}]},{node:ra},{node:oa},{node:Ea,children:[{node:La},{node:Ta},{node:Za},{node:Ca},{node:Pa}]}]},t,n))(e,this.updater,this.getDispatchEvent())}getInitialState(e,t){return t=o(o({},this.getDefaultOptions()),t),r(o({duration:null},this.getInitialBaseState()),{config:o({},e),options:t,SHORTCUTS:Ds})}getDefaultOptions(){return Yl}hasDefaultZoom(e,t){let n=[0,0],s=1;if(e.options.zoom){const a=Kl(e,t);n=a.pan,s=a.scale}return s===e.scale&&n[0]===e.pan[0]&&n[1]===e.pan[1]}postProcess(){return this.state.setZoom||(this.state.setZoom=this.hasResized()),this.state.zoomToContent?_l(this.state,this.currentOverlays):this.state.setZoom&&this.state.overlaysPrepared&&(this.state.options.zoom?this.state=Kl(this.state,this.pluckedOverlays):(this.state.pan=[0,0],this.state.scale=1),this.state.setZoom=!1),super.postProcess()}updateOptions(e){const t=$l(this.state.options,e),n={options:e};void 0!==e.zoom&&(n.setZoom=this.state.options.zoom!==e.zoom),t?(this.updater(r(o({},n),{reloading:this.state.disabled})),this.updateSample(this.sample)):this.updater(r(o({},n),{disabled:!1}))}}class Ul extends Dl{getElements(e){return((e,t,n)=>xs(e,{node:ka,children:[{node:Aa},{node:ys},{node:ba},{node:Ka},{node:ja},{node:xa},{node:ea},{node:ca,children:[{node:Ba},{node:ma},{node:ua},{node:ga},{node:da},{node:fa},{node:pa},{node:ha}]},{node:ra},{node:oa},{node:Ea,children:[{node:La},{node:Ta},{node:Za},{node:Ca},{node:Pa}]}]},t,n))(e,this.updater,this.getDispatchEvent())}getInitialState(e,t){return t=o(o({},this.getDefaultOptions()),t),r(o({},this.getInitialBaseState()),{config:o({},e),options:t,SHORTCUTS:Ds})}getDefaultOptions(){return Vl}hasDefaultZoom(e,t){let n=[0,0],s=1;if(e.options.zoom){const a=Kl(e,t);n=a.pan,s=a.scale}return s===e.scale&&n[0]===e.pan[0]&&n[1]===e.pan[1]}postProcess(){return this.state.setZoom||(this.state.setZoom=this.hasResized()),this.state.zoomToContent?_l(this.state,this.currentOverlays):this.state.setZoom&&this.state.overlaysPrepared&&(this.state.options.zoom?this.state=Kl(this.state,this.pluckedOverlays):(this.state.pan=[0,0],this.state.scale=1),this.state.setZoom=!1),super.postProcess()}updateOptions(e){const t=$l(this.state.options,e),n={options:e};void 0!==e.zoom&&(n.setZoom=this.state.options.zoom!==e.zoom||this.state.config.thumbnail),t?(this.updater(r(o({},n),{reloading:this.state.disabled})),this.updateSample(this.sample)):this.updater(r(o({},n),{disabled:!1}))}}const{aquireReader:jl,addFrame:Bl}=(()=>{let e,t=new E({max:1e9,length:e=>{let t=1;return e.overlays.forEach((e=>{t+=e.getSizeBytes()})),t},dispose:(e,t)=>{const n=e.deref();n&&n(t.sample.frame_number)}}),n=0,s=null,a=!1,l=null;const i=({addFrame:l,addFrameBuffers:i,removeFrame:o,frameNumber:r,frameCount:c,sampleId:d,update:m,dispatchEvent:u,coloring:h})=>{n=0,s=[r,Math.min(c,20+r)];const p=x();return e&&e.terminate(),e=ls(Ol),e.onmessage=({data:r})=>{if(r.error&&u("error",{error:"Frames"}),r.uuid!==p||"frameChunk"!==r.method)return;const{frames:d,range:[h,g]}=r;i([h,g]);for(let e=h;e<=g;e++){const n={sample:{frame_number:e},overlays:[]};t.set(new WeakRef(o),n),l(e,n)}for(let e=0;e<d.length;e++){const s=d[e],a=Object.fromEntries(Object.entries(s).map((([e,t])=>["frames."+e,t]))),i=Nl(a);i.forEach((e=>{n+=e.getSizeBytes()}));const r={sample:s,overlays:i};t.set(new WeakRef(o),r),l(s.frame_number,r)}n<1e9&&g<c?(s=[g+1,Math.min(c,g+1+20)],a=!0,e.postMessage({method:"requestFrameChunk",uuid:p})):(a=!1,s=null),m((e=>(e.buffering&&u("buffering",!1),{buffering:!1})))},a=!0,e.postMessage({method:"setStream",sampleId:d,frameCount:c,frameNumber:r,uuid:p,url:cs()?`http://${hs}:${us}${ms}`:window.location.protocol+"//"+ds+ms,coloring:h}),p};return{aquireReader:n=>{l=n;let c=i(l);return(n,d)=>{d||!s||n<s[0]&&n>s[1]?(d&&t.reset(),s=[n,n+20],c=i(r(o({},l),{frameNumber:n}))):a||e.postMessage({method:"requestFrameChunk",uuid:c}),a=!0}},addFrame:(e,n)=>{t.set(new WeakRef(e),n)}}})();let Jl=null;class Al extends Dl{constructor(){super(...arguments),this.frames=new Map}get frameNumber(){return this.state.frameNumber}get playing(){return this.state.playing}get waiting(){const e=this.lookerElement.children[0].element;return e&&(e.seeking||e.readyState<2||!this.hasFrame(this.state.frameNumber))}destroy(){this.pause(),super.destroy()}dispatchImpliedEvents(e,t){const n=e.playing&&!e.buffering,s=t.playing&&!t.buffering;n!==s&&(s&&this.dispatchEvent("play",null),!s&&this.dispatchEvent("pause",{buffering:t.buffering}))}getCurrentSampleLabels(){const e=[];return vl(this.state,this.sampleOverlays)[0].forEach((t=>{if(t instanceof gl)t.getFilteredAndFlat(this.state).forEach((([t,n])=>{e.push({field:t,label_id:n.id,sample_id:this.sample.id})}));else{const{id:n,field:s}=t.getSelectData(this.state);e.push({label_id:n,field:s,sample_id:this.sample.id})}})),e}getCurrentFrameLabels(){const e=this.frames.get(this.frameNumber).deref(),t=[];return e&&vl(this.state,e.overlays)[0].forEach((e=>{if(e instanceof gl)e.getFilteredAndFlat(this.state).forEach((([e,n])=>{t.push({field:e,label_id:n.id,frame_number:this.frameNumber,sample_id:this.sample.id})}));else{const{id:n,field:s}=e.getSelectData(this.state);t.push({label_id:n,field:s,sample_id:this.sample.id,frame_number:this.frameNumber})}})),t}getElements(e){return il(e,this.updater,this.getDispatchEvent())}getInitialState(e,t){const n=e.support?e.support[0]:1;return r(o({duration:null,seeking:!1,fragment:null,playing:!1,frameNumber:n,buffering:!1},this.getInitialBaseState()),{config:o({},e),options:o(o({},this.getDefaultOptions()),t),buffers:[[n,n]],seekBarHovering:!1,SHORTCUTS:qs,hasPoster:!1,waitingForVideo:!1,lockedToSupport:Boolean(e.support)})}hasDefaultZoom(e,t){let n=[0,0];return 1===e.scale&&n[0]===e.pan[0]&&n[1]===e.pan[1]}loadOverlays(e){this.sampleOverlays=Nl(Object.fromEntries(Object.entries(e).filter((([e])=>"frames"!==e))),!0);const t=e.frames.length?e.frames:[{frame_number:1}],n=t.map((e=>Nl(Object.fromEntries(Object.entries(e).map((([e,t])=>["frames."+e,t]))))));t.map(((e,t)=>({sample:e,overlays:n[t]}))).forEach((e=>{const t=e.sample.frame_number;Bl((e=>is(e,this.state.buffers)),e),this.frames.set(e.sample.frame_number,new WeakRef(e)),os([t,t],this.state.buffers)}))}pluckOverlays(e){var t;const n=e.frameNumber;let s=!1;if(e.config.support&&!e.lockedToSupport){const[t,a]=e.config.support;s=n<t||n>a}let a=s?[]:this.sampleOverlays;if(this.hasFrame(e.frameNumber)){const n=null==(t=this.frames.get(e.frameNumber))?void 0:t.deref();void 0!==n&&(a=[...a,...n.overlays])}let l=null;return null!==this.state.duration&&(l=ks(this.state.duration,this.state.duration,this.state.config.frameRate)),e.config.thumbnail&&!e.playing||Jl===this||null===l?Jl!==this&&l&&(this.state.buffering&&this.dispatchEvent("buffering",!1),this.state.playing=!1,this.state.buffering=!1):(Jl&&Jl.pause(),this.setReader(),Jl=this,this.state.buffers=[[1,1]]),Jl===this&&(this.hasFrame(Math.min(l,e.frameNumber+1))?(this.state.buffering&&this.dispatchEvent("buffering",!1),this.state.buffering=!1):(this.state.buffering=!0,this.dispatchEvent("buffering",!0),this.requestFrames(e.frameNumber))),a}setReader(){this.requestFrames=jl({addFrame:(e,t)=>this.frames.set(e,new WeakRef(t)),addFrameBuffers:e=>this.state.buffers=os(e,this.state.buffers),removeFrame:e=>is(e,this.state.buffers),getCurrentFrame:()=>this.frameNumber,sampleId:this.state.config.sampleId,frameCount:ks(this.state.duration,this.state.duration,this.state.config.frameRate),frameNumber:this.state.frameNumber,update:this.updater,dispatchEvent:(e,t)=>this.dispatchEvent(e,t),coloring:this.state.options.coloring})}getSample(){return new Promise((e=>{const t=n=>{this.hasFrame(this.state.frameNumber)?e(r(o({},n),{frames:[o({frame_number:this.frameNumber},Ql(this.state,o({},this.frames.get(this.frameNumber).deref().sample),this.state.options.frameFieldsMap,"frames."))]})):setTimeout(t,200)};super.getSample().then(t)}))}getDefaultOptions(){return Fl}play(){this.updater((({playing:e})=>e?{}:{playing:!0}))}pause(){this.updater((({playing:e})=>e?{playing:!1}:{}))}postProcess(){return this.state.seeking?this.state.disableOverlays=!0:this.state.playing||this.state.buffering||(this.state.disableOverlays=!1),this.state.setZoom||(this.state.setZoom=this.hasResized()),this.state.setZoom||(this.state.setZoom=this.hasResized()),this.state.zoomToContent?_l(this.state,this.currentOverlays):this.state.setZoom&&(this.state.pan=[0,0],this.state.scale=1,this.state.setZoom=!1),super.postProcess()}updateOptions(e){$l(this.state.options,e)?(this.updater({options:e,reloading:this.state.disabled}),this.updateSample(this.sample)):this.updater({options:e,disabled:!1})}updateSample(e){this.state.buffers=[[1,1]],this.frames.clear(),super.updateSample(e),this.setReader()}hasFrame(e){var t;return this.frames.has(e)&&void 0!==(null==(t=this.frames.get(e))?void 0:t.deref())}}const _l=(e,t)=>{if(e.options.selectedLabels){const n=new Set(e.options.selectedLabels),s=t.filter((t=>!(t instanceof gl)&&n.has(t.getSelectData(e).id)));s.length&&(t=s)}const{pan:n,scale:s}=Kl(e,t);e.pan[0]===n[0]&&e.pan[1]===n[1]&&e.scale===s?(e.pan=[0,0],e.scale=1):(e.pan=n,e.scale=s),e.zoomToContent=!1},Ql=(e,t,n,s="")=>{for(let a in t)if(n.hasOwnProperty(a))t[n[a]]=t[a],a!==n[a]&&delete t[a];else if(a.startsWith("_"))delete t[a];else if(t[a]&&"DateTime"===t[a]._cls)t[a]=new Date(t[a].datetime);else if(Array.isArray(t[a]))t[a]=t[a].map((e=>e&&"DateTime"===e._cls?new Date(t[a].datetime):e));else if(t[a]&&t[a]._cls&&Ml.hasOwnProperty(t[a]._cls)){if(!e.options.activePaths.includes(s+a)){delete t[a];continue}zn[t[a]._cls]?t[a]=r(o({},t[a]),{[zn[t[a]._cls]]:t[a][zn[t[a]._cls]].filter((t=>e.options.filter[s+a](t))).map((e=>(Dn.has(e._cls)&&e.mask&&(e.mask={shape:e.mask.shape}),e)))}):e.options.filter[s+a](t[a])?Dn.has(t[a]._cls)&&t[a].mask&&t[a].mask.data?t[a]=r(o({},t[a]),{mask:{shape:t[a].mask.data.shape}}):"Heatmap"===t[a]._cls&&t[a].map&&t[a].map.data&&(t[a]=r(o({},t[a]),{map:{shape:t[a].map.data.shape}})):delete t[a]}return t},$l=(e,t)=>{let n=!1;return(t.coloring&&e.coloring.seed!==t.coloring.seed||t.coloring&&t.coloring.byLabel!==e.coloring.byLabel)&&(n=!0),n},ql=T({key:"isModalActive",get:({get:e})=>Boolean(e(ut))}),ei=T({key:"refresh",get:({get:e})=>e(St).refresh});T({key:"deactivated",get:({get:e})=>{var t;const n=wn,s=null==(t=e(St))?void 0:t.active_handle;return!!bn&&(n!==s&&"string"==typeof s)}});const ti=T({key:"fiftyone",get:async()=>{let e=null;do{try{e=await(await fetch(`${Zn}/fiftyone`)).json()}catch{}if(e)break;await new Promise((e=>setTimeout(e,2e3)))}while(null===e);return e}}),ni=T({key:"showTeamsButton",get:({get:e})=>{const t=e(ti).teams,n=e(yt),s=window.localStorage.getItem("fiftyone-teams");return s&&(window.localStorage.removeItem("fiftyone-teams"),fetch(`${Zn}/teams?submitted=true`,{method:"post"})),t.submitted||n.submitted||"submitted"===s?"hidden":t.minimized||n.minimized?"minimized":"shown"}}),si=T({key:"datasetName",get:({get:e})=>{const t=e(St);return t.dataset?t.dataset.name:null}}),ai=T({key:"viewCls",get:({get:e})=>e(St).view_cls}),li=T({key:"isRootView",get:({get:e})=>[void 0,null,"fiftyone.core.view.DatasetView"].includes(e(ai))}),ii=["fiftyone.core.patches.PatchesView","fiftyone.core.patches.EvaluationPatchesView"];var oi,ri,ci,di;(ri=oi||(oi={})).CLIP="clip",ri.FRAME="frame",ri.PATCH="patch",ri.SAMPLE="sample",(di=ci||(ci={})).CLIP="clips",di.FRAME="frames",di.PATCH="patches",di.SAMPLE="samples";const mi=T({key:"rootElementName",get:({get:e})=>{const t=e(ai);return ii.includes(t)?oi.PATCH:"fiftyone.core.clips.ClipsView"===t?oi.CLIP:"fiftyone.core.video.FramesView"===t?oi.FRAME:oi.SAMPLE}}),ui=T({key:"rootElementNamePlural",get:({get:e})=>{switch(e(mi)){case oi.CLIP:return ci.CLIP;case oi.FRAME:return ci.FRAME;case oi.PATCH:return ci.PATCH;default:return ci.SAMPLE}}}),hi=T({key:"elementNames",get:({get:e})=>({plural:e(ui),singular:e(mi)})}),pi=T({key:"isClipsView",get:({get:e})=>e(mi)===oi.CLIP}),gi=T({key:"isPatchesView",get:({get:e})=>e(mi)===oi.PATCH}),fi=T({key:"isFramesView",get:({get:e})=>e(mi)===oi.FRAME}),bi=T({key:"datasets",get:({get:e})=>{var t;return null!=(t=e(St).datasets)?t:[]}}),yi=T({key:"hasDataset",get:({get:e})=>Boolean(e(si))}),vi=T({key:"mediaType",get:({get:e})=>{const t=e(St);return t.dataset?t.dataset.media_type:null}}),xi=T({key:"isVideoDataset",get:({get:e})=>"video"===e(vi)}),wi=T({key:"view",get:({get:e})=>e(St).view||[],set:({get:e,set:t},n)=>{const s=e(St),a=r(o({},s),{view:n,selected:[],selected_labels:[],filters:{}});t(St,a),Rn.send(In("update",{state:a}))}}),ki=T({key:"datasetStats",get:({get:e})=>{const t=e(xt),n=e(wi);return t.view&&Xn(t.view,n)?t.stats:null}}),Ei=e=>{const t=Object.keys(e).sort(),n=t.map((t=>e[t]));return JSON.stringify([t,n])},Si=(e,t)=>Ei(e)===Ei(t),Li=T({key:"extendedDatasetStats",get:({get:e})=>{const t=e(wt),n=e(wi);if(!t.view)return null;if(!Xn(t.view,n))return null;const s=e(Ti);return Si(t.filters,s)?t.stats:null}}),Ti=T({key:"filterStages",get:({get:e})=>e(St).filters,set:({get:e,set:t},n)=>{const s=r(o({},e(St)),{filters:n});s.selected=[],t(Lt,new Set),Rn.send(In("filters_update",{filters:n})),t(St,s)}}),Zi=T({key:"totalCount",get:({get:e})=>(e(ki)||[]).reduce(((e,t)=>null===t.name?t.result:e),null)}),Ci=T({key:"filteredCount",get:({get:e})=>(e(Li)||[]).reduce(((e,t)=>null===t.name?t.result:e),null)});T({key:"currentCount",get:({get:e})=>e(Ci)||e(Zi)});const Pi=T({key:"labelTagsPaths",get:({get:e})=>{const t=e(Ki);return e(Fi).map((e=>`${e=Nt.includes(t[e])?`${e}.${t[e].toLocaleLowerCase()}`:e}.tags`))}}),Ri=Z({key:"fieldSchema",get:e=>({get:t})=>(t(St).dataset||{})[e+"_fields"]||[]}),Ii=e=>!e.name.startsWith("_")&&"tags"!==e.name&&(!!ln.includes(e.ftype)||!(!an.includes(e.ftype)||!ln.includes(e.subfield))),Wi=Z({key:"fields",get:e=>({get:t})=>t(Ri(e)).reduce(((e,t)=>(e[t.name]=t,e)),{})}),Mi=Z({key:"selectedFields",get:e=>({get:t})=>{const n=t(wi),s=o({},t(Wi(e))),a=t(xi);return n.forEach((({_cls:t,kwargs:n})=>{if("fiftyone.core.stages.SelectFields"===t){const t=n[0][1]?n[0][1]:[];let l=new Set([...t,...rn]);a&&"frame"===e&&(l=new Set(Array.from(l).map((e=>e.slice("frames.".length))))),Object.keys(s).forEach((e=>{l.has(e)||delete s[e]}))}else if("fiftyone.core.stages.ExcludeFields"===t){const t=n[0][1]?n[0][1]:[];let l=Array.from(t);a&&"frame"===e?l=l.map((e=>e.slice("frames.".length))):a&&(l=l.filter((e=>e.startsWith("frames.")))),l.forEach((e=>{delete s[e]}))}})),s}}),Xi=T({key:"gridZoom",get:({get:e})=>e(Qi).grid_zoom,set:({get:e,set:t},n)=>{const s=e(St),a=r(o({},s),{config:r(o({},s.config),{grid_zoom:n})});t(St,a),Rn.send(In("update",{state:a}))}}),Ni=T({key:"timeZone",get:({get:e})=>e(Qi).timezone||"UTC"}),Gi=T({key:"fieldPaths",get:({get:e})=>{const t=e=>!e.startsWith("_"),n=Object.keys(e(Mi("sample"))).filter(t);return"video"===e(vi)?n.concat(Object.keys(e(Mi("frame"))).filter(t).map((e=>"frames."+e))).sort():n.sort()}}),Yi=Z({key:"labels",get:e=>({get:t})=>{const n=t(Mi(e)),s=t(xi)&&t(li);return Object.keys(n).map((e=>n[e])).filter(((e,t)=>n=>{if(!n.embedded_doc_type)return!1;const s=n.embedded_doc_type.split(".").slice(-1)[0];return("frame"!==t&&e||!Ht.includes(s))&&Ft.includes(s)})(s,e)).sort(((e,t)=>e.name<t.name?-1:1))}}),Vi=Z({key:"labelNames",get:e=>({get:t})=>t(Yi(e)).map((e=>e.name))}),Fi=T({key:"labelPaths",get:({get:e})=>{const t=e(Vi("sample")),n=e(Vi("frame"));return t.concat(n.map((e=>"frames."+e)))}}),Ki=T({key:"labelTypesMap",get:({get:e})=>{const t=e(Vi("sample")),n=e(Oi("sample")),s=e(Vi("frame")),a=e(Oi("frame")),l=t.map(((e,t)=>[e,n[t]])),i=s.map(((e,t)=>[`frames.${e}`,a[t]]));return Object.fromEntries(l.concat(i))}}),Oi=Z({key:"labelTypes",get:e=>({get:t})=>t(Yi(e)).map((e=>e.embedded_doc_type.split(".").slice(-1)[0]))}),zi=Z({key:"primitives",get:e=>({get:t})=>{const n=t(Mi(e));return Object.keys(n).map((e=>n[e])).filter(Ii)}}),Di=Z({key:"primitiveNames",get:e=>({get:t})=>t(zi(e)).map((e=>e.name))}),Hi=Z({key:"primitiveTypes",get:e=>({get:t})=>t(zi(e)).map((e=>e.ftype))}),Ui=Z({key:"primitiveSubfields",get:e=>({get:t})=>t(zi(e)).map((e=>e.subfield))}),ji=Z({key:"primitivesSchema",get:e=>({get:t})=>Object.fromEntries(t(zi(e)).map((e=>[e.name,e])))}),Bi=Z({key:"labelTuples",get:e=>({get:t})=>{const n=t(Oi(e));return t(Vi(e)).map(((e,t)=>[e,n[t]]))}});Z({key:"labelMap",get:e=>({get:t})=>t(Bi(e)).reduce(((e,t)=>o({[t[0]]:t[1]},e)),{})});const Ji=Z({key:"primitivesMap",get:e=>({get:t})=>{const n=t(Hi(e));return t(Di(e)).reduce(((e,t,s)=>r(o({},e),{[t]:n[s]})),{})}}),Ai=Z({key:"primitivesSubfieldMap",get:e=>({get:t})=>{const n=t(Ui(e));return t(Di(e)).reduce(((e,t,s)=>r(o({},e),{[t]:n[s]})),{})}}),_i=Z({key:"primitivesDbMap",get:e=>({get:t})=>{const n=t(zi(e));return t(Di(e)).reduce(((e,t,s)=>r(o({},e),{[t]:n[s].db_field})),{media_type:"_media_type"})}}),Qi=T({key:"appConfig",get:({get:e})=>e(St).config||{}}),$i=Z({key:"colorMap",get:e=>({get:t})=>{t(Pt(e));let n=t(It);n=n.length?n:[Vn.brand];const s=t(Wt(e));return Va(n,s)}}),qi=Z({key:"coloring",get:e=>({get:t})=>{const n=t(It),s=t(Wt(e));return{seed:s,pool:n,scale:t(St).colorscale,byLabel:t(Pt(e)),defaultMaskTargets:t(eo),maskTargets:t(to).fields,targets:new Array(n.length).fill(0).map(((e,t)=>Fa(n,s,t)))}}});Z({key:"labelNameGroups",get:e=>({get:t})=>function(e,t,n){const s={labels:[],scalars:[],unsupported:[]};for(let a=0;a<t.length;a++){const e=t[a],l=n[a];Ft.includes(l)&&s.labels.push({name:e,type:l})}for(const a in e)rn.includes(a)||t.includes(a)||(ln.includes(e[a].ftype)?s.scalars.push({name:a}):s.unsupported.push({name:a}));return s}(t(Mi(e)),t(Vi(e)),t(Oi(e)))});const eo=T({key:"defaultTargets",get:({get:e})=>{var t;const n=(null==(t=e(St).dataset)?void 0:t.default_mask_targets)||{};return Object.fromEntries(Object.entries(n).map((([e,t])=>[parseInt(e,10),t])))}}),to=T({key:"targets",get:({get:e})=>{var t,n;return{defaults:(null==(t=e(St).dataset)?void 0:t.default_mask_targets)||{},fields:(null==(n=e(St).dataset)?void 0:n.mask_targets)||{}}}}),no=T({key:"getTarget",get:({get:e})=>{const{defaults:t,fields:n}=e(to);return(e,s)=>e in n?n[e][s]:t[s]}}),so=T({key:"selectedLabelIds",get:({get:e})=>{const t=e(lo);return new Set(Object.keys(t))}}),ao=T({key:"anyTagging",get:({get:e})=>{let t=[];return[!0,!1].forEach((n=>[!0,!1].forEach((s=>{t.push(e(Et({modal:n,labels:s})))})))),t.some((e=>e))},set:({set:e},t)=>{[!0,!1].forEach((n=>[!0,!1].forEach((s=>{e(Et({modal:n,labels:s}),t)}))))}});T({key:"hiddenLabelIds",get:({get:e})=>new Set(Object.keys(e(Tt)))});const lo=T({key:"selectedLabels",get:({get:e})=>{const t=e(St).selected_labels;return t?Object.fromEntries(t.map((e=>[e.label_id,e]))):{}},set:({get:e,set:t},n)=>{const s=e(St),a=Object.entries(n).map((([e,t])=>r(o({},t),{label_id:e}))),l=r(o({},s),{selected_labels:a});Rn.send(In("set_selected_labels",{selected_labels:a})),t(St,l)}}),io=Z({key:"hiddenFieldLabels",get:e=>({get:t})=>{const n=t(Tt),{sampleId:s}=t(ut);return s?Object.entries(n).filter((([t,{sample_id:n,field:a}])=>s===n&&a===e)).map((([e])=>e)):[]}}),oo=Z({key:"fieldType",get:e=>({get:t})=>{const n=e.startsWith("frames.")&&t(xi),s=t(Wi(n?"frame":"sample"));return n?s[e.slice("frames.".length)].ftype:s[e].ftype}}),ro=Z({key:"subfieldType",get:e=>({get:t})=>{const n=e.startsWith("frames.")&&t(xi),s=t(Wi(n?"frame":"sample"));return n?s[e.slice("frames.".length)].subfield:s[e].subfield}}),co=T({key:"similarityKeys",get:({get:e})=>{var t;const n=e(St),s=(null==(t=null==n?void 0:n.dataset)?void 0:t.brain_methods)||{};return Object.entries(s).filter((([e,{config:{method:t}}])=>"similarity"===t)).reduce((({patches:e,samples:t},[n,{config:{patches_field:s}}])=>(s?e.push([n,s]):t.push(n),{patches:e,samples:t})),{patches:[],samples:[]})}});var mo={app_ids:{prod:"UA-141773487-6",dev:"UA-141773487-7"},dimensions:{dev:"dimension1",version:"dimension2",context:"dimension3"}};const uo=(e,t,n)=>{const s=u.exports.useRef(n);u.exports.useEffect((()=>{s.current=n})),u.exports.useEffect((()=>{if(!e)return;const n=e=>s.current(e);return e.addEventListener(t,n),()=>{e.removeEventListener(t,n)}}),[e,t])},ho=(e,t)=>{const n=u.exports.useCallback((({data:n})=>{(n=JSON.parse(n)).type===e&&t(n)}),[e,t]);uo(Rn,"message",n)},po=(e,t,n=null,s=[])=>{u.exports.useEffect((()=>{!n&&Rn.send(JSON.stringify(r(o({},t),{type:e})))}),[n,...s])},go=(e,t)=>{const n=u.exports.useRef(t),s=u.exports.useRef(new C((()=>n.current())));u.exports.useEffect((()=>{n.current=t})),u.exports.useEffect((()=>{if(e)return s.current.observe(e),()=>s.current.unobserve(e)}),[e])},fo=(e,t)=>{uo(document,"mousedown",(n=>{e.current&&!e.current.contains(n.target)&&t(n)}))},bo=(e,t,n)=>{const s=()=>{if(!(e&&e.current&&t&&t.current))return;const{x:s,y:a}=t.current.getBoundingClientRect(),{x:l,width:i}=e.current.getBoundingClientRect();n({left:s,top:a,opacity:s-l<0||s>l+i?0:1})};uo(window,"scroll",s),uo(e?e.current:null,"scroll",s),go(t?t.current:null,s)},yo=()=>{const[e,t]=u.exports.useState({width:0,height:0}),n=()=>{t({width:window.innerWidth,height:window.innerHeight})};return uo(window,"resize",n),u.exports.useEffect((()=>{n()}),[]),e},vo=()=>{const[e,t]=u.exports.useState(!1),n=P(ti);u.exports.useEffect((()=>{if(n.do_not_track)return;const e=n.dev_install,s=e?"dev":"prod";R.initialize(mo.app_ids[s],{debug:e,gaOptions:{storage:"none",cookieDomain:"none",clientId:n.user_id}}),R.set({userId:n.user_id,checkProtocolTask:null,[mo.dimensions.dev]:s,[mo.dimensions.version]:n.version,[mo.dimensions.context]:Pn}),t(!0),R.pageview(window.location.pathname+window.location.search)}),[]),uo(window,"hashchange",(()=>{n.do_not_track||e&&R.pageview(window.location.pathname+window.location.search)}))},xo=()=>u.exports.useContext(h),wo=m(d.div`
  box-sizing: border-box;
  border-radius: 3px;
  background-color: ${({theme:e})=>e.backgroundDarker};
  box-shadow: 0 2px 25px 0 ${({theme:e})=>e.darkShadow};
  color: ${({theme:e})=>e.fontDark};
  border-radius: 2px;
  padding: 0.5rem;
  line-height: 1rem;
  margin-top: 2.5rem;
  font-weight: bold;
  position: fixed;
  width: auto;
  z-index: 802;
`),ko=d.div`
  color: ${({theme:e})=>e.font};
  display: flex;
  padding-bottom: 0.5rem;
`,Eo=g.memo((({barRef:e,followRef:t,serviceRef:n,style:s,machine:a})=>{const l=u.exports.useContext(h);let i,c;[i,c]=a||W(n);const d=u.exports.useRef(),[m,p]=u.exports.useState(null),{error:f,errorId:b}=i.context,[y,v]=M((()=>{const e=t?{left:t.current.getBoundingClientRect().x,top:t.current.getBoundingClientRect().y}:{};return r(o({},e),{opacity:b?1:0,from:{opacity:0},config:X.stiff})}));return u.exports.useEffect((()=>{m&&clearTimeout(m),!b&&p(setTimeout((()=>c("CLEAR_ERROR")),1e3)),v({opacity:b?1:0})}),[b]),fo(d,(()=>c("CLEAR_ERROR_ID"))),bo(e,t,v),g.createElement(wo,{ref:d,style:o(r(o({},y),{display:f?"block":"none"}),s)},f?g.createElement(g.Fragment,null,g.createElement(ko,null,g.createElement(N,{style:{color:l.error,marginRight:"0.5rem"}}),g.createElement("div",{style:{marginTop:"0.25rem"}},`Invalid ${f.name}.`)),f.error):null)})),So=(e,t)=>{t=t||"";const n=e.filter((e=>e.toLowerCase().startsWith(t.toLowerCase())))[0];return n&&t.length?{placeholder:n.slice(t.length),value:n}:{placeholder:"",value:null}},Lo=(e,t)=>{const n=e.filter((e=>e.toLowerCase()===t.toLowerCase()));return 1===n.length?n[0]:null},To=m(d.div`
  cursor: pointer;
  margin: 0.25rem 0.25rem;
  padding: 0.1rem 0.25rem;
  font-weight: bold;
  color: ${({theme:e})=>e.fontDark};
`),Zo=g.memo((({result:e,isActive:t,send:n,highlight:s})=>{const a=u.exports.useRef(null),l=u.exports.useContext(h),[i,o]=M((()=>({backgroundColor:t?l.backgroundLight:l.backgroundDark,color:t?l.font:l.fontDark})));u.exports.useEffect((()=>{o({backgroundColor:t?l.backgroundLight:l.backgroundDark,color:t?l.font:l.fontDark}),t&&a.current&&a.current.scrollIntoView()}),[t,a.current]);return g.createElement(To,{ref:a,onClick:e=>n({type:"COMMIT",value:e.target.dataset.result,click:!0}),onMouseEnter:()=>o({backgroundColor:l.backgroundLight,color:l.font}),onMouseLeave:()=>!t&&o({backgroundColor:l.backgroundDark,color:l.fontDark}),style:i,"data-result":e},[null,void 0].includes(e)?g.createElement("code",{style:{color:s}},"None"):e)})),Co=m(d.div`
  background-color: ${({theme:e})=>e.backgroundDark};
  border: 1px solid ${({theme:e})=>e.backgroundDarkBorder};
  border-radius: 2px;
  box-shadow: 0 2px 20px ${({theme:e})=>e.backgroundDark};
  box-sizing: border-box;
  margin-top: 2.5rem;
  position: fixed;
  width: auto;
  z-index: 801;
  max-height: 328px;
  overflow-y: scroll;
  scrollbar-width: none;

  &::-webkit-scrollbar {
    width: 0px;
    background: transparent;
    display: none;
  }
  &::-webkit-scrollbar-thumb {
    width: 0px;
    display: none;
  }
`),Po=g.memo((e=>{var t=e,{results:n,send:s,currentResult:a,barRef:l,followRef:i,bestMatch:d,highlight:m}=t,u=c(t,["results","send","currentResult","barRef","followRef","bestMatch","highlight"]);const[h,p]=M((()=>{const e=i?{left:i.current.getBoundingClientRect().x,top:i.current.getBoundingClientRect().y}:{};return r(o({},e),{opacity:1,from:{opacity:0},config:X.stiff})}));return bo(l,i,p),n.length?g.createElement(Co,o({style:h,onMouseEnter:()=>s("MOUSEENTER"),onMouseLeave:()=>s("MOUSELEAVE")},u),n.map(((e,t)=>g.createElement(Zo,{key:e,result:e,isActive:a===t||d===e,send:s,highlight:m})))):null})),Ro=d.a`
  color: ${({theme:e})=>e.font};
`,Io=e=>{let t;if(dn())try{t=require("electron").shell.openExternal}catch{}return t?n=>{n.preventDefault(),t(e)}:null},Wo=e=>{var t=e,{href:n}=t,s=c(t,["href"]);const a=Io(n);return g.createElement(Ro,r(o({},s),{href:n,target:"_blank",onClick:a}))},Mo=e=>g.createElement(G,o({},e),g.createElement("path",{d:"M6 15a2 2 0 0 1-2 2a2 2 0 0 1-2-2a2 2 0 0 1 2-2h2v2m1 0a2 2 0 0 1 2-2a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2a2 2 0 0 1-2-2v-5m2-8a2 2 0 0 1-2-2a2 2 0 0 1 2-2a2 2 0 0 1 2 2v2H9m0 1a2 2 0 0 1 2 2a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2a2 2 0 0 1 2-2h5m8 2a2 2 0 0 1 2-2a2 2 0 0 1 2 2a2 2 0 0 1-2 2h-2v-2m-1 0a2 2 0 0 1-2 2a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2a2 2 0 0 1 2 2v5m-2 8a2 2 0 0 1 2 2a2 2 0 0 1-2 2a2 2 0 0 1-2-2v-2h2m0-1a2 2 0 0 1-2-2a2 2 0 0 1 2-2h5a2 2 0 0 1 2 2a2 2 0 0 1-2 2h-5z"}));var Xo="assets/logo.c7dc2f64.png";const No=d.div`
  font-size: 1.2rem;
  display: flex;
  border-bottom: 1px ${({theme:e})=>e.brand} solid;
`,Go=d(Y)`
  & input {
    background-color: transparent;
    border: none;
    color: ${({theme:e})=>e.font};
    height: 40px;
    font-size: 1.2rem;
    border: none;
    align-items: center;
    font-weight: bold;
  }

  & input:focus {
    border: none;
    outline: none;
    font-weight: bold;
  }

  & ::placeholder {
    color: ${({theme:e})=>e.font};
    font-weight: bold;
  }
`,Yo=d.div`
  background-color: ${({theme:e})=>e.backgroundDark};
  display: flex;
  flex-shrink: 0;
  justify-content: space-between;
  width: 100%;
  border-bottom: 1px ${({theme:e})=>e.backgroundDarkBorder} solid;
`,Vo=d.div`
  margin-right: 1rem;
  cursor: pointer;
  height: 40px;
  display: flex;
`,Fo=m(d.img`
  height: 100%;
  width: auto;
  cursor: pointer;
  margin-right: 1rem;
  will-change: transform;
`),Ko=d.div`
  display: flex;
  padding: 1rem;
`,Oo=d.div`
  margin-left: auto;
  padding-right: 0.5rem;
  display: flex;
`,zo=d.div`
  color: ${e=>e.font};
  font-weight: bold;
  font-size: 1.8rem;
  align-items: center;
  display: flex;
`,Do=d.div`
  font-weight: bold;
  padding-left: 1rem;
  border-left-width: 1px;
  border-color: ${({theme:e})=>e.backgroundDarkBorder};
  border-left-style: solid;
`,Ho=d.div`
  display: flex;
  height: 100%;
  align-items: center;
  justify-content: center;

  a {
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    margin-right: 0.5em;
  }

  svg:focus {
    outline: none;
  }
`,Uo=d.div`
  font-weight: bold;
  cursor: pointer;
  font-size: 1rem;
  border-radius: 3px;
  text-align: center;
  padding: 0 0.5rem;
  border: 1px solid ${({theme:e})=>e.brand};

  &.disabled {
    border: 1px solid ${({theme:e})=>e.fontDark};
    cursor: default;
  }
`,jo=V({id:"selectorMachine",initial:"reading",context:{error:void 0,values:[],value:"",selected:[],currentResult:null,errorId:null,results:[],prevValue:"",bestMatch:{},onCommit:()=>{}},states:{reading:{entry:F({errorId:null}),on:{EDIT:{target:"editing"}}},editing:{entry:[F({errorId:null,currentResult:({values:e,value:t})=>e.indexOf(t),prevValue:({value:e})=>e,results:({values:e})=>e,bestMatch:({values:e,value:t})=>So(e,t)})],type:"parallel",states:{input:{initial:"focused",states:{focused:{on:{UNFOCUS_INPUT:"unfocused"}},unfocused:{on:{FOCUS_INPUT:"focused"}}}},searchResults:{initial:"notHovering",states:{hovering:{on:{MOUSELEAVE:"notHovering"}},notHovering:{on:{MOUSEENTER:"hovering"}}}}},on:{NEXT_RESULT:{actions:F({currentResult:({currentResult:e,results:t})=>null===e?0:Math.min(e+1,t.length-1),value:({currentResult:e,results:t})=>null===e?t[0]:t[Math.min(e+1,t.length-1)],bestMatch:{}})},PREVIOUS_RESULT:{actions:F({currentResult:({currentResult:e})=>0===e||null===e?null:e-1,value:({currentResult:e,prevValue:t,results:n})=>0===e||null===e?t:n[e-1],bestMatch:{}})},BLUR:{target:"reading",actions:[F({value:({value:e,prevValue:t,values:n})=>t})]},COMMIT:[{target:"reading",actions:[F({value:(e,{value:t})=>t,valid:!0}),({onCommit:e,prevValue:t},{value:n})=>{n!==t&&e(n)}],cond:({values:e},{value:t})=>e.some((e=>e===t))},{actions:F({error:(e,{value:t})=>({name:"name",error:`${""===t?'""':t} does not exist`}),errorId:x(),valid:!1})}],CHANGE:{actions:[F({value:(e,{value:t})=>t,results:({values:e})=>e,errorId:null,currentResult:({values:e},{value:t})=>{const n=e.indexOf(t);return n>0?n:null},bestMatch:({values:e},{value:t})=>So(e,t)})]}}}},on:{SET_VALUES:{target:"reading",actions:[F({value:(e,{value:t})=>t,values:(e,{values:t})=>t,onCommit:(e,{onCommit:t})=>t})]}}}),Bo=d.input`
  width: 100%;
  background-color: transparent;
  border: none;
  padding: 0.5rem 0;
  margin-bottom: 1rem;
  border
  color: ${({theme:e})=>e.font};
  line-height: 1rem;
  border: none;
  border-bottom: 1px solid ${({theme:e})=>e.brand};
  font-weight: bold;

  &:focus {
    border-bottom: 1px solid ${({theme:e})=>e.brand};
    outline: none;
    font-weight: bold;
  }

  &::placeholder {
    color: ${({theme:e})=>e.fontDark};
    font-weight: bold;
  }
`,Jo=()=>{var e,t,n,s,a,l,i,c,d;const[m,h]=u.exports.useState({email:"",firstname:"",lastname:"",company:"",role:"",discover:""}),[p,f]=u.exports.useState("Submit"),[b,y]=H(yt),v=P(bt),x=e=>t=>h(r(o({},m),{[e]:t.target.value})),w=!((null==(e=m.email)?void 0:e.length)&&(null==(t=m.firstname)?void 0:t.length)&&(null==(n=m.lastname)?void 0:n.length))||b.submitted;return g.createElement(g.Fragment,null,g.createElement(Bo,{key:"firstname",placeholder:"First name*",value:null!=(s=m.firstname)?s:"",maxLength:40,onChange:x("firstname")}),g.createElement(Bo,{key:"lastname",placeholder:"Last name*",value:null!=(a=m.lastname)?a:"",maxLength:40,onChange:x("lastname")}),g.createElement(Bo,{key:"email",placeholder:"Email*",type:"email",value:null!=(l=m.email)?l:"",onChange:x("email")}),g.createElement(Bo,{key:"company",placeholder:"Company",value:null!=(i=m.company)?i:"",maxLength:100,onChange:x("company")}),g.createElement(Bo,{key:"role",placeholder:"Role",value:null!=(c=m.role)?c:"",maxLength:100,onChange:x("role")}),g.createElement(Bo,{key:"discover",placeholder:"How did you hear about FiftyOne?",value:null!=(d=m.discover)?d:"",maxLength:100,onChange:x("discover")}),g.createElement(Uo,{key:"submit",onClick:()=>{if(w)return;f("Submitting...");const e=new Headers;e.append("Content-Type","application/json");fetch("https://api.hsforms.com/submissions/v3/integration/submit/4972700/87aa5367-a8f1-4ed4-9e23-1fdf8448d807",{method:"post",headers:e,mode:"cors",body:JSON.stringify({submittedAt:Date.now(),fields:[{name:"firstname",value:m.firstname},{name:"lastname",value:m.lastname},{name:"email",value:m.email},{name:"company",value:m.company},{name:"role",value:m.role},{name:"app_how_did_you_hear_about_us",value:m.discover}],context:{pageName:"FiftyOne App"}})}).then((e=>{if(200!==e.status)throw new Error("Failed submission");return e.json()})).then((()=>{f("Submitted. Thank you!"),y(r(o({},b),{submitted:!0})),fetch(`${Zn}/teams?submitted=true`,{method:"post"}),setTimeout((()=>v&&v.close()),2e3)})).catch((e=>{f("Something went wrong")}))},style:{marginBottom:"1rem"},className:w?"disabled":""},p))},Ao=()=>{const e=P(si),t=P(bi),[n,s]=z(jo),a=P(ft),l=D(xt),i=D(wt),o=u.exports.useRef(),{results:r,currentResult:c,value:d,bestMatch:m,values:h}=n.context;u.exports.useEffect((()=>{s({type:"SET_VALUES",value:null!=e?e:"",values:t,onCommit:e=>{l(),i(),Rn.send(In("set_dataset",{dataset_name:e}))}})}),[e,t,Rn]);const p=n.matches("editing");return u.exports.useEffect((()=>{p&&o.current&&o.current.focus(),!p&&o.current&&o.current.blur()}),[p,o.current]),g.createElement(Do,null,g.createElement(No,null,g.createElement(Go,{placeholder:t.length>0?"Select a dataset":"No datasets available",disabled:!t.length,value:a?d:"Not connected",onFocus:()=>n.matches("reading")&&s("EDIT"),onBlur:e=>{n.matches("editing.searchResults.notHovering")&&s("BLUR")},ref:o,onChange:e=>s({type:"CHANGE",value:e.target.value}),onKeyPress:e=>{if("Enter"===e.key){const t=Lo(h,e.target.value);s({type:"COMMIT",value:t||(m.value?m.value:e.target.value)})}},onKeyDown:e=>{switch(e.key){case"Escape":s("BLUR");break;case"ArrowDown":s("NEXT_RESULT");break;case"ArrowUp":s("PREVIOUS_RESULT");break;case"ArrowRight":e.target.selectionStart===e.target.value.length&&m.value&&s({type:"CHANGE",value:m.value})}}}),n.matches("editing")||""===d?g.createElement(mt,{style:{height:"40px",margin:"-1px 0 0 -2px",fontSize:"1.2rem",alignItems:"center"}},m?m.placeholder:""):null),n.matches("editing")&&g.createElement(Po,{results:r,send:s,currentResult:c,bestMatch:m.value,style:{marginTop:8,fontSize:"1.2rem",maxHeight:212,overflowY:"scroll"}}),g.createElement(Eo,{machine:[n,s],style:{marginTop:8}}))},_o=({addNotification:e})=>{const[t,n]=H(Mt),[s,a]=H(yt),[l,i]=H(bt),c=g.createElement("span",null,"FiftyOne is and will always be open source software that is freely available to individual users, all 35,000 and counting. However, if youre part of a team, you may need more. Thats why weve begun deploying team-based versions of FiftyOne with multi-user collaboration features to early adopters.",g.createElement("br",null),g.createElement("br",null),"Are you interested in a team-based deployment of FiftyOne? Let us know how to contact you and our founders will reach out to make it happen!"),d=u.exports.useContext(h),m=P(ni),p=()=>{if(!t){n(!0);const t=e.current({kind:"Get FiftyOne for your team",message:c,children:[g.createElement(Jo,{key:"teams"})],onClose:()=>n(!1)});i({close:t})}};return"shown"===m?g.createElement(Uo,{onClick:p,style:{marginRight:"0.5rem",position:"relative"}},"Have a team?",g.createElement("div",{style:{position:"absolute",top:"-0.8rem",right:"-0.8rem"}},g.createElement(f,{style:{borderRadius:"1rem",background:d.brand},onClick:e=>{e.stopPropagation(),a(r(o({},s),{minimized:!0})),fetch(`${Zn}/teams`,{method:"post"}),l&&l.close()}}))):"minimized"===m?g.createElement(U,{style:{cursor:"pointer",marginRight:"0.5em"},onClick:p}):null},Qo=({addNotification:e})=>{const t=P(ei),n=M({transform:t?"rotate(0turn)":"rotate(1turn)"});return g.createElement(Yo,null,g.createElement(Ko,null,g.createElement(Vo,{onClick:()=>Rn.send(In("refresh",{}))},g.createElement(Fo,{style:n,src:Xo}),g.createElement(zo,{className:"fix-me"},"FiftyOne")),g.createElement(Ao,null)),g.createElement(Oo,null,g.createElement(Ho,null,g.createElement(u.exports.Suspense,{fallback:null},g.createElement(_o,{addNotification:e})),g.createElement(Wo,{title:"Slack",href:"https://join.slack.com/t/fiftyone-users/shared_invite/zt-s6936w7b-2R5eVPJoUw008wP7miJmPQ"},g.createElement(Mo,null)),g.createElement(Wo,{title:"GitHub",href:"https://github.com/voxel51/fiftyone"},g.createElement(K,null)),g.createElement(Wo,{title:"Documentation",href:"https://voxel51.com/docs/fiftyone/user_guide/app.html"},g.createElement(O,null)))))},$o=d.div`
  padding: 1em;
  box-sizing: border-box;
  border: 2px solid ${({theme:e})=>e.border};
  background-color: ${({theme:e})=>e.background};
`;d.div`
  height: ${({height:e})=>"number"==typeof e?e+"px":e};
  background-color: ${({opaque:e,theme:t})=>e?t.background:void 0};
`,d.button`
  display: flex;
  align-items: center;
  background-color: ${({theme:e})=>e.button};
  color: ${({theme:e})=>e.font};
  border: 1px solid ${({theme:e})=>e.buttonBorder};
  border-radius: 1px;
  margin: 0 3px;
  padding: 3px 10px;
  font-weight: bold;
  cursor: pointer;

  svg.MuiSvgIcon-root {
    font-size: 1.25em;
    margin-left: -3px;
    margin-right: 3px;
  }
`;const qo=d.div`
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  z-index: 10000;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: ${({theme:e})=>e.overlay};
`,er=d.div`
  display: block;
  border-top: 2px solid ${({theme:e})=>e.border};
  padding: 1em;
  background-color: ${({theme:e})=>e.backgroundLight};
  z-index: 9000;
  position: absolute;
  right: 0;
  bottom: 0;
  width: 100%;
  min-height: 64.5px;
`,tr=({theme:e})=>`\n::-webkit-scrollbar {\n  width: 16px;\n}\n\nscrollbar-color: ${({theme:e})=>e.fontDarkest} ${({theme:e})=>e.background};\n\n::-webkit-scrollbar-track {\n  border: solid 4px transparent ${e.fontDarkest};\n}\n\n::-webkit-scrollbar-thumb {\n  box-shadow: inset 0 0 10px 10px transparent;\n  border: solid 4px transparent;\n  border-radius: 16px;\n  transition: box-shadow linear 0.5s;\n}\n&:hover::-webkit-scrollbar-thumb {\n  box-shadow: inset 0 0 10px 10px ${e.fontDarkest};\n}\n`,nr=d.div`
  box-sizing: border-box;
  border-radius: 3px;
  background-color: ${({theme:e})=>e.backgroundDarker};
  color: ${({theme:e})=>e.fontDark};
  border: 1px solid #191c1f;
  box-shadow: 0 8px 15px 0 rgba(0, 0, 0, 0.43);
  border-radius: 2px;
  padding: 0.5rem;
  line-height: 1rem;
  margin-top: 2.5rem;
  font-weight: bold;
  width: auto;
  z-index: 802;
`,sr=d.div`
  color: ${({theme:e})=>e.font};
  display: flex;
  padding-bottom: 0.5rem;
`,ar=m(d.div`
  line-height: 1.5rem;
  padding: 0.25rem 0.75rem;
  cursor: pointer;
  background-color: ${({theme:e})=>e.button};
  height: 2rem;
  border-radius: 1rem;
  border: none;
  font-weight: bold;
  display: flex;
  justify-content: space-between;
  opacity: 1;

  & > span {
    margin: 0 0.25rem;
  }
  & > svg {
    display: inline-block;
    height: 100%;
  }
`),lr=g.memo(g.forwardRef((({onClick:e,open:t,text:n,icon:s,highlight:a,arrow:l=!1,style:i,title:r},c)=>{const d=xo(),m=M({backgroundColor:a?d.brand:d.button});return g.createElement(ar,{onClick:e,ref:c,style:o(o({},m),i),title:r},n&&g.createElement("span",null,n),s,l&&(t?g.createElement(j,null):g.createElement(B,null)))}))),ir=m(d.div`
  background-color: ${({theme:e})=>e.backgroundDark};
  border: 1px solid ${({theme:e})=>e.backgroundDarkBorder};
  border-radius: 2px;
  box-shadow: 0 2px 20px ${({theme:e})=>e.backgroundDark};
  box-sizing: border-box;
  margin-top: 0.6rem;
  position: absolute;
  width: auto;
  z-index: 801;
  font-size: 14px;
  padding: 0 0.5rem 0 0.5rem;
  min-width: 14rem;
`),or=d.div`
  margin: 0 -0.5rem;
  padding: 0 0.5rem;
  border-bottom: 1px solid ${({theme:e})=>e.backgroundLight};
  font-size: 1rem;
  line-height: 2;
  font-weight: bold;
`,rr=m(d.div`
  display: flex;
  font-weight: bold;
  cursor: pointer;
  justify-content: space-between;
  margin: 0.5rem -0.5rem;
  height: 2rem;

  & > div {
    display: flex;
    justify-content: center;
    align-content: center;
    flex-direction: column;
    cursor: inherit;
    flex-grow: 1;
    flex-basis: 0;
    text-align: center;Checkbox
    overflow: hidden;
  }
`),cr=m(d.div``),dr=({active:e,options:t,color:n})=>{const s=xo(),[a,l]=u.exports.useState(t.map((e=>!1))),i=J(t.length,t.map(((t,l)=>({backgroundColor:t.text===e?n||s.brand:a[l]?s.background:s.backgroundLight,color:a?s.font:s.fontDark})))),[c,d]=M((()=>({background:s.backgroundLight})));return g.createElement(rr,{style:c,onMouseEnter:()=>d({background:s.background}),onMouseLeave:()=>d({background:s.backgroundLight})},t.map((({text:t,title:n,onClick:s},c)=>g.createElement(cr,{onClick:s,title:n,style:r(o({},i[c]),{cursor:t===e?"default":"pointer"}),onMouseEnter:()=>l(a.map(((e,t)=>t===c||e))),onMouseLeave:()=>l(a.map(((e,t)=>t!==c&&e))),key:c},t))))},mr=d($o)`
  cursor: ${({clickable:e})=>e?"pointer":void 0};
  font-weight: bold;
  user-select: none;
  border-radius: 3px;

  .icon {
    float: right;
    order: 1;
  }
`,ur=e=>{var t=e,{children:n,icon:s,onClick:a}=t,l=c(t,["children","icon","onClick"]);return g.createElement(mr,o({clickable:Boolean(a),onClick:()=>{if(a)return a()}},l),s?g.createElement("span",{className:"icon"},s):null,n)};ur.Body=mr;const hr=d(ur)`
  width: 100%;
  padding: 0.5rem;

  svg {
    font-size: 1.25em;
    vertical-align: middle;
  }
`,pr=e=>e?g.createElement(A,null):g.createElement(_,null),gr=e=>e?g.createElement(Q,null):g.createElement($,null),fr=e=>{var t=e,{label:n,expanded:s,onClick:a,icon:l=pr}=t,i=c(t,["label","expanded","onClick","icon"]);return g.createElement(hr,o({icon:l(s),onClick:a},i),n)};fr.Body=hr;const br=d.div``,yr=d.div`
  margin-bottom: -2px;
`,vr=d(fr)`
  width: 100% !important;
`,xr=d(vr)`
  border-radius: 0;
  border-width: 0 0 1px 0;
  padding: 0.5em 0 0.5em 0;
  width: 100%;
`,wr=d.div`
  width: 100%;
  padding-top: 0.5em;
  margin-bottom: 1em;
`,kr=d($o)`
  width: 100%;
  border-top: none;
`,Er=({children:e,label:t,title:n,expanded:s,onExpand:a,boxed:l=!1})=>{const i=a?()=>a(!s):void 0,o=l?yr:br,r=l?vr:xr,c=l?kr:wr;return g.createElement(o,null,g.createElement(r,{label:t,title:n,expanded:s,onClick:i,icon:gr}),s?g.createElement(c,null,e):null)},Sr=(e,t,n)=>o({_CLS:"bool",true:!1,false:!1,none:!1},e(yc({modal:t,path:n}))),Lr=(e,t,n,s,a,l)=>{const i=r(o({},Sr(e,n,s)),{[a]:l});(e=>!1===e.true&&!1===e.false&&!1===e.none)(i)?t(yc({modal:n,path:s}),null):t(yc({modal:n,path:s}),i)},Tr=Z({key:"filterBooleanFieldTrue",get:({modal:e,path:t})=>({get:n})=>Sr(n,e,t).true,set:({modal:e,path:t})=>({get:n,set:s},a)=>Lr(n,s,e,t,"true",a)}),Zr=Z({key:"filterBooleanFieldFalse",get:({modal:e,path:t})=>({get:n})=>Sr(n,e,t).false,set:({modal:e,path:t})=>({get:n,set:s},a)=>Lr(n,s,e,t,"false",a)}),Cr=Z({key:"filterBooleanFieldNone",get:({modal:e,path:t})=>({get:n})=>Sr(n,e,t).none,set:({modal:e,path:t})=>({get:n,set:s},a)=>Lr(n,s,e,t,"none",a)}),Pr=Z({key:"booleanFieldIsFiltered",get:({path:e,modal:t})=>({get:n})=>n(Cr({path:e,modal:t}))||n(Tr({path:e,modal:t}))||n(Zr({path:e,modal:t}))}),Rr=Z({key:"booleanSelectedValues",get:({modal:e,path:t})=>({get:n})=>{const s=[];return n(Cr({modal:e,path:t}))&&s.push(null),n(Zr({modal:e,path:t}))&&s.push(!1),n(Tr({modal:e,path:t}))&&s.push(!0),s},set:({path:e,modal:t})=>({get:n,set:s},a)=>{const l=Cr({path:e,modal:t}),i=Zr({path:e,modal:t}),o=Tr({modal:t,path:e}),r=n(l),c=n(i),d=n(o);if(!Array.isArray(a))return r&&s(l,!1),c&&s(i,!1),void(d&&s(o,!1));const m=a.includes(null);m!==r&&s(l,m);const u=a.includes(!1);u!==c&&s(i,u);const h=a.includes(!0);h!==d&&s(o,h)}}),Ir=Z({key:"isBooleanField",get:e=>({get:t})=>{let n=t(Ji("sample"));return an.includes(n[e])&&(n=t(Ai("sample"))),"fiftyone.core.fields.BooleanField"===n[e]}}),Wr=Z({key:"isDateTimeField",get:e=>({get:t})=>{let n=t(Ji("sample"));return n[e]===sn&&(n=t(Ai("sample"))),_t===n[e]}}),Mr=Z({key:"isDateField",get:e=>({get:t})=>{let n=t(Ji("sample"));return n[e]===sn&&(n=t(Ai("sample"))),At===n[e]}}),Xr=Z({key:"isNumericField",get:e=>({get:t})=>{let n=t(Ji("sample"));return an.includes(n[e])&&(n=t(Ai("sample"))),on.includes(n[e])}}),Nr=Z({key:"isSupportField",get:e=>({get:t})=>{let n=t(Ji("sample"));return qt===n[e]}});Z({key:"isIntField",get:e=>({get:t})=>{let n=t(Ji("sample"));return an.includes(n[e])&&(n=t(Ai("sample"))),[qt,en].includes(n[e])}});const Gr=(e,t,n,s)=>{const a=e(Fr({path:n,defaultRange:s}));return o(o({_CLS:"numeric"},{range:a,none:!0,nan:!0,inf:!0,ninf:!0,exclude:!1}),e(yc({modal:t,path:n})))},Yr=(e,t)=>e.range.every(((e,n)=>e===t[n]))&&e.none&&e.nan&&e.inf&&e.ninf&&!e.exclude,Vr=(e,t,n,s,a,l,i=null)=>{const c=e(Fr({path:s,defaultRange:i})),d=r(o({range:c},Gr(e,n,s,i)),{[a]:l,_CLS:"numeric"}),m=r(o({},d),{[a]:l}),u=Yr(m,c);!u&&Yr(r(o({},m),{range:c}),c)?t(yc({modal:n,path:s}),{range:d.range,_CLS:"numeric"}):t(yc({modal:n,path:s}),u?null:d)},Fr=Z({key:"numericFieldBounds",get:({path:e,defaultRange:t})=>({get:n})=>{var s;const a=n(Wr(e))||n(Mr(e));let l=(null!=(s=n(ki))?s:[]).reduce(((t,n)=>n.name!==e||n._CLS!==jt?t:a?n.result.map((e=>e?e.datetime:e)):n.result.bounds?n.result.bounds:n.result),[null,null]);if(l.every((e=>null===e)))return l;let[i,o]=[null,null];return t&&([i,o]=t,l=[i<l[0]?i:l[0],o>l[1]?o:l[1]]),[l[0],l[1]]}}),Kr=Z({key:"filterNumericFieldRange",get:({defaultRange:e,modal:t,path:n})=>({get:s})=>Gr(s,t,n,e).range,set:({defaultRange:e,modal:t,path:n})=>({get:s,set:a},l)=>{Vr(s,a,t,n,"range",l,e)}}),Or=Z({key:"otherAtom",get:({defaultRange:e,modal:t,path:n,key:s})=>({get:a})=>Gr(a,t,n,e)[s],set:({defaultRange:e,modal:t,path:n,key:s})=>({get:a,set:l},i)=>Vr(a,l,t,n,s,i,e)}),zr=Z({key:"otherFilteredCounts",get:({modal:e,path:t})=>({get:n})=>{var s;const a=n(Tc({modal:e,path:t}));let{inf:l,"-inf":i,nan:o}=(null!=(s=n(e?xc:ki))?s:[]).reduce(((e,n)=>n.name!==t||n._CLS!==jt?e:(n.result.bounds,n.result)),{nan:0,"-inf":0,inf:0});return{none:a,inf:l,ninf:i,nan:o}}}),Dr=Z({key:"otherFilteredCounts",get:({modal:e,path:t})=>({get:n})=>{var s;const a=n(Lc(e))[t],l=n(fc(e)),i=null!=(s=n(e?kc:Li))?s:[];if(!l||!i.length)return n(zr({modal:e,path:t}));let{inf:o,"-inf":r,nan:c}=i.reduce(((e,n)=>n.name!==t||n._CLS!==jt?e:(n.result.bounds,n.result)),{nan:0,"-inf":0,inf:0});return{none:a,inf:o,ninf:r,nan:c}}}),Hr=Z({key:"otherKeyedFilteredCount",get:e=>{var t=e,{key:n}=t,s=c(t,["key"]);return({get:e})=>e(Dr(s))[n]}}),Ur=Z({key:"filterNumericFieldExclude",get:({modal:e,path:t,defaultRange:n})=>({get:s})=>Gr(s,e,t,n).exclude,set:({modal:e,path:t,defaultRange:n})=>({get:s,set:a},l)=>{Vr(s,a,e,t,"exclude",l,n)}}),jr=Z({key:"numericFieldIsFiltered",get:({path:e,defaultRange:t,modal:n})=>({get:s})=>!Yr(Gr(s,n,e,t),s(Fr({path:e,defaultRange:t})))}),Br=Z({key:"isDefaultNumericFieldRange",get:e=>({get:t})=>{const n=t(Kr(e));return t(Fr(e)).every(((e,t)=>e===n[t]))}}),Jr=Z({key:"isStringField",get:e=>({get:t})=>{let n=t(Ji("sample"));return an.includes(n[e])&&(n=t(Ai("sample"))),[tn,nn].includes(n[e])}}),Ar=(e,t,n)=>o({values:[],exclude:!1,_CLS:"str"},e(yc({modal:t,path:n}))),_r=(e,t,n,s,a,l)=>{const i=r(o({},Ar(e,n,s)),{[a]:l});0===i.values.length&&(i.exclude=!1),(e=>0===e.values.length&&!1===e.exclude)(i)?t(yc({modal:n,path:s}),null):t(yc({modal:n,path:s}),i)},Qr=Z({key:"filterStringFieldValues",get:({modal:e,path:t})=>({get:n})=>Ar(n,e,t).values,set:({modal:e,path:t})=>({get:n,set:s},a)=>_r(n,s,e,t,"values",a)}),$r=Z({key:"filterStringFieldExclude",get:({modal:e,path:t})=>({get:n})=>Ar(n,e,t).exclude,set:({modal:e,path:t})=>({get:n,set:s},a)=>_r(n,s,e,t,"exclude",a)}),qr=Z({key:"stringFieldIsFiltered",get:({path:e,modal:t})=>({get:n})=>n(Qr({modal:t,path:e})).length>0||$r({modal:t,path:e})}),ec=e=>Nt.includes(e)?`.${Ut[e]}`:"",tc=Z({key:"labelFilters",get:e=>({get:t})=>{const n=t(e?ic:lc),s={},a=t(Ki),l=e?t(Tt):null,i=t(Di("sample"));for(const o of n){if(i.includes(o)){if(t(Xr(o))){let[n,a,l,i,r,c]=[t(Kr({modal:e,path:o})),t(Or({modal:e,path:o,key:"none"})),t(Or({modal:e,path:o,key:"inf"})),t(Or({modal:e,path:o,key:"ninf"})),t(Or({modal:e,path:o,key:"nan"})),t(Ur({modal:e,path:o}))];c&&(a=!a,l=!l,i=!i,r=!r),s[o]=e=>(c?n[0]-.005>e||e>n[1]+.005:n[0]-.005<=e&&e<=n[1]+.005)||a&&void 0===e||l&&"inf"===e||r&&"nan"===e||i&&"-inf"===e}else if(t(Jr(o))){const[n,a]=[t(Qr({modal:e,path:o})),t($r({modal:e,path:o}))];s[o]=e=>{let t=n.includes(e);return a&&(t=!t),t||0===n.length}}else if(t(Ir(o))){const[n,a,l]=[t(Tr({modal:e,path:o})),t(Zr({modal:e,path:o})),t(Cr({modal:e,path:o}))];s[o]=n||a||l?e=>!(!0!==e||!n)||(!(!1!==e||!a)||!(null!==e||!l)):e=>!0}continue}const n=`${o}${ec(a[o])}`,r=`${n}.confidence`,c=`${n}.label`,d=`${n}.value`;let[m,u,h,p,g,f,b,y,v,x,w,k,E,S]=[t(Kr({modal:e,path:r,defaultRange:[0,1]})),t(Or({modal:e,path:r,defaultRange:[0,1],key:"none"})),t(Or({modal:e,path:r,defaultRange:[0,1],key:"inf"})),t(Or({modal:e,path:r,defaultRange:[0,1],key:"ninf"})),t(Or({modal:e,path:r,defaultRange:[0,1],key:"nan"})),t(Ur({modal:e,path:r,defaultRange:[0,1]})),t(Qr({modal:e,path:c})),t($r({modal:e,path:c})),t(Kr({modal:e,path:d})),t(Or({modal:e,path:d,key:"none"})),t(Or({modal:e,path:d,key:"inf"})),t(Or({modal:e,path:d,key:"ninf"})),t(Or({modal:e,path:d,key:"nan"})),t(Ur({modal:e,path:d}))];f&&(u=!u,h=!h,p=!p,g=!g),S&&(x=!x,w=!w,k=!k,E=!E);const L=t(bc({key:"label",modal:e}));s[o]=e=>{var t;if(l&&l[null!=(t=e.id)?t:e._id])return!1;const n=f?m[0]-.005>e.confidence||e.confidence>m[1]+.005:m[0]-.005<=e.confidence&&e.confidence<=m[1]+.005,s=u&&void 0===e.confidence;let a=e.label?e.label:e.value;void 0===a&&(a=null);let i=b.includes(a);y&&(i=!i);const o=0==L.size||e.tags&&e.tags.some((e=>L.has(e))),r=S?v[0]-.005>e.value||e.value>v[1]+.005:v[0]-.005<=e.value&&e.value<=v[1]+.005,c=x&&void 0===e.value;return(n||s||g&&"nan"===e.confidence||h&&"inf"===e.confidence||p&&"-inf"===e.confidence)&&(i||0===b.length)&&o&&(r||c||E&&"nan"===e.value||w&&"inf"===e.value||k&&"-inf"===e.value)}}return s},set:()=>({get:e,set:t},n)=>{t(ic,e(lc)),t(pt(!0),e(pt(!1))),t(gc,e(Ti)),t(Pt(!0),e(Pt(!1))),t(Wt(!0),e(Wt(!1))),t(ht(!0),e(ht(!1))),t(Rt(!0),e(Rt(!1)))}}),nc=Z({key:"fieldIsFiltered",get:({path:e,modal:t})=>({get:n})=>{const s={path:e,modal:t};if(n(Ir(e)))return n(Pr(s));if(n(Xr(e)))return n(jr(s));if(n(Jr(e)))return n(qr(s));if(e.startsWith("_label_tags."))return n(bc({modal:t,key:"label"})).has(e.slice("_label_tags.".length));if(e.startsWith("tags."))return n(bc({modal:t,key:"sample"})).has(e.slice("tags.".length));const a=`${e=`${e}${ec(n(Ki)[e])}`}.confidence`,l=`${e}.label`,i=`${e}.value`,c=!!t&&n(io(e.split(".")[0])).length>0;return n(jr(r(o({},s),{path:a,defaultRange:[0,1]})))||n(qr(r(o({},s),{path:l})))||n(jr(r(o({},s),{path:i})))||c}}),sc=Z({key:"isLabelField",get:e=>({get:t})=>t(Vi("sample")).concat(t(Vi("frame")).map((e=>"frames."+e))).includes(e)}),ac=T({key:"unsupportedFields",get:({get:e})=>e(Gi).filter((t=>!(t.startsWith("frames.")||e(sc(t))||e(Xr(t))||e(Jr(t))||e(Ir(t))||["metadata","tags"].includes(t)||e(Di("sample")).includes(t))))}),lc=b({key:"activeFields",default:Fi}),ic=b({key:"activeModalFields",default:[]}),oc=Z({key:"activeLabels",get:({modal:e,frames:t})=>({get:n})=>{const s=n(Fi);return n(e?ic:lc).filter((e=>s.includes(e))).filter((e=>t?e.startsWith("frames."):!e.startsWith("frames.")))},set:({modal:e,frames:t})=>({get:n,set:s},a)=>{if(Array.isArray(a)){let l=n(e?ic:lc).filter((e=>!(n(sc(e))&&(t?e.startsWith("frames."):!e.startsWith("frames.")))||a.includes(e)));a.length&&(l=[a[0],...l.filter((e=>e!==a[0]))]),s(e?ic:lc,l)}}}),rc=Z({key:"activeLabelPaths",get:e=>({get:t})=>[...t(oc({modal:e,frames:!1})),...t(oc({modal:e,frames:!0}))]}),cc=Z({key:"activeScalars",get:e=>({get:t})=>{const n=t(Di("sample"));return t(e?ic:lc).filter((e=>n.includes(e)))},set:e=>({get:t,set:n},s)=>{if(e)return[];if(Array.isArray(s)){const a=t(Di("sample")),l=t(cc(e));let i=t(e?ic:lc).filter((e=>!a.includes(e)||s.includes(e)));s.length&&l.length<s.length&&(i=[s[0],...i.filter((e=>e!==s[0]))]),n(e?ic:lc,i)}}}),dc=Z({key:"activeTags",get:e=>({get:t})=>t(e?ic:lc).filter((e=>e.startsWith("tags."))).map((e=>e.slice(5))),set:e=>({get:t,set:n},s)=>{if(Array.isArray(s)){const a=s.map((e=>"tags."+e)),l=t(dc(e));let i=t(e?ic:lc).filter((e=>!e.startsWith("tags.")||a.includes(e)));a.length&&l.length<a.length&&(i=[a[0],...i.filter((e=>e!==a[0]))]),n(e?ic:lc,i)}}}),mc=Z({key:"activeLabelTags",get:e=>({get:t})=>t(e?ic:lc).filter((e=>e.startsWith("_label_tags."))).map((e=>e.slice("_label_tags.".length))),set:e=>({get:t,set:n},s)=>{if(Array.isArray(s)){const a=s.map((e=>"_label_tags."+e)),l=t(mc(e));let i=t(e?ic:lc).filter((e=>!e.startsWith("_label_tags.")||a.includes(e)));a.length&&l.length<a.length&&(i=[a[0],...i.filter((e=>e!==a[0]))]),n(e?ic:lc,i)}}}),uc=[!1,!0,null],hc=["False","True","None"],pc=e=>uc.includes(e)?[hc[uc.indexOf(e)],!0]:"number"==typeof e?[e.toLocaleString(),!0]:"string"!=typeof e||e.length?Array.isArray(e)?[`[${e.map((e=>pc(e)[0])).join(", ")}]`,!1]:[e,!1]:['""',!0],gc=b({key:"modalFilterStages",default:{}}),fc=Z({key:"hasFilters",get:e=>({get:t})=>Object.keys(t(e?gc:Ti)).length>0}),bc=Z({key:"matchedTags",get:({key:e,modal:t})=>({get:n})=>{const s=n(t?gc:Ti).tags;return s&&s[e]?new Set(s[e]):new Set},set:({key:e,modal:t})=>({get:n,set:s},a)=>{const l=o({},n(t?gc:Ti)),i=o({},l.tags||{});a instanceof Set&&a.size?i[e]=Array.from(a):l.tags&&e in l.tags&&delete i[e],l.tags=i,0===Object.keys(l.tags).length&&delete l.tags,s(t?gc:Ti,l)}}),yc=Z({key:"filterStage",get:({path:e,modal:t})=>({get:n})=>{var s,a;return null!=(a=null==(s=n(t?gc:Ti))?void 0:s[e])?a:{}},set:({path:e,modal:t})=>({get:n,set:s},a)=>{const l=Object.assign({},n(t?gc:Ti));null===a?delete l[e]:l[e]=a,s(t?gc:Ti,l)}}),vc=T({key:"modalStatsRaw",get:async({get:e})=>{const t=x();return(await Wn({type:"modal_statistics",uuid:t,args:{sample_id:e(ut).sample._id}})).stats}}),xc=T({key:"modalStats",get:({get:e})=>e(vc)}),wc=T({key:"modalExtendedStatsRaw",get:async({get:e})=>{const t=x();return(await Wn({type:"modal_statistics",uuid:t,args:{sample_id:e(ut).sample._id,filters:e(gc)}})).stats}}),kc=T({key:"extendedModalStats",get:({get:e})=>e(wc)}),Ec=(e,t=!1)=>{let n=null,s=null;const a=e.reduce(((e,a)=>(null===a.name&&(n=a.result),"frames"===a.name&&t&&(s=a.result),e[a.name]||(e[a.name]={}),e[a.name][a._CLS]=a.result,e)),{}),l={};for(let i in a){if(t&&i.startsWith("frames.")){i=i.slice("frames.".length);let e=i.includes(".")?i.split(".").slice(0,-1).join("."):i;const t=i;i="frames."+i,e="frames."+e,i===e?l[i]=s-a[i][Bt]:t.includes(".")&&a[e]&&a[i]&&(l[i]=a[e][Bt]-a[i][Bt]);continue}let e=i.includes(".")?i.split(".").slice(0,-1).join("."):i;i===e?l[i]=n-a[i][Bt]:i.includes(".")&&a[e]&&a[i]&&(l[i]=a[e][Bt]-a[i][Bt])}return l},Sc=Z({key:"noneFieldCounts",get:e=>({get:t})=>{const n=t(e?vc:xt),s=t(xi),a=t(wi);return n.view&&Xn(n.view,a)?Ec(n.stats,s):{}}}),Lc=Z({key:"noneFilteredFieldCounts",get:e=>({get:t})=>{const n=t(e?wc:wt),s=t(xi),a=t(wi);if(!n.view)return{};if(!Xn(n.view,a))return{};const l=t(e?gc:Ti);return Si(n.filters,l)?0===Object.entries(l).length?Sc(e):Ec(n.stats,s):{}}}),Tc=Z({key:"noneCount",get:({path:e,modal:t})=>({get:n})=>n(Sc(t))[e]}),Zc=Z({key:"labelTagCounts",get:e=>({get:t})=>{const n=t(e?xc:ki),s=t(Pi),a={};return n&&n.forEach((e=>{s.includes(e.name)&&Object.entries(e.result).forEach((([e,t])=>{e in a?a[e]+=t:a[e]=t}))})),a}}),Cc=Z({key:"filteredLabelTagCounts",get:e=>({get:t})=>{const n=t(e?kc:Li),s=t(Pi),a={};return n&&n.forEach((e=>{s.includes(e.name)&&Object.entries(e.result).forEach((([e,t])=>{e in a?a[e]+=t:a[e]=t}))})),a}}),Pc=Z({key:"sampleTagCounts",get:e=>({get:t})=>{const n=t(e?xc:ki);return n?n.reduce(((e,t)=>"tags"===t.name&&t._CLS===Jt?Object.fromEntries(t.result[1]):e),{}):{}}}),Rc=Z({key:"filteredSampleTagCounts",get:e=>({get:t})=>{const n=t(e?kc:Li);return n?n.reduce(((e,t)=>"tags"===t.name&&t._CLS===Jt?Object.fromEntries(t.result[1]):e),{}):{}}}),Ic=(e,t,n,s,a)=>{if(!n.name)return;const l=n.name.slice(t.length).split(".")[0];let i=n.name;if(a&&Dt.includes(a[t+l]))i=t+`${l}.${Ut[a[t+l]]}`;else if(a&&n.name!==t+l)return;e.includes(l)&&i===n.name&&n._CLS===Bt&&(s[t+l]=n.result)},Wc=Z({key:"labelCounts",get:({key:e,modal:t})=>({get:n})=>{const s=n(Vi(e)),a="sample"===e?"":"frames.",l=n(t?xc:ki),i=n(Ki);return null===l?null:l.reduce(((e,t)=>(Ic(s,a,t,e,i),e)),{})}}),Mc=Z({key:"filteredLabelCounts",get:({key:e,modal:t})=>({get:n})=>{const s=n(Vi(e)),a="sample"===e?"":"frames.",l=n(t?kc:Li),i=n(Ki);return null===l?null:l.reduce(((e,t)=>(Ic(s,a,t,e,i),e)),{})}}),Xc=Z({key:"scalarCounts",get:e=>({get:t})=>{if(e)return t(ut).sample;const n=t(Di("sample")),s=t(ki);return null===s?null:s.reduce(((e,t)=>(Ic(n,"",t,e),e)),{})}}),Nc=Z({key:"filteredScalarCounts",get:e=>({get:t})=>{if(e)return null;const n=t(Di("sample")),s=t(Li);return null===s?null:s.reduce(((e,t)=>(Ic(n,"",t,e),e)),{})}}),Gc=Z({key:"categoricalFieldCounts",get:({filtered:e,path:t,modal:n})=>({get:s})=>{const a=s(e?Lc(n):Sc(n))[t],l=s(Di("sample"));if(n&&l.includes(t)){const e=s(ut).sample[t];if(!Array.isArray(e))return{count:0,results:[]};return{count:e.length,results:Array.from(e.reduce(((e,t)=>(e.has(t)||e.set(t,0),e.set(t,e.get(t)+1),e)),new Map).entries())}}const i=s(n?e?kc:xc:e?Li:ki);if(!i&&e)return null;const o=(null!=i?i:[]).reduce(((e,n)=>n.name===t&&n._CLS===Jt?{count:n.result[0],results:n.result[1]}:e),{count:0,results:[]});return a&&a>0&&(o.count=o.count+1,o.results=[...o.results,[null,a]]),o}}),Yc=Z({key:"categoricalFieldSubCountsValues",get:({path:e,modal:t,value:n})=>({get:s})=>{if(!s(fc(t)))return null;const a=s(Gc({path:e,modal:t,filtered:!0}));if(!a)return null;const l=a.results.filter((([e])=>e===n));return l.length?l[0][1]:0}}),Vc=Z({key:"labelCount",get:e=>({get:t})=>{const n=t(fc(e))?Mc:Wc;let s=0,a=t(n({modal:e,key:"sample"}));return a&&t(oc({modal:e,frames:!1})).forEach((e=>{e in a&&(s+=a[e])})),a=t(n({modal:e,key:"frame"})),a&&t(oc({modal:e,frames:!0})).forEach((e=>{e in a&&(s+=a[e])})),s}}),Fc=Z({key:"tagNames",get:e=>({get:t})=>{var n;return(null!=(n=t(e?xc:ki))?n:[]).reduce(((e,t)=>"tags"===t.name&&t._CLS===Jt?t.result[1].map((([e])=>e)).sort():e),[])}}),Kc=Z({key:"labelTagNames",get:e=>({get:t})=>{var n;const s=t(Pi),a=new Set;return(null!=(n=t(e?xc:ki))?n:[]).forEach((e=>{s.includes(e.name)&&Object.keys(e.result).forEach((e=>a.add(e)))})),Array.from(a).sort()}}),Oc=({current:e,get:t,modal:n,paths:s,set:a})=>{const l=n?gc:Ti,i=o({},t(l));e.forEach((e=>{s.includes(e)||delete i[e]})),a(l,i)},zc=Z({key:"filteredScalars",get:e=>({get:t})=>{const n=t(Di("sample"));let s=[];return n.forEach((n=>{t(Ir(n))?t(Pr({modal:e,path:n}))&&s.push(n):t(Xr(n))?t(jr({modal:e,path:n}))&&s.push(n):t(Jr(n))&&t(qr({modal:e,path:n}))&&s.push(n)})),s},set:e=>({get:t,set:n},s)=>{const a=t(zc(e));let l=[];Array.isArray(s)&&(l=s),Oc({get:t,set:n,modal:e,paths:l,current:a})}}),Dc=Z({key:"numFilteredScalars",get:e=>({get:t})=>t(zc(e)).length}),Hc=Z({key:"filteredLabels",get:e=>({get:t})=>{const n=t(Vi("sample"));let s=[];return n.forEach((n=>{t(nc({modal:e,path:n}))&&s.push(n)})),s},set:e=>({get:t,set:n},s)=>{const a=t(Hc(e));let l=[];Array.isArray(s)&&(l=s),Jc({get:t,set:n,modal:e,paths:l,current:a})}}),Uc=Z({key:"numFilteredScalars",get:e=>({get:t})=>t(Hc(e)).length}),jc=Z({key:"filteredFrameLabels",get:e=>({get:t})=>{const n=t(Vi("frame"));let s=[];return n.forEach((n=>{t(nc({modal:e,path:"frames."+n}))&&s.push("frames."+n)})),s},set:e=>({get:t,set:n},s)=>{const a=t(jc(e));let l=[];Array.isArray(s)&&(l=s),Jc({get:t,set:n,modal:e,paths:l,current:a})}}),Bc=Z({key:"numFilteredFrameLabels",get:e=>({get:t})=>t(jc(e)).length}),Jc=({get:e,set:t,modal:n,paths:s,current:a})=>{const l=t=>t.reduce(((t,n)=>[...t,`${n=`${n}${ec(e(Ki)[n])}`}.confidence`,`${n}.label`]),[]);a=l(a),s=l(s),Oc({get:e,set:t,current:a,modal:n,paths:s})},Ac=e=>{const[t,{height:n}]=q(),s=M({height:e?n:0,from:{height:0},config:{duration:0}});return[t,r(o({},s),{overflow:"hidden"})]},_c=d.div`
  border-bottom: 1px solid ${({theme:e})=>e.background};
  display: flex;
  margin: 0 -0.5rem;
  padding: 0 0.5rem;
`,Qc=m(d.div`
  flex-basis: 0;
  flex-grow: 1;
  font-size: 1rem;
  padding-left: 0.4rem;
  line-height: 2;
  font-weight: bold;
  border-bottom-color: ${({theme:e})=>e.brand};
  border-bottom-style: solid;
  border-bottom-width: 2px;
  text-transform: capitalize;
`),$c=(e,t=null,n=null)=>{const[s,a]=u.exports.useState(!1),l=xo(),i="boolean"==typeof t?t&&!e:s&&!e,c=M({backgroundColor:i?l.backgroundLight:l.backgroundDark,color:n||(i?l.font:l.fontDark)});return{style:r(o({},c),{cursor:e?"default":"pointer"}),onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1)}};Z({key:"numTaggable",get:({modal:e,labels:t})=>({get:n})=>t?0:e?1:0});const qc=T({key:"tagAggs",get:async({get:e})=>{const t=e(Zc(!1)),n=e(Pc(!1));return t&&n?{label:Object.keys(t).sort(),sample:Object.keys(n).sort()}:null}}),ed=Z({key:"tagStatistics",get:({modal:e,labels:t})=>async({get:n})=>{n(St),n(Lt);const s=n(rc(!1)),a=x(),{count:l,tags:i}=await Wn({type:"tag_statistics",uuid:a,args:{active_labels:s,sample_id:e?n(ut).sample._id:null,filters:n(e?gc:Ti),labels:t}});return{count:l,tags:i}}}),td=T({key:"numLabelsInSelectedSamples",get:({get:e})=>e(ed({modal:!1,labels:!0})).count}),nd=Z({key:"tagStats",get:({modal:e,labels:t})=>({get:n})=>{const s=n(qc),a=s?Object.fromEntries(s[t?"label":"sample"].map((e=>[e,0]))):null;return a?o(o({},a),n(ed({modal:e,labels:t})).tags):null}}),sd=m(d.a`
  cursor: pointer;
  margin: 0 -0.5rem;
  padding: 0.25rem 0.5rem;
  font-weight: bold;
  display: flex;
  justify-content: center;
  align-content: center;
  flex-direction: column;
  text-decoration: none;
  color: ${({theme:e})=>e.fontDark};

  & > span {
    display: flex;
    justify-content: space-between;
  }
`),ad=d.div`
  margin: 0 -0.5rem 0 -0.5rem;
`,ld=m(d(sd)`
  display: flex;
  justify-content: space-between;
  flex-direction: row;
  flex-wrap: nowrap;
  margin: 0;
`),id=d.div`
  text-overflow: ellipsis;
  font-weight: bold;
  flex-grow: 1;
  max-width: 100%;
  overflow: hidden;
  white-space: nowrap;
  display: flex;
  justify-content: space-between;
`,od=({subCountAtom:e,count:t,text:n,color:s})=>{const a=((e=null,t=null)=>void 0===e||null===t?"":"number"==typeof e&&e!==t?`${e.toLocaleString()} of ${t.toLocaleString()}`:t.toLocaleString())(e?P(e):null,t),l=P(Ni);return g.createElement(id,null,g.createElement("span",{style:s?{color:s}:{}},mn(n&&"DateTime"===n._cls?gn(n.datetime,l):n,28-a.length,"middle")),t&&g.createElement("span",null,a))},rd=g.memo((({color:e,name:t,value:n,setValue:s,subCountAtom:a,count:l,disabled:i,forceColor:c})=>{const d=xo();e=null!=e?e:d.brand;const m=$c(i),[h,p]=pc(t);return g.createElement(ad,{title:h},g.createElement(ld,r(o({},m),{onClick:()=>s(!n)}),!i&&g.createElement(ee,{checked:n,title:h,style:{color:e,padding:"0 0.5rem 0 0"},onChange:e=>{e.preventDefault(),e.stopPropagation(),s(!n)},disableRipple:!0}),g.createElement(u.exports.Suspense,{fallback:g.createElement(od,{count:l,color:p?e:null,text:h})},g.createElement(od,{color:p||c?e:null,count:l,subCountAtom:a,text:h}))))})),cd=d.div`
  font-size: 14px;
  border-bottom: 1px ${({theme:e})=>e.brand} solid;
  position: relative;
  margin: 0.5rem 0;
`,dd=d.input`
  background-color: transparent;
  border: none;
  color: ${({theme:e})=>e.font};
  height: 2rem;
  font-size: 14px;
  border: none;
  align-items: center;
  font-weight: bold;
  width: 100%;

  &:focus {
    border: none;
    outline: none;
    font-weight: bold;
  }

  &::placeholder {
    color: ${({theme:e})=>e.fontDark};
    font-weight: bold;
  }
`,md=g.memo((({color:e=null,placeholder:t,validator:n=(()=>!0),setter:s,value:a,disabled:l=!1,onEnter:i,onFocus:o,onBlur:r,onKeyDown:c})=>{const d=xo();return e=null!=e?e:d.brand,g.createElement(cd,{style:{borderBottom:`1px solid ${e}`}},g.createElement(dd,{placeholder:t,value:null===a?"":String(a),onChange:e=>{n(e.currentTarget.value)&&s(e.currentTarget.value)},onKeyPress:e=>{"Enter"===e.key&&i&&i()},onKeyDown:e=>{"Escape"===e.key&&e.currentTarget.blur(),c&&c(e)},style:l?{color:d.fontDark}:{},disabled:l,onFocus:e=>{o()},onBlur:r}))})),ud=d.div`
  background-color: ${({theme:e})=>e.backgroundDark};
  border: 1px solid ${({theme:e})=>e.backgroundDarkBorder};
  border-radius: 2px;
  box-shadow: 0 2px 20px ${({theme:e})=>e.backgroundDark};
  box-sizing: border-box;
  margin-top: 0;
  position: absolute;
  width: auto;
  z-index: 801;
  padding: 0 0.5rem;
  width: calc(100% - 12px);
  left: 6px;
  margin-bottom: 1rem;
`,hd=d(sd)`
  white-space: nowrap;
  overflow: hidden;
  display: flex;
  text-overflow: ellipsis;
  margin: 0;
  justify-content: space-between;
  flex-direction: row;
`,pd=d.div`
  margin-left: -0.5rem;
  margin-right: -0.5rem;
  max-height: 330px;
  overflow-y: scroll;
  scrollbar-width: none;
  &::-webkit-scrollbar {
    width: 0px;
    background: transparent;
    display: none;
  }
  &::-webkit-scrollbar-thumb {
    width: 0px;
    display: none;
  }
`,gd=g.memo((({active:e,highlight:t,result:[n,s],onClick:a,maxLen:l,color:i})=>{const c=$c(!1,e||null,null===n?t:null),d=u.exports.useRef(),m=u.exports.useRef(!1),[h,p]=pc(n);return u.exports.useEffect((()=>{e&&d.current&&!m.current?(d.current.scrollIntoView(!0),m.current=!0):e||(m.current=!1)}),[e]),g.createElement(hd,r(o({title:null===n?"None":n},c),{onClick:a,ref:d}),g.createElement("span",{style:p?{color:i}:{}},l?mn(h,l,"middle"):h),"number"==typeof s&&g.createElement("span",null,s.toLocaleString()))})),fd=g.memo((({color:e,onSelect:t,results:n,highlight:s,active:a})=>g.createElement(pd,null,n.map((n=>g.createElement(gd,{key:String(n[0]),result:n,highlight:s,onClick:()=>t(n[0]),active:a===n[0],maxLen:26-n[1].toLocaleString().length,color:e})))))),bd=g.memo((({excludeAtom:e,valueName:t,color:n})=>{const[s,a]=H(e);return g.createElement(dr,{active:s?"Exclude":"Select",color:n,options:[{text:"Select",title:`Select ${t}`,onClick:()=>s&&a(!1)},{text:"Exclude",title:`Exclude ${t}`,onClick:()=>!s&&a(!0)}]})})),yd=d.div`
  background: ${({theme:e})=>e.backgroundDark};
  border: 1px solid #191c1f;
  border-radius: 2px;
  color: ${({theme:e})=>e.fontDark};
  margin-top: 0.25rem;
  padding: 0.25rem 0.5rem;
`,vd=d.div`
  padding-bottom: 0.5rem;
  margin: 3px;
  font-weight: bold;
`,xd=d.div`
  display: flex;
  justify-content: space-between;
`,wd=({color:e,results:t,totalCount:n,selectedValuesAtom:s,excludeAtom:a,valueName:l,modal:i,path:o,disableItems:r,selectedCounts:c})=>{const[d,m]=s?H(s):[[],null],u=new Set(d),h=a?ne(a):null,p=P(ht(i)),f=Object.fromEntries(t);let b=d.map((e=>{var t;return[e,null!=(t=f[String(e)])?t:0]}));const y=i&&P(Ai("sample"))[o]===qt;return(n<=20||r)&&(b=[...b,...t.filter((([e])=>r||!u.has(e)))]),0===n?g.createElement(g.Fragment,null,g.createElement(rd,{key:"No results",color:e,value:!1,disabled:!0,name:"No results",setValue:()=>{}})):(b=[...new Set(b)],g.createElement(g.Fragment,null,b.sort((({count:e,asc:t})=>(n,s)=>{let a=[...n],l=[...s];e&&(a.reverse(),l.reverse());let i=0;for(let e=0;e<a.length;e++)if(i=hn(a[e],l[e],t),0!==i)return i;return i})(p)).map((([t,n])=>g.createElement(rd,{key:String(t),color:e,value:u.has(t),disabled:i&&1===b.length||r,name:t,count:y?null:c.current.has(t)?c.current.get(t):n,subCountAtom:Yc({path:o,modal:i,value:t}),setValue:e=>{r||(e?u.add(t):u.delete(t),m([...u].sort()))}}))),Boolean(u.size)&&!r&&g.createElement(g.Fragment,null,n>3&&a&&g.createElement(bd,{excludeAtom:a,valueName:l,color:e}),g.createElement(lm,{text:"Reset",color:e,onClick:()=>{m([]),h(!1)},style:{margin:"0.25rem -0.5rem",height:"2rem",borderRadius:0,textAlign:"center"}}))))},kd=({results:e,color:t,shown:n,onSelect:s,onMouseEnter:a,onMouseLeave:l,subCount:i,active:o})=>{const r=xo();return g.createElement(g.Fragment,null,n&&e&&g.createElement(ud,{onMouseEnter:a,onMouseLeave:l},e&&g.createElement(fd,{color:t,active:o,onSelect:s,results:e,highlight:t}),g.createElement(or,null),g.createElement(sd,{style:{cursor:"default",textAlign:"right",color:r.font}},e&&null!==i&&e.length>0&&g.createElement(g.Fragment,null,e.length!==i&&g.createElement(g.Fragment,null,e.length," of"),i.toLocaleString()," results"),e&&0===e.length&&g.createElement(g.Fragment,null,"No results"))))},Ed=()=>{const e=u.exports.useRef();return te((({snapshot:t})=>async({modal:n,path:s,search:a,selectedValuesAtom:l,setSearchResults:i,setSubCount:r,setActive:c,noneCount:d})=>{const m=x(),u=setTimeout((()=>i(null)),200),h=await t.getPromise(ht(n));let p=null;n&&(p=(await t.getPromise(ut)).sampleId);const g=await t.getPromise(l),f=new Promise((e=>{const t=(n=({count:n,results:s})=>{Rn.removeEventListener("message",t),e({count:n,results:s})},({data:e})=>{(e=JSON.parse(e)).uuid===m&&n(e)});var n;Rn.addEventListener("message",t),Rn.send(In("count_values",o({path:s,search:a,selected:g,limit:200,uuid:m,sample_id:p},h)))}));e.current=f,f.then((({count:t,results:n})=>{clearTimeout(u),e.current===f&&(d>0&&(n=[...n,[null,d]]),n.length&&c(n[0][0]),i(n),r(t))}))}),[])},Sd=g.memo(g.forwardRef((({name:e,valueName:t,color:n,selectedValuesAtom:s,excludeAtom:a,countsAtom:l,path:i,modal:o,disableItems:r},c)=>{const d=s?P(s):[null,null],{count:m,results:h}=P(l),[p,f]=u.exports.useState(!1),[b,y]=u.exports.useState(!1),[v,x]=u.exports.useState(""),[w,k]=u.exports.useState(void 0),[E,S]=u.exports.useState(null),[L,T]=u.exports.useState(null),Z=u.exports.useRef(new Map),C=((e,t,n)=>te((({snapshot:s,set:a})=>async(l,i)=>{const o=new Set(await s.getPromise(e));t.current.set(l,i),o.add(l),a(e,[...o].sort()),n.forEach((e=>e()))})))(s,Z,[()=>T(null),()=>x(""),()=>k(void 0)]),R=h.filter((([e,t])=>null===e)),I=R.length?R[0][1]:0,W=Ed();u.exports.useLayoutEffect((()=>{p&&W({modal:o,path:i,search:v,selectedValuesAtom:s,setSearchResults:T,setSubCount:S,setActive:k,noneCount:I})}),[p,v,d,I]);const M=(e,t)=>{const n=e.map((e=>e[0])).indexOf(t);return e[n][1]};return g.createElement(vd,{ref:c},g.createElement(xd,null,e&&g.createElement(g.Fragment,null,e)),g.createElement(yd,null,m>20&&!r&&g.createElement(g.Fragment,null,g.createElement(md,{key:"input",color:n,setter:e=>{x(e),k(void 0)},value:v,onKeyDown:e=>{if(null!==L)if("ArrowDown"===e.key)if(void 0===w)k(L[0]);else{const e=L.map((e=>e[0])).indexOf(w);e<L.length-1&&k(L[e+1][0])}else if("ArrowUp"===e.key){const e=L.map((e=>e[0])).indexOf(w);e>0&&k(L[e-1][0])}},onEnter:()=>{void 0!==w&&C(w,M(L,w)),h&&h.map((([e])=>e)).includes(v)&&C(v,M(L,w))},placeholder:null===h?"Loading...":`+ filter by ${t}`,onFocus:()=>{h.length&&k(h[0][0]),f(!0)},onBlur:()=>!b&&f(!1)}),g.createElement(kd,{key:"results",results:L,color:n,shown:p||b,onSelect:e=>{C(e,M(L,e)),y(!1),f(!1)},active:w,subCount:E,onMouseEnter:()=>y(!0),onMouseLeave:()=>y(!1)})),g.createElement(wd,{path:i,color:n,name:e,results:h,selectedValuesAtom:s,excludeAtom:a,valueName:t,modal:o,totalCount:m,disableItems:r,selectedCounts:Z})))}))),Ld=d.div`
  font-weight: bold;
  display: flex;
  padding: 1.5rem 0 0.5rem;
  line-height: 1.9rem;
`,Td=d(se)`
  && {
    color: ${({theme:e})=>e.brand};
    margin: 0 1.5rem 0 1.3rem;
    height: 3px;
  }

  .rail {
    height: 7px;
    border-radius: 6px;
  }

  .track {
    height: 7px;
    border-radius: 6px;
    background: ${({theme:e})=>e.brand};
  }

  .thumb {
    height: 1rem;
    width: 1rem;
    border-radius: 0.5rem;
    background: ${({theme:e})=>e.brand};
    box-shadow: none;
    color: transparent;
  }

  .thumb:hover,
  .thumb:focus,
  .thumb.active {
    box-shadow: none;
  }

  .valueLabel {
    width: auto;
    margin-top: 0.5rem;
    font-weight: bold;
    font-family: "Palanquin", sans-serif;
    font-size: 14px;
    padding: 0.2rem;
    border-radius: 6rem;
    color: transparent;
    transform: none !important;
    margin-top: -4px;
  }

  .valueLabel > span > span {
    text-align: center;
    color: ${({theme:e})=>e.font};
    background: ${({theme:e})=>e.backgroundDark};
    border: 1px solid ${({theme:e})=>e.backgroundDarkBorder};
  }
`,Zd=g.memo((({boundsAtom:e,color:t,fieldType:n,onChange:s,onCommit:a,persistValue:l=!0,showBounds:i=!0,value:c,style:d,showValue:m=!0})=>{const h=xo(),p=P(e),f=n&&Wr(n)?P(Ni):null,[b,y]=u.exports.useState(!1);if(!p.every((e=>null!==e)))return null;const v=((e,t)=>{let n=(e[1]-e[0])/100;return[en,$t,qt].includes(t)?Math.ceil(n):n})(p,n),{formatter:x,hasTitle:w}=((e,t,n)=>{let s,a=!1;const l=[_t,At].includes(e);return l&&(s=fn(t,n[0],n[1]),a=null!==s[0]),{hasTitle:a,formatter:t=>{if(l){const e=s[1].format(t).split(",");if(1===e.length){const t=e[0].split("-");if(3===t.length){const[e,n,s]=t;return g.createElement("div",null,e,"",n,"",s)}return e[0]}let[n,a]=e;if(3===s[1].resolvedOptions().fractionalSecondDigits)return a+="ms",g.createElement(g.Fragment,null,g.createElement("div",null,n),g.createElement("div",null,a));const[l,i,o]=n.split("/");return g.createElement(g.Fragment,null,g.createElement("div",null,l,"",i,"",o),a&&g.createElement("div",null,a))}return ae(t).format([en,$t,qt].includes(e)?"0a":"0.00a")}}})(n,n===At?"UTC":f,p);return g.createElement(g.Fragment,null,w?g.createElement(g.Fragment,null,g.createElement("div",{style:{width:"100%",textAlign:"center",padding:"0.25rem",color:h.font}},fn(f,p[0],p[1])[0].format(p[0]).replaceAll("/","-"))):null,g.createElement(Ld,{style:d},i&&x(p[0]),g.createElement(Td,{onMouseDown:()=>y(!0),onMouseUp:()=>y(!1),value:c,onChange:s,onChangeCommitted:(e,t)=>{a(e,t),y(!1)},classes:{thumb:"thumb",track:"track",rail:"rail",active:"active",valueLabel:"valueLabel"},valueLabelFormat:x,"aria-labelledby":"slider",valueLabelDisplay:(b||l)&&m?"on":"off",max:p[1],min:p[0],step:v,theme:r(o({},h),{brand:t})}),i&&x(p[1])))})),Cd=e=>{var t=e,{valueAtom:n,onChange:s}=t,a=c(t,["valueAtom","onChange"]);const[l,i]=H(n),[d,m]=u.exports.useState(null);return u.exports.useEffect((()=>{JSON.stringify(l)!==JSON.stringify(d)&&m(l)}),[l]),g.createElement(Zd,r(o({},a),{onChange:(e,t)=>s?i(t):m(t),onCommit:(e,t)=>i(t),value:d}))},Pd=e=>{var t=e,{valueAtom:n}=t,s=c(t,["valueAtom"]);const[a,l]=H(n),[i,d]=u.exports.useState([null,null]);return u.exports.useEffect((()=>{JSON.stringify(a)!==JSON.stringify(i)&&d(a)}),[a]),g.createElement(Zd,r(o({},s),{onChange:(e,t)=>d(t),onCommit:(e,t)=>l(t),value:[...i]}))},Rd=d.div`
  padding-bottom: 0.5rem;
  margin: 3px;
  font-weight: bold;
`,Id=d.div`
  display: flex;
  justify-content: space-between;
`,Wd=d.div`
  background: ${({theme:e})=>e.backgroundDark};
  border: 1px solid #191c1f;
  border-radius: 2px;
  color: ${({theme:e})=>e.fontDark};
  margin-top: 0.25rem;
  padding: 0.25rem 0.5rem 0 0.5rem;
`,Md={nan:"nan",ninf:"-inf",inf:"inf",none:null},Xd=g.memo(g.forwardRef(((e,t)=>{var n=e,{color:s,name:a,fieldType:l}=n,i=c(n,["color","name","fieldType"]);const d=ne(yc({modal:i.modal,path:i.path})),m=P(Fr(i)),u=P(Br(i)),h=m.every((e=>null!==e)),p=P(zr({modal:i.modal,path:i.path})),f=(e=>{var t=e,{fieldType:n,otherCounts:s}=t,a=c(t,["fieldType","otherCounts"]);const[l,i]=H(Or(r(o({},a),{key:"none"})));return(n!==Qt?[["none",[l,i]]]:[["inf",H(Or(r(o({},a),{key:"inf"})))],["ninf",H(Or(r(o({},a),{key:"ninf"})))],["nan",H(Or(r(o({},a),{key:"nan"})))],["none",[l,i]]]).filter((([e])=>s[e]>0))})(r(o({},i),{fieldType:l,otherCounts:p})),b=P(jr(i));return h||1!==f.length||"none"!==f[0][0]?g.createElement(Rd,{ref:t},a&&g.createElement(Id,null,a),g.createElement(Wd,null,h&&g.createElement(Pd,r(o({},i),{showBounds:!1,fieldType:l,valueAtom:Kr(i),boundsAtom:Fr(i),color:s})),(u||f.some((([e,[t]])=>t!==f[0][1][0])))&&f.map((([e,[t,n]])=>g.createElement(rd,{color:s,name:Md[e],value:t,setValue:n,count:p[e],subCountAtom:Hr({key:e,modal:i.modal,path:i.path}),forceColor:!0}))),b&&f.length>0&&h&&g.createElement(bd,{excludeAtom:Ur(i),valueName:"",color:s}),b&&g.createElement(lm,{text:"Reset",color:s,onClick:()=>d(null),style:{margin:"0.25rem -0.5rem",height:"2rem",borderRadius:0,textAlign:"center"}}))):null})));var Nd=g.memo((({expanded:e,entry:t,modal:n,fieldType:s})=>{const[a,l]=Ac(e);if(!s){const e=P(oo(t.path)),n=P(ro(t.path));s=e===sn?n:e}return g.createElement(m.div,{style:l},n?g.createElement(Sd,{valueName:t.path,color:t.color,countsAtom:Gc({modal:n,path:t.path,filtered:!1}),path:t.path,modal:n,disableItems:t.disableList,ref:a}):g.createElement(Xd,{color:t.color,modal:n,path:t.path,fieldType:s,ref:a}))}));const Gd=d.div`
  display: flex;
  justify-content: space-between;
  margin: 3px;

  a {
    cursor: pointer;
    text-decoration: underline;
  }
`,Yd=({entry:e})=>{const t=P(io(e.name)).length,n=te((({snapshot:t,set:n})=>async()=>{const s=await t.getPromise(io(e.name)),a=await t.getPromise(Tt);n(Tt,Object.fromEntries(Object.entries(a).filter((([e])=>!s.includes(e)))))}),[e.name]);return t<1?null:g.createElement(Gd,null,"Hidden: ",t,g.createElement("a",{onClick:n},"reset"))};var Vd=g.memo((({expanded:e,entry:t,modal:n})=>{const[s,a]=Ac(e),l=`${t.path}${ec(t.labelType)}`,i=`${l}.confidence`,r=`${l}.label`,c=`${l}.support`,d=`${l}.value`;return g.createElement(m.div,{style:o({},a)},g.createElement("div",{ref:s},g.createElement("div",{style:{margin:3}},n&&g.createElement(Yd,{entry:t}),"Regression"!==t.labelType&&g.createElement(Sd,{color:t.color,name:"Labels",valueName:"label",selectedValuesAtom:Qr({modal:n,path:r}),countsAtom:Gc({modal:n,path:r,filtered:!1}),excludeAtom:$r({modal:n,path:r}),modal:n,path:r}),Ot.includes(t.labelType)&&g.createElement(Xd,{modal:n,color:t.color,name:"Confidence",path:i,defaultRange:[0,1],fieldType:Qt}),"Regression"===t.labelType&&g.createElement(Xd,{color:t.color,name:"Value",path:d,modal:n,fieldType:Qt}),zt.includes(t.labelType)&&g.createElement(Xd,{modal:n,color:t.color,name:"Support",path:c,fieldType:qt}))))}));var Fd=g.memo((({expanded:e,entry:t,modal:n})=>{const[s,a]=Ac(e);return g.createElement(m.div,{style:a},g.createElement(Sd,{valueName:t.path,color:t.color,selectedValuesAtom:Qr({modal:n,path:t.path}),excludeAtom:$r({modal:n,path:t.path}),countsAtom:Gc({modal:n,path:t.path,filtered:!1}),path:t.path,modal:n,disableItems:t.disableList,ref:s}))}));var Kd=g.memo((({expanded:e,entry:t,modal:n})=>{const[s,a]=Ac(e);return g.createElement(m.div,{style:a},g.createElement(Sd,{valueName:t.path,color:t.color,selectedValuesAtom:Rr({path:t.path,modal:n}),countsAtom:Gc({path:t.path,modal:n,filtered:!1}),disableItems:t.disableList,path:t.path,modal:n,ref:s}))}));const Od=d.div`
  vertical-align: middle;
  font-weight: bold;
  overflow: visible;

  & > div {
    margin-top: 3px;
    margin-left: 0;
    margin-right: 0;
    border-radius: 2px;
  }

  label {
    margin: 0;
    width: 100%;
    height: 32px;
    display: flex;
    justify-content: space-between;

    .MuiTypography-body1 {
      flex: 1;
      font-size: unset;
      align-items: center;
      padding-right: 3px;
      max-width: 100%;
    }

    .MuiTypography-body1.with-checkbox {
      max-width: calc(100% - 36px);
    }
    overflow: "hidden", .MuiCheckbox-root {
      padding: 0;

      .MuiIconButton-label {
        position: relative;
        svg {
          z-index: 2;
        }
      }
    }

    .MuiFormControlLabel-label {
      display: flex;
      font-weight: bold;
      color: unset;
      line-height: 29px;
      height: 29px;
      justify-content; space-between;
      max-width: 100%;

      span {
        white-space: nowrap;
      }

      span.name {
        display: block;
        padding: 0 4px;
        overflow: hidden;
        text-overflow: ellipsis;
        flex-grow: 1;
        max-width: 100%;
        line-height: 29px;
        height: 29px;
        align-items: center;
        vertical-align: middle;
      }
      span.count {
        display: block;
        height: 29px;
        line-height: 29px;
        vertical-align: middle;
        max-width: 100%;
      }

      span.data {
        display: block;
        margin-left: 0.5em;
        line-height: 29px;
        display: flex;
        vertical-align: middle;
        align-items: center;
      }
    }
  }

  && .Mui-disabled {
    cursor: not-allowed;
    color: ${({theme:e})=>e.fontDarkest};

    svg,
    input[type="checkbox"] {
      display: none;
    }
  }

  && .no-checkbox {
    cursor: default;
  }
`,zd=m(d.div`
  position: relative;
  overflow: visible;
`),Dd=({count:e,subCountAtom:t,value:n,title:s,path:a,hasDropdown:l,expanded:i,setExpanded:o})=>{const r=xo(),c=t?P(t):null,d=c?c[a]:null,m=i?oe:re;return n||"string"==typeof n?g.createElement("span",{className:"count",title:s,style:{marginRight:4}},un(n)):"number"!=typeof e?g.createElement(ie,{style:{color:r.font,height:16,width:16,minWidth:16}}):g.createElement(g.Fragment,null,g.createElement("span",{className:"count",title:s},"number"==typeof d&&d!==e?`${d.toLocaleString()} of ${e.toLocaleString()}`:e.toLocaleString()),l&&e>0&&g.createElement(m,{onClick:e=>{e.preventDefault(),o(!i)},style:{marginRight:-4,cursor:"pointer"}}))},Hd=g.memo((({entry:e,onCheck:t,modal:n})=>{let{disabled:s,color:a,hasDropdown:l,hideCheckbox:i,name:c,path:d,selected:m,title:h,canFilter:p,type:f,count:b,subCountAtom:y,value:v,icon:x,key:w}=e;const[k,E]=u.exports.useState(!1),S=xo(),L=P(Ir(d)),T=P(Xr(d)),Z=P(Jr(d)),C=P(nc({path:d,modal:n}))&&p&&!((T||L||Z)&&n),R=P(Nr(d));l=l&&(!R||!n);const I=i?"no-checkbox":"with-checkbox",W=M({backgroundColor:C?"#6C757D":S.backgroundLight});return g.createElement(zd,{style:W},g.createElement(le,{disabled:s,label:g.createElement(g.Fragment,null,g.createElement("span",{className:"name",title:c,style:{marginLeft:i?4:0}},c),g.createElement(u.exports.Suspense,{fallback:g.createElement(Dd,{path:w||d,value:v,count:b,title:h,hasDropdown:l,expanded:k,setExpanded:E})},g.createElement(Dd,{path:w||d,value:v,subCountAtom:y,count:b,title:h,hasDropdown:l,expanded:k,setExpanded:E})),x||null),classes:{root:I,label:I},style:{width:"100%",color:m||i?S.font:e.disabled?S.fontDarkest:S.fontDark},control:g.createElement(ee,{disableRipple:!0,checked:m,title:`Show ${c} ${f}`,onClick:()=>t(r(o({},e),{selected:!e.selected})),onMouseDown:null,style:{display:i?"none":"block",color:m||i?a:s?S.fontDarkest:S.fontDark}})}),T&&g.createElement(Nd,{expanded:k,entry:e,modal:n}),Z&&g.createElement(Fd,{expanded:k,entry:e,modal:n}),L&&g.createElement(Kd,{expanded:k,entry:e,modal:n}),e.labelType&&(X=e.labelType,Kt.includes(X))?g.createElement(Vd,{expanded:k,entry:e,modal:n}):null);var X})),Ud=g.memo((({entries:e,onCheck:t,modal:n,sort:s=!0})=>{const a=(e=>{const{count:t,asc:n}=P(ht(e));return e=>e.sort(((e,s)=>{let a=[e.name,e.count],l=[s.name,s.count];t&&(a.reverse(),l.reverse());let i=0;for(let t=0;t<a.length;t++)if(i=hn(a[t],l[t],n),0!==i)return i;return i}))})(n);return s&&(e=a(e)),g.createElement(Od,null,e.map((e=>g.createElement(Hd,{key:e.name,entry:e,onCheck:t,modal:n}))))})),jd=d.div`
  .MuiCheckbox-root {
    padding: 4px 8px 4px 4px;
  }

  ${ur.Body} {
    display: flex;
    align-items: center;
    color: ${({theme:e})=>e.fontDark};

    span {
    }

    .label {
      text-transform: uppercase;
      flex-grow: 1;
      display: flex;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .icon {
      margin-left: 2px;
    }
  }

  .left-icon {
    margin-right: 4px;
  }
`,Bd=g.memo((({label:e,icon:t,entries:n,handleClear:s,onSelect:a,title:l,modal:i,children:o,pills:r=[],sort:c})=>{const[d,m]=u.exports.useState(!0),h=n.filter((e=>e.selected)).length,p=xo();return g.createElement(Er,{label:g.createElement(g.Fragment,null,t?g.createElement("span",{className:"left-icon"},t):null,g.createElement("span",{className:"label"},e),h?g.createElement(lr,{onClick:s,highlight:!1,open:!1,icon:g.createElement(ce,null),title:"Clear displayed",text:ae(h).format("0,0"),style:{height:"1.5rem",fontSize:"0.8rem",lineHeight:"1rem",color:p.font}}):null,r),title:l,expanded:d,onExpand:m},n.length?g.createElement(Ud,{entries:n,onCheck:a,modal:i,sort:c}):g.createElement("span",null,"No ",l.toLocaleLowerCase()),o)})),Jd=(e,t,n,s,a)=>{const l=e.has(t)?n.font:n.fontDark;return g.createElement("span",{title:`Only show ${a?"labels":"samples"} with the "${t}" tag ${e.size?"or other selected tags":""}`,onClick:s,style:{cursor:"pointer",height:20,width:20,marginLeft:8}},g.createElement(me,{style:{color:l,height:20,width:20}}))},Ad=(e,t,n)=>t.size?[g.createElement(lr,{key:"clear-match",highlight:!1,icon:g.createElement(me,null),text:ae(t.size).format("0,0"),onClick:e=>{e.stopPropagation(),e.preventDefault(),n(new Set)},title:"Clear matching",open:!1,style:{marginLeft:"0.25rem",height:"1.5rem",fontSize:"0.8rem",lineHeight:"1rem",color:e}})]:[],_d=({modal:e})=>{const{tags:t,activeTags:n,setActiveTags:s,matchedTags:a,setMatchedTags:l}=(e=>{const t=P(Fc(!1)),n=P(Fc(e)),[s,a]=H(dc(e)),[l,i]=H(bc({modal:e,key:"sample"}));return u.exports.useEffect((()=>{const e=new Set;l.forEach((t=>{n.includes(t)&&e.add(t)})),e.size!==l.size&&i(e)}),[l,t]),{tags:n,activeTags:s,setActiveTags:a,matchedTags:l,setMatchedTags:i}})(e),i=P($i(e)),[o,r]=[Rc(e),P(Pc(e))],{singular:c}=P(hi),d=xo();return g.createElement(Bd,{label:`${c} tags`,icon:g.createElement(de,null),pills:!e&&Ad(d.font,a,l),entries:t.filter((e=>r[e])).map((t=>{const s=i("tags."+t);return{name:t,disabled:!1,hideCheckbox:e,hasDropdown:!1,selected:n.includes(t),color:s,title:t,canFilter:!e,path:`tags.${t}`,key:t,type:"tags",count:e?null:r[t],value:e?r[t]>0?g.createElement(ce,{style:{marginTop:3,color:s}}):g.createElement(f,{style:{marginTop:3,color:s}}):null,subCountAtom:o,icon:e?null:Jd(a,t,d,(e=>{e.stopPropagation(),e.preventDefault();const n=new Set(a);a.has(t)?n.delete(t):n.add(t),l(n)}),!1),modal:e}})),onSelect:({name:t,selected:a})=>!e&&s(a?[t,...n]:n.filter((e=>e!==t))),handleClear:e=>{e.stopPropagation(),s([])},modal:e,title:`${c} tags`})},Qd=({modal:e})=>{const t=P($i(e)),[n,s]=[Cc(e),P(Zc(e))],{tags:a,activeTags:l,setActiveTags:i,matchedTags:o,setMatchedTags:r}=((e,t)=>{const n=P(Kc(!1));let s=P(Kc(e));const[a,l]=H(mc(e)),[i,o]=H(bc({modal:e,key:"label"}));return u.exports.useEffect((()=>{const e=new Set;i.forEach((t=>{s.includes(t)&&e.add(t)})),e.size!==i.size&&o(e)}),[i,n]),!e&&(s=s.filter((e=>t[e]))),{tags:s,activeTags:a,setActiveTags:l,matchedTags:i,setMatchedTags:o}})(e,s),c=xo();return g.createElement(Bd,{label:"Label tags",icon:g.createElement(ue,null),pills:Ad(c.font,o,r),entries:a.map((a=>{const i=t("_label_tags."+a);return{canFilter:!0,name:a,disabled:!1,hideCheckbox:e,hasDropdown:!1,selected:l.includes(a),color:i,title:a,type:"label tags",path:"_label_tags."+a,key:a,modal:e,count:s[a]||0,subCountAtom:n,icon:Jd(o,a,c,(e=>{e.stopPropagation(),e.preventDefault();const t=new Set(o);o.has(a)?t.delete(a):t.add(a),r(t)}),!0)}})),onSelect:({name:t,selected:n})=>{!e&&i(n?[t,...l]:l.filter((e=>e!==t)))},handleClear:e=>{e.stopPropagation(),i([])},modal:e,title:"Label tags"})},$d=({modal:e,frames:t})=>{const n=t?"frame":"sample",s=P(Vi(n)),[a,l]=H(oc({modal:e,frames:t})),i=P(xi),o=P(Ki),r=P($i(e)),[c,d]=[Mc({key:n,modal:e}),P(Wc({key:n,modal:e}))],m=P(Pt(e)),u=xo();return g.createElement(Bd,{label:t?"Frame labels":"Labels",icon:t?g.createElement(he,null):i?g.createElement(pe,null):g.createElement(ge,null),pills:qd(t?Bc(e):Uc(e),t?jc(e):Hc(e)),sort:!1,entries:s.map((n=>{const s=t?"frames."+n:n;return{name:n,disabled:!1,hideCheckbox:!1,hasDropdown:Kt.includes(o[s]),selected:a.includes(s),color:m?u.brand:r(s),title:n,path:s,type:"labels",modal:e,count:d?d[s]:null,subCountAtom:c,labelType:o[s],canFilter:!0}})),onSelect:({name:e,selected:n})=>{t&&(e="frames."+e),l(n?[e,...a]:a.filter((t=>t!==e)))},handleClear:e=>{e.stopPropagation(),l([])},modal:e,title:t?"Frame label fields":"Label fields"})},qd=(e,t)=>{const n=xo(),s=te((({set:e})=>async()=>{e(t,[])}),[t]),a=P(e);return a>0?[g.createElement(lr,{key:"clear-match",highlight:!1,icon:g.createElement(fe,null),text:ae(a).format("0,0"),onClick:e=>{e.stopPropagation(),e.preventDefault(),s()},title:"Clear filters",open:!1,style:{marginLeft:"0.25rem",height:"1.5rem",fontSize:"0.8rem",lineHeight:"1rem",color:n.font}})]:null},em=({modal:e})=>{const t=P(Di("sample")),[n,s]=H(cc(e)),a=P(Pt(e)),l=xo(),i=P(_i("sample")),o=P($i(e)),[r,c]=[Nc(e),P(Xc(e))],d=P(Ji("sample")),m=P(Ni),u=P(Ui("sample")),h=[_t,At];return g.createElement(Bd,{label:"Other fields",icon:g.createElement(be,null),pills:e?null:qd(Dc(e),zc(e)),sort:!1,entries:t.filter((t=>!(["filepath","id"].includes(t)&&e))).map((t=>{let s=e?c[i[t]]:null;return s&&(h.includes(d[t])||h.includes(u[t]))&&(s=gn(s.datetime,d[t]===At||u[t]===_t?"UTC":m)),{name:t,disabled:!1,hideCheckbox:e,hasDropdown:!e||Array.isArray(s),selected:n.includes(t),color:a?l.brand:o(t),title:!e||Array.isArray(s)&&d[t]!==qt?t:un(s,!1),value:!e||Array.isArray(s)&&d[t]!==qt?null:un(s,!1),path:t,count:null===c?null:e&&Array.isArray(s)&&d[t]!==qt?s.length:c[t],type:"values",modal:e,subCountAtom:r,disableList:e,canFilter:!e||Array.isArray(s)}})),onSelect:e?null:({name:e,selected:t})=>{s(t?[e,...n]:n.filter((t=>t!==e)))},handleClear:e=>{e.stopPropagation(),s([])},modal:e,title:"Other fields"})},tm=({modal:e})=>{const t=P(ac);return t.length?g.createElement(Bd,{label:"Unsupported fields",icon:g.createElement(ye,null),entries:t.map((e=>({name:e,path:e,title:e,data:null,disabled:!0,hideCheckbox:!0,selected:!1}))),title:"Unsupported fields",modal:e}):null},nm=m(d.div`
  cursor: pointer;
  margin-left: 0;
  margin-right: 0;
  padding: 2.5px 0.5rem;
  border-radius: 3px;
  display: flex;
  justify-content: space-between;
  margin-top: 3px;
`),sm=m(d.div`
  padding-right: 0.25rem;
  display: flex;
  justify-content: center;
  align-content: center;
  flex-direction: column;
  color: inherit;
  line-height: 1.7;
  & > span {
    white-space: nowrap;
    text-overflow: ellipsis;
    overflow: hidden;
  }
`),am=({style:e,children:t})=>g.createElement(sm,{style:e},g.createElement("span",null,t)),lm=({onClick:e,text:t,children:n=null,style:s,color:a=null,title:l=null})=>{const i=xo(),[c,d]=u.exports.useState(!1);a=null!=a?a:i.brand;const m=M({backgroundColor:c?a:i.background,color:c?i.font:i.fontDark,config:{duration:150}});return g.createElement(nm,{style:o(r(o({},m),{userSelect:"none"}),s),onClick:e,onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),title:null!=l?l:t},g.createElement(am,{style:{fontWeight:"bold",width:"100%"}},t),n)},im=g.forwardRef((({modal:e,style:t},n)=>{const s="video"===P(vi),a=e?{height:"auto",overflow:"unset"}:{};return g.createElement(jd,{ref:n,style:o(o({},t),a)},g.createElement(_d,{modal:e}),g.createElement(Qd,{modal:e}),g.createElement($d,{modal:e,frames:!1}),s&&g.createElement($d,{modal:e,frames:!0}),g.createElement(em,{modal:e}),g.createElement(tm,{modal:e}))}));var om=g.memo((({modal:e,children:t,style:n={},bounds:s})=>{const a=M({opacity:1,from:{opacity:0},config:{duration:100}}),{width:l}=yo(),i=e&&s?{position:"fixed",right:l-s.right,top:s.bottom+8}:{};return g.createElement(ir,{style:o(o(o({},a),i),n)},t)}));const rm=({modal:e})=>{const[t,n]=H(Wt(Boolean(e)));return g.createElement(g.Fragment,null,g.createElement(lm,{text:g.createElement("span",{style:{display:"flex",justifyContent:"center"}},"Refresh colors"," ",g.createElement(ve,{style:{marginLeft:"0.25rem",color:"inherit"}})),title:"Refresh colors",onClick:()=>n(t+1),style:{margin:"0.25rem -0.5rem",height:"2rem",borderRadius:0,textAlign:"center"}}))},cm=({modal:e})=>{const[t,n]=H(Pt(e));return g.createElement(g.Fragment,null,g.createElement(or,null,"Color by"),g.createElement(dr,{active:t?"value":"field",options:[{text:"field",title:"Color by field",onClick:()=>t&&n(!1)},{text:"value",title:"Color by value",onClick:()=>!t&&n(!0)}]}))},dm=({modal:e})=>{const t=xo(),[n,s]=H(Rt(e));return g.createElement(g.Fragment,null,g.createElement(or,{style:{display:"flex",height:33}},g.createElement("span",null,"Label opacity"),.7!==n&&g.createElement("span",{onClick:()=>s(.7),style:{cursor:"pointer",margin:"0.25rem"},title:"Reset label opacity"},g.createElement(xe,null))),g.createElement(Cd,{valueAtom:Rt(e),boundsAtom:we([0,1]),color:t.brand,showBounds:!1,persistValue:!1,showValue:!1,onChange:!0,style:{padding:0},int:!1}))},mm=({modal:e})=>{const[{count:t,asc:n},s]=H(ht(e));return g.createElement(g.Fragment,null,g.createElement(or,null,"Sort sidebar contents by"),g.createElement(dr,{active:t?"count":"value",options:[{text:"count",title:"Sort by count",onClick:()=>!t&&s({count:!0,asc:n})},{text:"value",title:"Sort by value",onClick:()=>t&&s({count:!1,asc:n})}]}),g.createElement(rd,{name:"Reverse",value:!n,setValue:e=>s({count:t,asc:!e})}))},um=({modal:e})=>{const t=P(gi),[n,s]=H(pt(e));return t?g.createElement(g.Fragment,null,g.createElement(or,null,"Patches"),g.createElement(rd,{name:"Crop to patch",value:n,setValue:e=>s(e)})):null};var hm=g.memo((({modal:e,bounds:t})=>g.createElement(om,{modal:e,bounds:t},g.createElement(cm,{modal:e}),g.createElement(rm,{modal:e}),g.createElement(dm,{modal:e}),g.createElement(mm,{modal:e}),g.createElement(um,{modal:e}))));const pm=g.memo((({onClick:e,text:t,href:n,title:s,disabled:a=!1,hidden:l=!1,style:i,svgStyles:d={height:"1rem",marginTop:4.5}})=>{const m=$c(a),{style:u}=m,h=c(m,["style"]);return e=n?Io(n):e,l?null:g.createElement(sd,r(o({title:s||t,onClick:a?null:e},h),{style:null!=i?i:u,href:n,target:n?"_blank":null}),g.createElement("span",{style:n?{textDecoration:"underline"}:{}},t,n&&g.createElement(ke,{style:d})))})),gm=b({key:"patching",default:!1}),fm=T({key:"patchesFields",get:({get:e})=>{const t=e(Fi),n=e(Ki);return t.filter((e=>Gt.includes(n[e])))}}),bm=T({key:"clipsFields",get:({get:e})=>{const t=e(Fi),n=e(Ki),s=e(ji("sample"));return[...t.filter((e=>e.startsWith("frames.")?Vt.includes(n[e]):Yt.includes(n[e]))),...Object.entries(s).filter((([e,t])=>t.ftype===qt||t.subfield===qt)).map((([e])=>e))].sort()}}),ym=T({key:"evaluationKeys",get:({get:e})=>Object.keys(e(St).dataset.evaluations||{})}),vm=({close:e})=>{const t=P(bm),n=te((({set:e})=>async t=>{e(gm,!0),Rn.send(In("save_filters",{add_stages:[{_cls:"fiftyone.core.stages.ToClips",kwargs:[["field_or_expr",t],["_state",null]]}],with_selected:!0}))}),[]);return g.createElement(g.Fragment,null,t.map((t=>g.createElement(pm,{key:t,text:t,title:`Switch to clips view for the "${t}" field`,onClick:()=>{e(),n(t)}}))),g.createElement(pm,{key:0,text:"About clips views",title:"About clips views",href:"https://voxel51.com/docs/fiftyone/user_guide/app.html#viewing-video-clips"}))},xm=({close:e})=>{const t=P(fm),n=te((({set:e})=>async t=>{e(gm,!0),Rn.send(In("save_filters",{add_stages:[{_cls:"fiftyone.core.stages.ToPatches",kwargs:[["field",t],["_state",null]]}],with_selected:!0}))}),[]);return g.createElement(g.Fragment,null,t.map((t=>g.createElement(pm,{key:t,text:t,title:`Switch to patches view for the "${t}" field`,onClick:()=>{e(),n(t)}}))),g.createElement(pm,{key:0,text:"About patch views",title:"About patch views",href:"https://voxel51.com/docs/fiftyone/user_guide/app.html#viewing-object-patches"}))},wm=({close:e})=>{const t=P(ym),n=te((({set:e})=>async t=>{e(gm,!0),Rn.send(In("save_filters",{add_stages:[{_cls:"fiftyone.core.stages.ToEvaluationPatches",kwargs:[["eval_key",t],["_state",null]]}],with_selected:!0}))}),[]);return g.createElement(g.Fragment,null,t.map((t=>g.createElement(pm,{key:t,text:t,title:`Switch to evaluation patches view for the "${t}" evaluation`,onClick:()=>{e(),n(t)}}))),g.createElement(pm,{key:0,text:"About evaluation views",title:"About evaluation views",href:"https://voxel51.com/docs/fiftyone/user_guide/app.html#viewing-evaluation-patches"}))};var km=g.memo((({bounds:e,close:t})=>{const n=xo(),s=P(xi)&&P(li),a=P(pi),[l,i]=u.exports.useState(!0),o=M({borderBottomColor:l?n.brand:n.backgroundDark,cursor:l?"default":"pointer"}),r=M({borderBottomColor:l?n.backgroundDark:n.brand,cursor:l?"pointer":"default"});return g.createElement(om,{modal:!1,bounds:e},g.createElement(_c,null,g.createElement(Qc,{style:o,onClick:()=>!l&&i(!0)},"Labels"),!s&&g.createElement(Qc,{style:r,onClick:()=>l&&i(!1)},"Evaluations")),l&&(s||a)&&g.createElement(vm,{close:t}),l&&!s&&!a&&g.createElement(xm,{close:t}),!l&&g.createElement(wm,{close:t}))}));const Em=e=>Object.fromEntries(e.map((e=>{var t=e,{label_id:n}=t;return[n,c(t,["label_id"])]}))),Sm=(e,t)=>te((({snapshot:n,set:s})=>async()=>{const a=await n.getPromise(lo);t=e?await n.getPromise(e):t,s(lo,o(o({},a),Em(t)))})),Lm=(e,t)=>te((({snapshot:n,set:s})=>async()=>{const a=await n.getPromise(lo);t=e?await n.getPromise(e):t;const l=Object.entries(a).filter((([e])=>!t.has(e)));s(lo,Object.fromEntries(l))})),Tm=(e,t)=>te((({snapshot:n,set:s})=>async()=>{const a=await n.getPromise(so);t=e?await n.getPromise(e):t;const l=await n.getPromise(Tt);s(Tt,o(o({},l),Em(t.filter((({label_id:e})=>!a.has(e))))))})),Zm=(e,t)=>new Set([...e].filter((e=>!t.has(e)))).size>0,Cm=e=>new Set([...e].map((({label_id:e})=>e))),Pm=(e,t)=>{const n=P(so),s=e.current.getCurrentSampleLabels(),a=P(xi)&&P(li),l=e.current instanceof Al?e.current.getCurrentFrameLabels():new Array,i=e=>g.useCallback((()=>{t(),e()}),[]),r=P(hi),c=Zm(Cm(s),n),d=Zm(Cm(l),n),m=(u=n,h=Cm(s),new Set([...u].filter((e=>h.has(e)))).size>0);var u,h;return[{text:`Select visible (current ${r.singular})`,hidden:!c,onClick:i(Sm(null,s))},{text:`Unselect visible (current ${r.singular})`,hidden:!m,onClick:i(Lm(null,Cm(s)))},a&&{text:"Select visible (current frame)",hidden:!d,onClick:i(Sm(null,l))},a&&{text:"Unselect visible (current frame)",hidden:!m,onClick:i(Lm(null,Cm(l)))},{text:"Clear selection",hidden:!n.size,onClick:i(te((({set:e})=>async()=>e(lo,{}))))},{text:"Hide selected",hidden:!n.size,onClick:i(te((({snapshot:e,set:t})=>async()=>{const n=await e.getPromise(lo),s=await e.getPromise(Tt);t(lo,{}),t(Tt,o(o({},s),n))})))},{text:`Hide unselected (current ${r.singular})`,hidden:!c,onClick:i(Tm(null,s))},a&&{text:"Hide unselected (current frame)",hidden:!d,onClick:i(Tm(null,l))}].filter(Boolean)};var Rm=g.memo((({modal:e,close:t,lookerRef:n,bounds:s})=>{u.exports.useLayoutEffect((()=>{n&&n.current instanceof Al&&n.current.pause&&n.current.pause()}));const a=e?Pm(n,t):(e=>{const t=P(hi),n=te((({set:t})=>async()=>{t(Lt,new Set),Rn.send(In("clear_selection",{})),e()}),[e]),s=te((({snapshot:t})=>async n=>{e();const s=await t.getPromise(St),a=JSON.parse(JSON.stringify(s)),l=await t.getPromise(Lt),i=a.view||[];i.push({_cls:`fiftyone.core.stages.${n}`,kwargs:[["sample_ids",Array.from(l)]]}),a.view=i,a.selected=[],Rn.send(In("update",{state:a}))}));return[{text:`Clear selected ${t.plural}`,title:`Deselect all selected ${t.plural}`,onClick:n},{text:`Only show selected ${t.plural}`,title:`Hide all other ${t.plural}`,onClick:()=>s("Select")},{text:`Hide selected ${t.plural}`,title:`Show only unselected ${t.plural}`,onClick:()=>s("Exclude")}]})(t);return n&&uo(n.current,"play",t),g.createElement(om,{modal:e,bounds:s},a.map(((e,t)=>g.createElement(pm,r(o({},e),{key:t})))))}));const Im=m(d(sd)`
  display: flex;
  justify-content: space-between;
  flex-direction: row;
  margin: 0;
`),Wm=d.div`
  display: flex;
  justify-content: space-between;
  flex: 1;
  width: calc(100% - 33px);
`,Mm=d.span`
  display: block;
  white-space: nowrap;
`,Xm=({name:e,count:t,checkmark:n,onCheck:s,active:a,setActive:l,edited:i,disabled:o})=>{const r=xo(),{style:c,onMouseEnter:d,onMouseLeave:m}=$c(!1,a===e),h=u.exports.useRef();return g.createElement(Im,{onMouseEnter:()=>{l(e),d()},onMouseLeave:m,style:c,onClick:e=>!o&&!(e.target===h.current||h.current.contains(e.target))&&s()},g.createElement(ee,{disableRipple:!0,ref:h,indeterminate:null===n,disabled:o,onChange:()=>!o&&s(),checked:n===Nm.ADD||null===n,style:{color:i?r.brand:r.fontDark,padding:"0 0.5rem 0 0"}}),g.createElement(Wm,{title:e},g.createElement(Mm,{style:{flexGrow:1,maxWidth:"100%",paddingRight:"0.5rem",textOverflow:"ellipsis",overflow:"hidden"}},e),g.createElement(Mm,null,t>0?ae(t).format("0,0"):"0")))};var Nm,Gm;(Gm=Nm||(Nm={}))[Gm.ADD=0]="ADD",Gm[Gm.REMOVE=1]="REMOVE";const Ym=d.div`
  margin: 0 -0.5rem 0.25rem -0.5rem;
  max-height: 346px;
  overflow-y: auto;
  scrollbar-width: none;

  &::-webkit-scrollbar {
    width: 0px;
    background: transparent;
    display: none;
  }
  &::-webkit-scrollbar-thumb {
    width: 0px;
    display: none;
  }
`,Vm=({name:e,items:t,changes:n,count:s,setChange:a,value:l})=>()=>{a(e,e in t&&e in n?1===l||0===t[e]?null:1:e in t?s===t[e]?1:0:0===l?l in t?1:null:0)};var Fm=g.memo((({items:e,changes:t,setChange:n,count:s,active:a,setActive:l,disabled:i})=>{const c=Object.entries(o(o({},e),t)).sort((([e],[t])=>e<t?-1:1)),d=c.map((([e])=>e));var m;return m=i=>{if(0===d.length)return;let o=null;"ArrowDown"===i.key?o=null===a?0:d.indexOf(a)+1:"ArrowUp"===i.key&&(o=null===a?d.length-1:d.indexOf(a)-1),o<0?o=d.length-1:o>d.length-1&&(o=0),null!==o&&l(d[o]),"Enter"===i.key&&a.length&&Vm({name:a,changes:t,items:e,count:s,value:c.filter((([e])=>e===a))[0][1],setChange:n})()},uo(document.body,"keydown",m),g.createElement(Ym,{onMouseLeave:()=>l(null)},c.map((([c,d])=>{const m=Vm({name:c,value:d,items:e,changes:t,setChange:n,count:s}),u=0===t[c]?s:1===t[c]?null:e[c];return g.createElement(Xm,r(o({},{name:c,count:u,active:a,disabled:i}),{onCheck:m,checkmark:c in t?t[c]:s===e[c]?0:0===e[c]?1:null,edited:c in t,setActive:l,key:c}))})))}));const Km=d.div`
  position: absolute;
  top: 0.25rem;
  right: -0.75rem;
  height: 2rem;
  width: 2rem;

  & > svg {
    margin-top: 0.5rem;
    margin-right: 0.25rem;
    color: ${({theme:e})=>e.font};
  }
`,Om=g.memo((({loading:e})=>{const t=xo();return g.createElement(Km,null,e&&g.createElement(ie,{style:{color:t.font,height:16,width:16,marginTop:"0.25rem"}}))})),zm=d.div`
  font-size: 14px;
  border-bottom: 1px ${({theme:e})=>e.brand} solid;
  position: relative;
  margin: 0.5rem 0;
`,Dm=d.input`
  background-color: transparent;
  border: none;
  color: ${({theme:e})=>e.font};
  height: 2rem;
  font-size: 14px;
  border: none;
  align-items: center;
  font-weight: bold;
  width: 100%;

  &:focus {
    border: none;
    outline: none;
    font-weight: bold;
  }

  &::placeholder {
    color: ${({theme:e})=>e.fontDark};
    font-weight: bold;
  }
`,Hm=({countAndPlaceholder:e,submit:t,taggingAtom:n,itemsAtom:s,close:a,labels:l})=>{const i=P(s),c=P(hi),[d,m]=H(n),[h,p]=u.exports.useState(""),[f,b]=e(),y=d||"number"!=typeof f,[v,x]=u.exports.useState({}),[w,k]=u.exports.useState(null),[E,S]=u.exports.useState(!1);u.exports.useLayoutEffect((()=>{x({})}),[n]),u.exports.useLayoutEffect((()=>{d&&S(!0),!d&&E&&a()}),[d,E]);const L=e=>Object.fromEntries(Object.entries(e).filter((([e])=>e.toLowerCase().includes(h.toLowerCase()))));if(!i)return g.createElement(_m,null);const T=Object.keys(v).length>0,Z=h.length>0&&!(h in v||h in i);return g.createElement(g.Fragment,null,g.createElement(zm,null,g.createElement(Dm,{placeholder:0==f?`No ${l?"labels":c.plural}`:y?null===f?"loading...":"saving...":b,value:h,onChange:e=>{if(p(e.target.value),e.target.value.length){const t=Array.from(new Set(Object.keys(o(o({},i),v)))).sort().filter((t=>t.toLocaleLowerCase().includes(e.target.value.toLowerCase())));t.length&&k(t[0])}},title:Z?`Enter to add "${h}" tag to ${f} ${l&&f>1?"labels":l?"label":f>1?c.plural:c.singular}`:null,onKeyPress:e=>{"Enter"===e.key&&Z&&(p(""),x(r(o({},v),{[h]:Nm.ADD})))},focused:!y,disabled:y||0===f,autoFocus:!0,onBlur:({target:e})=>e.focus(),type:"text"}),g.createElement(Om,{loading:Boolean(d||"number"!=typeof f)})),f>0&&g.createElement(Fm,{active:w,disabled:y,items:L(i),changes:L(v),count:f,setActive:k,setChange:(e,t)=>{const n=o({},v);null===t?delete n[e]:n[e]=t,x(n)}}),y||!T&&!Z?null:g.createElement(g.Fragment,null,g.createElement(or,null),Z&&g.createElement(lm,{text:`Add "${h}" tag to ${f>1?ae(f).format("0,0")+" ":""}${l&&f>1?"labels":l?"label":f>1?c.plural:c.singular}`,onClick:()=>{p(""),x(r(o({},v),{[h]:Nm.ADD}))},style:{margin:"0.25rem -0.5rem",paddingLeft:"0.5rem",height:"2rem",borderRadius:0}}),T&&!h.length&&g.createElement(lm,{text:"Apply",onClick:()=>{return e=v,t({changes:Object.fromEntries(Object.entries(e).map((([e,t])=>[e,t===Nm.ADD])))}),void m(!0);var e},style:{margin:"0.25rem -0.5rem",height:"2rem",borderRadius:0,textAlign:"center"}})))},Um=(e,t,n,s)=>{if(0===n)return`no ${s.plural}`;const a=ae(t).format("0,0");return 0===t?"no labels":e?`+ tag ${t>1?`${a} `:""}selected label${t>1?"s":""}`:`+ tag ${a} label${t>1?"s":""}`},jm=(e,t)=>{if(e){const n=ae(t=e).format("0,0");return`+ tag ${t>1?`${n} `:""}selected label${1===t?"":"s"}`}const n=ae(t).format("0,0");return`+ tag ${t>1?`${n} `:""} label${1===t?"":"s"}`},Bm=(e,t,n,s)=>{if(0===n)return`no ${s.plural}`;if(e){const t=ae(n=e).format("0,0");return`+ tag ${n>1?`${t} `:""}selected ${1===n?s.singular:s.plural}`}const a=ae(n).format("0,0");return`+ tag ${n>1?`${a} `:""}${1===n?s.singular:s.plural}`},Jm=e=>`+ tag ${e.singular}`,Am=(e,t,n=null)=>te((({snapshot:s})=>async({changes:a})=>{const l=(await s.getPromise(rc(e))).filter((e=>!(e.startsWith("tags.")||e.startsWith("_label_tags."))));e?Rn.send((({labels:e,sample_id:t,changes:n,activeLabels:s,frameNumber:a=null})=>In("tag_modal",{changes:n,labels:e,sample_id:t,active_labels:s,frame_number:a}))({sample_id:(await s.getPromise(ut)).sample._id,changes:a,labels:t,activeLabels:l,frameNumber:n&&n.current?n.current.frameNumber:null})):Rn.send((({targetLabels:e,activeLabels:t,changes:n})=>In("tag",{target_labels:e,active_labels:t,changes:n}))({changes:a,targetLabels:t,activeLabels:l}))}),[e,t,n]),_m=()=>{const e=xo();return g.createElement("div",{style:{display:"flex",justifyContent:"center"}},g.createElement(ie,{style:{color:e.fontDark,margin:"1rem 0"}}))};var Qm=g.memo((({modal:e,bounds:t,close:n,lookerRef:s})=>{const[a,l]=u.exports.useState(e),i=P(hi),o=xo(),r=M({borderBottomColor:a?o.backgroundDark:o.brand,cursor:a?"pointer":"default"}),c=M({borderBottomColor:a?o.brand:o.backgroundDark,cursor:a?"default":"pointer"}),d=Am(e,a,s),m=((e,t,n)=>()=>{const s=P(e?so:Lt).size;if(e&&t){const t=s>0?s:P(Vc(e));return[t,jm(s,t)]}if(e)return[1,Jm(n)];{const a=P(Zi),l=P(Ci),i=null!=l?l:a,o=P(td),r=s?o:P(Vc(e));return t?[r,Um(s,r,i,n)]:[s>0?s:i,Bm(s,0,i,n)]}})(e,a,i);return g.createElement(om,{style:{width:"12rem"},modal:e,bounds:t},g.createElement(_c,null,g.createElement(Qc,{style:r,onClick:()=>a&&l(!1)},e?i.singular:i.plural),g.createElement(Qc,{style:c,onClick:()=>!a&&l(!0)},"Labels")),a&&g.createElement(u.exports.Suspense,{fallback:g.createElement(_m,null),key:"labels"},g.createElement(Hm,{countAndPlaceholder:m,submit:d,taggingAtom:Et({modal:e,labels:a}),itemsAtom:nd({modal:e,labels:a}),close:n,labels:!0})),!a&&g.createElement(u.exports.Suspense,{fallback:g.createElement(_m,null),key:i.plural},g.createElement(Hm,{countAndPlaceholder:m,submit:d,taggingAtom:Et({modal:e,labels:a}),itemsAtom:nd({modal:e,labels:a}),close:n,labels:!1})))}));const $m=d.div``,qm=m(d(sd)`
  display: flex;
  justify-content: space-between;
  flex-direction: row;
  margin: 0;
`),eu=d.div`
  text-overflow: ellipses;
  font-weight: bold;
  flex-grow: 1;
`,tu=g.memo((({color:e,currentValue:t,setValue:n,value:s})=>{const a=$c(!1);return g.createElement($m,null,g.createElement(qm,r(o({},a),{onClick:()=>n(s)}),g.createElement(Ee,{style:{color:e,padding:"0 0.5rem 0 0"},checked:s===t,disableRipple:!0}),g.createElement(eu,null,s)))})),nu=d.div`
  overflow: auto visible;
  max-height: 165px;
  margin: 0 -0.5rem;
  scrollbar-width: none;

  &::-webkit-scrollbar {
    width: 0px;
    background: transparent;
    display: none;
  }
  &::-webkit-scrollbar-thumb {
    width: 0px;
    display: none;
  }
`,su=g.memo((({choices:e,color:t=null,value:n,setValue:s})=>{const a=xo();return t=null!=t?t:a.brand,u.exports.useLayoutEffect((()=>{e.length>=1&&!n&&s(e[0])}),[n,e]),n?g.createElement(nu,null,e.map((e=>g.createElement(tu,{value:e,setValue:s,color:t,currentValue:n,key:e})))):null}));class au{constructor(e,t,n,s,a){this.attached=!1,this.section=document.createElement("div"),this.index=e,this.itemIndex=t,this.render=s,this.section.classList.add("_flashlightSection_1nu3i_103"),this.rows=n.map((({aspectRatio:e,extraMargins:t,items:n})=>[{aspectRatio:e,extraMargins:t},n.map((e=>{const t=document.createElement("div");return a&&t.addEventListener("click",(t=>{t.preventDefault(),a(t,e.id)})),this.section.appendChild(t),[t,e]}))]))}getItems(){return this.rows.map((([e,t])=>t.map((([e,t])=>t)))).flat()}set(e,t){if(this.top!==e&&(this.section.style.top=`${e}px`,this.top=e),this.width!==t){let e=0;this.rows.forEach((([{extraMargins:n,aspectRatio:s},a])=>{n=n||0;const l=(t-3*(a.length-1+n))/s;let i=0;a.forEach((([t,{aspectRatio:n}])=>{const s=l*n;t.style.height=`${l}px`,t.style.width=`${s}px`,t.style.left=`${i}px`,t.style.top=`${e}px`,i+=s+3})),e+=l+3})),this.width!==t&&(this.section.style.height=`${e}px`,this.section.style.width=`${t}px`),this.width=t,this.height=e}}getHeight(){return this.height}getBottom(){return this.top+this.height}getTop(){return this.top}hide(){this.attached&&(this.section.remove(),this.rows.forEach((([{aspectRatio:e,extraMargins:t},n])=>{!t&&(t=0);const s=(this.width-3*(n.length-1+t))/e;n.forEach((([e,{id:t,aspectRatio:n}])=>{const a=s*n;this.render(t,e,[a,s],!1,!0)}))})),this.attached=!1)}isShown(){return this.attached}show(e,t,n){t!==this.hidden&&(t?this.section.classList.add("_flashlightSectionHidden_1nu3i_116"):this.section.classList.remove("_flashlightSectionHidden_1nu3i_116"),this.hidden=t),this.attached||(e.appendChild(this.section),this.attached=!0),!this.hidden&&this.rows.forEach((([{aspectRatio:e,extraMargins:t},s])=>{!t&&(t=0);const a=(this.width-3*(s.length-1+t))/e;s.forEach((([e,{id:t,aspectRatio:s}])=>{const l=a*s;this.render(t,e,[l,a],n,!1)}))}))}resizeItems(e){this.rows.forEach((([{extraMargins:t,aspectRatio:n},s])=>{t=t||0;const a=(this.width-3*(s.length-1+t))/n;s.forEach((([t,{aspectRatio:n,id:s}])=>{e(s,[a*n,a])}))}))}}function lu(e,t,n){const s=[];let a=[],l=null;for(const o in e){const n=e[o];null!==l?l>=t?(s.push({items:a,aspectRatio:l}),a=[n],l=n.aspectRatio):(l+=n.aspectRatio,a.push(n)):(l=n.aspectRatio,a.push(n))}let i=[];return n?i=a:a.length&&s.push((({items:e},t)=>{const n=e.map((({aspectRatio:e})=>e));if(n.length&&1===new Set(n).size){let s=n[0],a=s,l=1;for(;s<t;)s+=a,l+=1;return{items:e,aspectRatio:s,extraMargins:l-e.length}}return{items:e,aspectRatio:Math.max(t,n.reduce(((e,t)=>e+t),0))}})({items:a,aspectRatio:l},t)),{rows:s,remainder:i}}class iu{constructor(e){this.loading=!1,this.ctx=0,this.config=e,this.container=this.createContainer(),this.showPixels(),this.element=document.createElement("div"),this.element.classList.add("_flashlight_1nu3i_45"),this.state=this.getEmptyState(e);let t=!1;document.addEventListener("visibilitychange",(()=>this.render())),this.resizeObserver=new ResizeObserver((([{contentRect:{width:e,height:n}}])=>{this.state.containerHeight=n,t?(e-=16,requestAnimationFrame((()=>{const t=this.state.width!==e&&this.state.onResize?this.state.onResize(e):{},n=this.state.width!==e;this.state.width=e,n?this.updateOptions(t,n):this.render(!1)}))):t=!0})),((e,t,n)=>{let s,a=!1,l=!1,i=0;e.addEventListener("scroll",(()=>{l=!0,o()&&!a&&t(a)}));const o=()=>{const o=n();return o!==1/0&&(i?(Math.abs(e.scrollTop-i)>o?(a=!0,void 0!==s&&(clearTimeout(s),s=void 0),s=setTimeout((function(){a=!1,s=void 0,t(!1)}),350)):void 0===s&&(l=!1),i=e.scrollTop):i=e.scrollTop,!0)},r=()=>{requestAnimationFrame(r),l&&o()&&a&&t(a)};r()})(this.element,(e=>this.render(e)),(()=>this.state.resizing?1/0:this.state.width/(this.state.containerHeight*this.state.options.rowAspectRatioThreshold)*500)),this.element.appendChild(this.container)}reset(){this.ctx++,this.loading=!1;const e=this.createContainer();this.container.replaceWith(e),this.container=e,this.state=this.getEmptyState(this.config),this.showPixels();const{width:t,height:n}=this.container.parentElement.getBoundingClientRect();this.state.width=t-16,this.state.containerHeight=n,this.get()}isAttached(){return Boolean(this.container.parentElement)}showPixels(){!this.pixelsSet&&this.container.classList.add("_flashlightPixels_1nu3i_99"),this.pixelsSet=!0}hidePixels(){this.pixelsSet&&this.container.classList.remove("_flashlightPixels_1nu3i_99"),this.pixelsSet=!1}attach(e){"string"==typeof e&&(e=document.getElementById(e));const{width:t,height:n}=e.getBoundingClientRect();this.state.width=t-16,this.state.containerHeight=n;const s=this.state.onResize?this.state.onResize(t):{};e.appendChild(this.element),this.resizeObserver.observe(e),this.updateOptions(s,!1),this.get()}updateOptions(e,t){const n=Object.entries(e).some((([e,t])=>this.state.options[e]!=t));if(this.state.options=o(o({},this.state.options),e),n&&this.state.sections.length){this.resetResize();const e=this.createContainer();this.container.replaceWith(e),this.container=e;const t=[...this.state.sections.map((e=>e.getItems())).flat(),...this.state.currentRowRemainder.map((({items:e})=>e)).flat()],n=this.state.activeSection,s=this.state.sections[n].itemIndex;let a=this.tile(t);const l=a[a.length-1];a.length&&Boolean(this.state.currentRequestKey)&&1!==l.length?(this.state.currentRowRemainder=l,a=a.slice(0,-1)):this.state.currentRowRemainder=[],this.state.height=0,this.state.sections=[],this.state.shownSections=new Set,this.state.clean=new Set,a.forEach(((e,t)=>{const n=new au(t,this.state.itemIndexMap[e[0].items[0].id],e,this.state.render,this.getOnItemClick());n.set(this.state.height,this.state.width),this.state.sections.push(n),this.state.height+=n.getHeight()})),e.style.height=`${this.state.height}px`;for(const i of this.state.sections)if(i.itemIndex>=s)return this.container.parentElement.scrollTop=i.getTop(),void this.render()}else if(t){this.resetResize(),this.state.sections.forEach((e=>{e.set(this.state.height,this.state.width),this.state.height+=e.getHeight()})),this.container.style.height=`${this.state.height}px`;const e=this.state.sections[this.state.activeSection];e&&(this.container.parentElement.scrollTop=e.getTop()),this.render()}}updateItems(e){this.state.clean=new Set,this.state.shownSections.forEach((t=>{this.state.sections[t].getItems().map((({id:e})=>e)).forEach((t=>e(t)))})),this.state.updater=e}get(){if(this.loading||null===this.state.currentRequestKey)return null;this.loading=!0;let e=this.ctx;return this.state.get(this.state.currentRequestKey).then((({items:t,nextRequestKey:n})=>{if(e!==this.ctx)return;this.state.currentRequestKey=n;for(const{id:e}of t)this.state.itemIndexMap[e]=this.state.nextItemIndex,this.state.nextItemIndex++;t=[...this.state.currentRemainder,...t];let s=this.tile(t,!0);const a=s[s.length-1];Boolean(n)&&a&&1!==a.length?(this.state.currentRowRemainder=a,s=s.slice(0,-1)):this.state.currentRowRemainder=[],s.forEach((e=>{const t=new au(this.state.sections.length,this.state.itemIndexMap[e[0].items[0].id],e,this.state.render,this.getOnItemClick());t.set(this.state.height,this.state.width),this.state.sections.push(t),this.state.height+=t.getHeight(),this.state.clean.add(t.index)})),s.length&&(this.container.style.height=`${this.state.height}px`);const l=this.state.sections[this.state.sections.length-1];this.state.currentRequestKey=n,this.loading=!1,(this.state.height<=this.state.containerHeight||!s.length&&n||l&&this.state.shownSections.has(l.index))&&this.requestMore(),(this.state.height>=this.state.containerHeight||null===n)&&(this.hidePixels(),this.render())}))}requestMore(){this.state.currentRequestKey&&this.get()}hideSection(e){const t=this.state.sections[e];t&&t.isShown()&&(t.hide(),this.state.shownSections.delete(t.index))}showSections(e){this.state.shownSections.forEach((t=>{const n=this.state.sections[t];if(!n)return;!this.state.resized||this.state.resized.has(n.index)||e||this.state.resizing||(this.state.onItemResize&&n.resizeItems(this.state.onItemResize),this.state.resized.add(n.index)),this.state.clean.has(n.index)||e||(this.state.updater&&n.getItems().map((({id:e})=>e)).forEach((e=>this.state.updater(e))),this.state.clean.add(n.index));const s=this.state.clean.has(n.index)||!this.state.updater;n.show(this.container,!s&&e||this.state.resizing,e),this.state.shownSections.add(n.index)}))}render(e=!1){if(0===this.state.sections.length&&null===this.state.currentRequestKey)return void this.hidePixels();const t=this.element.scrollTop,n=(s=this.state.sections.map((e=>Math.abs(e.getTop()-t)))).map(((e,t)=>[e,t])).reduce(((e,t)=>t[0]<e[0]?t:e),[s[0],0])[1];var s;this.state.firstSection=Math.max(n-2,0);let a=this.state.sections[this.state.firstSection],l=this.state.firstSection;for(;a&&a.getTop()<=t+this.state.containerHeight;)l=a.index+1,a=this.state.sections[l];this.state.lastSection=a?l:l-1,this.state.activeSection=this.state.firstSection;let i=this.state.sections[this.state.activeSection];if(!i)return;for(;i.getBottom()-3<=t&&this.state.sections[this.state.activeSection+1];)this.state.activeSection+=1,i=this.state.sections[this.state.activeSection];let o=this.state.firstSection;for(;o<=this.state.lastSection;)this.state.shownSections.add(o),o++;[...Array.from(this.state.shownSections)].forEach((e=>{(e<this.state.firstSection||e>this.state.lastSection)&&this.hideSection(e)})),this.showSections(e),this.state.lastSection===this.state.sections.length-1&&this.requestMore()}tile(e,t=!1){let{rows:n,remainder:s}=lu(e,this.state.options.rowAspectRatioThreshold,Boolean(this.state.currentRequestKey));return this.state.currentRemainder=s,t&&(n=[...this.state.currentRowRemainder,...n]),new Array(Math.ceil(n.length/1)).fill(0).map((e=>n.splice(0,1)))}getEmptyState(e){return r(o({currentRequestKey:e.initialRequestKey,containerHeight:null,width:null,height:0},e),{currentRemainder:[],currentRowRemainder:[],items:[],sections:[],activeSection:0,firstSection:0,lastSection:0,options:o({rowAspectRatioThreshold:5},e.options),clean:new Set,shownSections:new Set,onItemClick:e.onItemClick,onItemResize:e.onItemResize,onResize:e.onResize,itemIndexMap:{},nextItemIndex:0,resized:null,resizing:!1})}getOnItemClick(){return this.state.onItemClick?(e,t)=>this.state.onItemClick(e,t,o({},this.state.itemIndexMap)):null}createContainer(){const e=document.createElement("div");return e.classList.add("_flashlightContainer_1nu3i_78"),e.tabIndex=-1,e.addEventListener("mouseenter",(()=>e.focus())),e.removeEventListener("mouseleaver",(()=>e.blur())),e}resetResize(){this.state.resized=new Set,this.state.height=0,this.state.resizing=!0,this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout((()=>{this.state.resizing=!1,this.resizeTimeout=null,this.render()}),500)}}const ou=(e,t)=>`${Zn}/filepath/${encodeURIComponent(e)}?id=${t}`,ru=T({key:"lookerType",get:({get:e})=>{const t=e(fi),n=e(gi);return e=>{const s=e.startsWith("video/");return s&&(t||n)?Hl:s?Al:Ul}}}),cu=()=>te((({set:e,snapshot:t})=>async()=>{if(await t.getPromise(gt))return;const n=await t.getPromise(Xt);e(Xt,r(o({},n),{showJSON:!1})),e(ut,null),e(lo,{}),e(Tt,{})}),[]),du=b({key:"gridZoomRange",default:[0,10]});let mu=new Map,uu=new Map,hu=0,pu=new E({max:500,dispose:(e,t)=>t.destroy()});const gu=(()=>{window.location.origin;try{0}catch{}return`${Zn}/page?`})(),fu=d.div`
  width: 100%;
  height: 100%;
  display: block;
  position: relative;
`,bu=T({key:"flashlightOptions",get:({get:e})=>({rowAspectRatioThreshold:11-Math.max(e(Xi),e(du)[0])})}),yu=T({key:"flashlightLookerOptions",get:({get:e})=>({coloring:e(qi(!1)),filter:e(tc(!1)),activePaths:e(lc),zoom:e(gi)&&e(pt(!1)),loop:!0,inSelectionMode:e(Lt).size>0,fieldsMap:e(_i("sample")),frameFieldsMap:e(_i("frame")),timeZone:e(Ni),alpha:e(Rt(!1)),disabled:!1})}),vu=(xu=(e,t)=>t[0]<e[0]?t:e,e=>e.map(((e,t)=>[e,t])).reduce(xu)[1]);var xu;const wu=e=>{const t=cu();return te((({set:n,snapshot:s})=>async(a,l,i)=>{const c=i[l],d=Object.fromEntries(Object.entries(i).map((([e,t])=>[t,e])));let m=new Set(await s.getPromise(Lt));if(!m.size)return void(()=>{const s=a=>{var l;const i=uu.has(a)?Promise.resolve(mu.get(uu.get(a))):null==(l=e.current.get())?void 0:l.then((()=>uu.has(a)?mu.get(uu.get(a)):null));i?i.then((e=>{e?n(ut,r(o({},e),{index:a,getIndex:s})):t()})):t()};n(ut,r(o({},mu.get(l)),{index:c,getIndex:s})),n(tc(!0),{})})();const u=[...m];a.shiftKey&&!m.has(l)?(()=>{const e=i[u[vu(u.map((e=>Math.abs(i[e]-c))))]],[t,n]=c<e?[c,e]:[e,c],s=new Array(n-t+1).fill(0).map(((e,n)=>d[n+t]));m=new Set([...u,...s])})():a.shiftKey?(()=>{let e=c;for(;m.has(d[e]);)e--;e+=1;let t=c;for(;m.has(d[t]);)t++;t-=1;const[n,s]=c-e<=t-c?c-e==0?[c,t]:[e,c]:t-c==0?[e,c]:[c,t];m=new Set(u.filter((e=>i[e]<n||i[e]>s)))})():m.has(l)?m.delete(l):m.add(l),n(Lt,m),Rn.send(In("set_selection",{_ids:Array.from(m)}))}),[])};var ku=g.memo((()=>{const[e]=u.exports.useState((()=>x())),t=P(bu),n=P(yu),s=P(ru),a=u.exports.useRef(),l=P(Ri("sample")),i=P(pi);a.current=({sample:e,dimensions:t,frameNumber:a,frameRate:c})=>{const d=s(pn(e)),m=i?{support:e.support}:{};return new d(e,o({src:ou(e.filepath,e._id),thumbnail:!0,dimensions:t,sampleId:e._id,frameRate:c,frameNumber:d===Hl?a:null,fieldSchema:Object.fromEntries(l.map((e=>[e.name,e])))},m),r(o({},n),{selected:w.has(e._id)}))};const c=u.exports.useRef();c.current=({sample:e,dimensions:[t,s]})=>{const a=t/s;return n.zoom?((e,t)=>{let n=[];Object.entries(e).forEach((([e,t])=>{t&&t._cls in Xl&&(n=[...n,...Xl[t._cls](t)])}));let[s,a,l,i]=$n(n);return 0!==l&&0!==i||(l===i?(l=1,i=1):0===i?i=l:l=i),l/i*t})(e,a):a};const[d,m]=u.exports.useState(null),h=u.exports.useRef(),p=P(pt(!1)),f=P(Ti),b=P(si),y=P(wi),v=P(ei),w=P(Lt),k=wu(h),E=te((({set:e,snapshot:t})=>async n=>{const s=new Set(await t.getPromise(Lt));s.has(n)?s.delete(n):s.add(n),e(Lt,s),Rn.send(In("set_selection",{_ids:Array.from(s)}))}),[]),S=ne(du);(()=>{const e=te((({set:e,snapshot:t})=>async({samples:n})=>{n.forEach((e=>{mu.set(e._id,r(o({},mu.get(e._id)),{sample:e})),pu.has(e._id)&&pu.get(e._id).updateSample(e)})),e(ut,o({},await t.getPromise(ut))),e(ao,!1)}),[]);ho("samples_update",e)})();const L=u.exports.useRef(),T=P(Xi);var Z;if(L.current=T,uo(document,"keydown",te((({snapshot:e,set:t})=>async n=>{if("Escape"!==n.key)return;await e.getPromise(ut)||(t(Lt,new Set),Rn.send(In("set_selection",{_ids:[]})))}),[])),u.exports.useLayoutEffect((()=>{h.current&&h.current.isAttached()&&(mu=new Map,pu.reset(),Cs(),Rs(),uu=new Map,hu=0,h.current.reset())}),[h,(Z=f,"object"!=typeof Z||Array.isArray(Z)?Z:JSON.stringify(Object.keys(Z).map((e=>[e,Z[e]])).sort(((e,t)=>e[0]-t[0])))),b,Mn(y),v,p]),d)throw d;return u.exports.useLayoutEffect((()=>{h.current?(h.current.updateOptions(t),h.current.updateItems((e=>{const t=pu.get(e);t&&t.updateOptions(r(o({},n),{selected:w.has(e),inSelectionMode:w.size>0}))}))):(h.current=new iu({initialRequestKey:1,options:t,onItemClick:k,onResize:e=>{let t=7;e>=1200?t=0:e>=1e3?t=2:e>=800&&(t=4);const n=Math.max(t,L.current);return S([t,10]),{rowAspectRatioThreshold:11-n}},onItemResize:(e,t)=>{pu.has(e)&&pu.get(e).resize(t)},get:async e=>{try{const{results:t,more:n}=await fetch(`${gu}page=${e}`).then((e=>e.json())),s=t.map((e=>{const t={sample:e.sample,dimensions:[e.width,e.height],frameRate:e.frame_rate,frameNumber:e.sample.frame_number};return mu.set(e.sample._id,t),uu.set(hu,e.sample._id),hu++,t}));return{items:s.map((e=>({id:e.sample._id,aspectRatio:c.current(e)}))),nextRequestKey:n?e+1:null}}catch(t){m(t)}},render:(e,t,n,s,l)=>{try{const i=mu.get(e);if(pu.has(e)){const s=pu.get(e);return l?s.disable():s.attach(t,n),null}if(!s){const s=a.current(i);s.addEventListener("selectthumbnail",(({detail:e})=>E(e))),pu.set(e,s),s.attach(t,n)}return null}catch(i){m(i)}}}),h.current.attach(e))}),[e,t,n,w,L]),g.createElement(fu,{id:e})}));const Eu=b({key:"similaritySorting",default:!1}),Su=()=>te((({snapshot:e,set:t})=>async()=>{const n=await e.getPromise(Iu),s=await(async(e,t)=>{const n=await e.getPromise(so),s=await e.getPromise(lo),a=(await e.getPromise(co)).patches.filter((([e,n])=>e===t)).map((([e,t])=>t))[0];if(n.size)return[...n].filter((e=>s[e].field===a));const l=await e.getPromise(Lt),i=await e.getPromise(gi),o=await e.getPromise(ut);return i?l.size?[...l].map((e=>mu.get(e).sample[a]._id)):o.sample[a]._id:l.size?[...l]:o.sample._id})(e,n.brainKey);t(Eu,!0),t(ut,null),Rn.send(In("save_filters",{add_stages:[{_cls:"fiftyone.core.stages.SortBySimilarity",kwargs:[["query_ids",s],["k",n.k],["reverse",n.reverse],["brain_key",n.brainKey],["_state",null]]}]}))}),[]),Lu=b({key:"kValue",default:null}),Tu=b({key:"reverseValue",default:!1}),Zu=b({key:"brainKeyValue",default:null}),Cu=b({key:"searchBrainKeyValue",default:""}),Pu=Z({key:"availableSimilarityKeys",get:e=>({get:t})=>{const n=t(gi),s=t(co);if(!n&&!e)return s.samples;if(!e)return s.patches.reduce(((e,[n,s])=>(t(Fi).includes(s)&&(e=[...e,n]),e)),[]);if(e){const e=t(lo);if(Object.keys(e).length){const t=new Set(Object.values(e).map((({field:e})=>e)));return s.patches.filter((([e,n])=>t.has(n))).reduce(((e,[t])=>[...e,t]),[])}if(n){const{sample:e}=t(ut);return s.patches.filter((([t,n])=>e[n])).reduce(((e,[t])=>[...e,t]),[])}return s.samples}return[]}}),Ru=Z({key:"currentSimilarityKeys",get:e=>({get:t})=>{const n=t(Cu),s=t(Pu(e)),a=s.filter((e=>e.includes(n))).sort();return{total:s.length,choices:a.slice(0,11)}}}),Iu=T({key:"sortBySimilarityParameters",get:({get:e})=>({k:e(Lu),brainKey:e(Zu),reverse:e(Tu)})}),Wu=Z({key:"sortBySimilarityType",get:e=>({get:t})=>{const n=t(li);return e?"labels":n?"images":"patches"}}),Mu=g.memo((({modal:e,bounds:t,close:n})=>{const[s,a]=H(Zu),l=P(Pu(e)).length>0,i=P(Ru(e)),o=Su(),[r,c]=H(Tu),[d,m]=H(Lu),h=P(Wu(e)),p=xo();return u.exports.useLayoutEffect((()=>{1===i.choices.length&&a(i.choices[0])}),[i]),g.createElement(om,{modal:e,bounds:t},g.createElement(or,null,g.createElement(pm,{href:"https://voxel51.com/docs/fiftyone/user_guide/app.html#sorting-by-visual-similarity",text:"Sort by similarity",title:"About sorting by similarity",style:{background:"unset",color:p.font,paddingTop:0,paddingBottom:0},svgStyles:{height:"1rem",marginTop:7.5}})),l&&g.createElement(g.Fragment,null,g.createElement(md,{placeholder:"k (default = None)",validator:e=>""===e||/^[0-9\b]+$/.test(e),value:null===d?"":String(d),setter:e=>{m(""===e?null:Number(e))}}),g.createElement(rd,{name:"reverse",value:r,setValue:c}),g.createElement(or,{style:{fontSize:14}},"Brain key"),g.createElement(su,{choices:i.choices,value:s,setValue:a}),s&&g.createElement(g.Fragment,null,g.createElement(or,null),g.createElement(lm,{text:"Apply",title:`Sort by similarity to the selected ${h}`,onClick:()=>{n(),o()},style:{margin:"0.25rem -0.5rem",height:"2rem",borderRadius:0,textAlign:"center"}}))))})),Xu=()=>{const e=xo();return g.createElement(ie,{style:{padding:2,height:22,width:22,color:e.font}})},Nu=d.div`
  position: relative;
`,Gu=()=>{const[e,t]=u.exports.useState(!1),n=P(gm),s=P(xi),a=u.exports.useRef();fo(a,(()=>e&&t(!1)));const l=P(fm);return u.exports.useLayoutEffect((()=>{close&&t(!1)}),[close]),g.createElement(Nu,{ref:a},g.createElement(lr,{icon:n?g.createElement(Xu,null):g.createElement(Se,null),open:e,onClick:()=>!n&&t(!e),highlight:e||Boolean(l.length),title:s?"Clips":"Patches",style:{cursor:n?"default":"pointer"}}),e&&g.createElement(km,{close:()=>t(!1)}))},Yu=Z({key:"hasSimilarityKeys",get:e=>({get:t})=>!!e||Boolean(t(Lt).size)}),Vu=({modal:e})=>{const[t,n]=u.exports.useState(!1),s=u.exports.useRef(),a=P(Eu);fo(s,(()=>t&&n(!1)));const l=P(Yu(e)),[i,o]=q();return u.exports.useLayoutEffect((()=>{}),[!1]),l?g.createElement(Nu,{ref:s},g.createElement(lr,{icon:a?g.createElement(Xu,null):g.createElement(Le,null),open:t,onClick:()=>!a&&n(!t),highlight:!0,ref:i,title:"Sort by similarity",style:{cursor:a?"default":"pointer"}}),t&&g.createElement(Mu,{modal:e,close:()=>n(!1),bounds:o})):null},Fu=({modal:e,lookerRef:t})=>{const[n,s]=u.exports.useState(!1),[a,l]=u.exports.useState(!0),i=P(e?so:Lt),o=P(ao),r=u.exports.useRef();fo(r,(()=>n&&s(!1)));const[c,d]=q(),m=o;return u.exports.useLayoutEffect((()=>{}),[false]),t&&uo(t.current,"play",(()=>{n&&s(!1),l(!1)})),t&&uo(t.current,"pause",(()=>l(!0))),g.createElement(Nu,{ref:r},g.createElement(lr,{style:{cursor:m||!a?"default":"pointer"},icon:m?g.createElement(Xu,null):g.createElement(ue,null),open:n,onClick:()=>!m&&a&&s(!n),highlight:(Boolean(i.size)||n)&&a,ref:c,title:`Tag sample${e?"":"s"} or labels`}),n&&a&&g.createElement(Qm,{modal:e,bounds:d,close:()=>s(!1),lookerRef:t&&t.current instanceof Al?t:null}))},Ku=({modal:e,lookerRef:t})=>{const[n,s]=u.exports.useState(!1),[a,l]=u.exports.useState(!1),i=P(Lt),o=P(lo),r=u.exports.useRef();fo(r,(()=>n&&s(!1)));const[c,d]=q(),m=e?Object.keys(o).length:i.size;return t&&uo(t.current,"buffering",(e=>l(e.detail))),m<1&&!e?null:g.createElement(Nu,{ref:r},g.createElement(lr,{icon:a?g.createElement(Xu,null):g.createElement(ce,null),open:n,style:{cursor:a?"default":"pointer"},onClick:()=>{a||s(!n)},highlight:m>0||n,text:`${m}`,ref:c,title:`Manage selected ${e?"label":"sample"}${m>1?"s":""}`}),n&&g.createElement(Rm,{modal:e,close:()=>s(!1),lookerRef:t,bounds:d}))},Ou=({modal:e})=>{const[t,n]=u.exports.useState(!1),s=u.exports.useRef();fo(s,(()=>t&&n(!1)));const[a,l]=q();return g.createElement(Nu,{ref:s},g.createElement(lr,{icon:g.createElement(Te,null),open:t,onClick:()=>n(!t),highlight:t,ref:a,title:"Display options"}),t&&g.createElement(hm,{modal:e,bounds:l}))},zu=()=>{const[e,t]=H(Tt),n=Object.keys(e).length;return n<1?null:g.createElement(lr,{icon:g.createElement(Ze,null),open:!0,onClick:()=>t({}),highlight:!0,text:`${n}`,title:"Clear hidden labels"})},Du=b({key:"savingFilters",default:!1}),Hu=()=>{const e=P(fc(!1)),[t,n]=H(Du);return e?g.createElement(lr,{open:!1,highlight:!0,icon:t?g.createElement(Xu,null):g.createElement(Ce,null),style:{cursor:t?"default":"pointer"},onClick:()=>{t||(n(!0),Rn.send(In("save_filters",{})))},title:"Convert current field filters to view stages"}):null},Uu=d.div`
  display: flex;
  justify-content: ltr;
  margin-top: 2.5px;
  row-gap: 0.5rem;
  column-gap: 0.5rem;
`;var ju=g.memo((({modal:e,lookerRef:t})=>{const n=P(xi);P(pi);const s=e?{overflowX:"auto",overflowY:"hidden",margin:"0 -1em",padding:"0 1em",flexWrap:"wrap"}:{flexWrap:"no-wrap"};return g.createElement(Uu,{style:s},g.createElement(Ou,{modal:e}),g.createElement(Fu,{modal:e,lookerRef:e?t:null}),!e&&g.createElement(Gu,null),!n&&g.createElement(Vu,{modal:e}),e&&g.createElement(zu,null),!e&&g.createElement(Hu,null),g.createElement(Ku,{modal:e,lookerRef:t}))}));const Bu=d.div`
  background: ${({theme:e})=>e.background};
  display: flex;
  margin-bottom: 0.5rem;
  flex-shrink: 0;
  padding: 0 1rem;

  ${fr.Body} {
    width: 264px;
  }
`,Ju=d.div`
  display: flex;
  justify-content: space-between;
  overflow: visible;
  margin-left: 1rem;
  margin-right: -1rem;
  margin-bottom: -0.5rem;
  flex-grow: 1;
  height: 37px;
`,Au=d.div`
  display: flex;
  justify-content: center;
  align-content: center;
  flex-direction: column;
  border-color: ${({theme:e})=>e.backgroundDarkBorder};
  border-right-style: solid;
  border-right-width: 1px;
  margin: 0 0.25rem;
  padding-right: 1rem;
  font-weight: bold;
`,_u=d.div`
  display: flex;
`,Qu=d.div`
  display: flex;
  width: 8rem;
  padding-right: 1rem;
  margin: 0.25rem 0;
`,$u=({showSidebar:e,onShowSidebar:t})=>{const n=P(Zi),s=P(hi),a=P(Ci),l=ne(Xi),i=P(du),o=xo();let r=null;return"number"==typeof a&&a!==n&&"number"==typeof n?r=`${a.toLocaleString()} of ${n.toLocaleString()}`:"number"==typeof n&&(r=n.toLocaleString()),g.createElement(Bu,null,g.createElement(fr,{label:"Filters",expanded:e,onClick:t&&(()=>t(!e)),style:{width:256,padding:"0.25rem 0.5rem"}}),g.createElement(Ju,null,g.createElement(ju,{modal:!1}),g.createElement(_u,null,null!==r?g.createElement(Au,null,r," ",1===n?s.singular:s.plural):g.createElement(Au,null,g.createElement(ie,{style:{color:o.font,height:16,width:16,minWidth:16}})),g.createElement(Qu,null,g.createElement("div",{style:{flexGrow:1},title:"Zoom"},g.createElement(Cd,{valueAtom:Xi,boundsAtom:du,color:o.brand,showBounds:!1,persistValue:!1,style:{padding:0}})),g.createElement("div",{title:"Reset zoom",onClick:()=>{l(Math.max(i[0],5))},style:{cursor:"pointer"}},g.createElement(Pe,{style:{marginTop:2.5}}))))))},{assign:qu}=Ie,eh=e=>"string"!=typeof e?String(e):e,th=e=>e.includes("|")?["Union[",e.split("|").map((e=>th(e))).join(", "),"]"].join(""):"list<str>"===e?"List[str]":"list<id>"===e?"List[id]":e,nh={bool:{castFrom:e=>e?"True":"False",castTo:e=>0===["true","false"].indexOf(e.toLowerCase()),parse:e=>e.toLowerCase().charAt(0).toUpperCase()+e.toLowerCase().slice(1),validate:e=>["true","false"].indexOf(eh(e).toLowerCase())>=0},float:{castFrom:e=>String(e),castTo:e=>+e,parse:e=>{const t=e.replace(/[\s]/g,""),[n,s]=t.split(".");return n.replace(/\B(?=(\d{3})+(?!\d))/g,",")+(s?"."+s:"")},validate:e=>{const t=eh(e).replace(/[\s]/g,"");return""!==t&&!isNaN(+t)}},field:{castFrom:e=>e,castTo:e=>e,parse:(e,t)=>t.filter((t=>t.toLowerCase()===e.toLowerCase()))[0],validate:(e,t)=>"string"==typeof e&&t.includes(e.toLowerCase())},dict:{castFrom:e=>JSON.stringify(e,null,2),castTo:e=>"string"==typeof e?JSON.parse(e):e,parse:e=>e,validate:e=>{try{return("string"==typeof e?JSON.parse(e):e)instanceof Object&&!Array.isArray(e)}catch{return!1}}},id:{castFrom:e=>e,castTo:e=>e,parse:e=>e,validate:e=>/[0-9A-Fa-f]{24}/g.test(e)},int:{castFrom:e=>String(e).replace(/\B(?=(\d{3})+(?!\d))/g,","),castTo:e=>+e.replace(/[,\s]/g,""),parse:e=>String(+e.replace(/[,\s]/g,"")).replace(/\B(?=(\d{3})+(?!\d))/g,","),validate:e=>/^\d+$/.test(eh(e).replace(/[,\s]/g,""))},json:{castFrom:e=>JSON.stringify(e,null,2),castTo:e=>"string"==typeof e?JSON.parse(e):e,parse:e=>e,validate:e=>{try{return JSON.parse(e),!0}catch{return!1}}},"list<field>":{castFrom:e=>e.join(","),castTo:e=>e.split(","),parse:e=>e.replace(/[\s\'\"\[\]]/g,""),validate:(e,t)=>{const n=e.replace(/[\s]/g,"");let s=null;try{s=JSON.parse(n)}catch{s=n.split(",")}return Array.isArray(s)&&s.every((e=>nh.field.validate(e,t)))}},"list<id>":{castFrom:e=>e.join(","),castTo:e=>e.split(","),parse:e=>e.replace(/[\s\'\"\[\]]/g,""),validate:e=>{const t=e.replace(/[\s]/g,"");let n=null;try{n=JSON.parse(t)}catch{n=t.split(",")}return Array.isArray(n)&&n.every((e=>nh.id.validate(e)))}},"list<str>":{castFrom:e=>e.join(","),castTo:e=>e.split(","),parse:e=>e.replace(/[\s\'\"\[\]]/g,""),validate:e=>{const t=e.replace(/[\s]/g,"");let n=null;try{n=JSON.parse(t)}catch{n=t.split(",")}return Array.isArray(n)&&n.every((e=>nh.str.validate(e)))}},NoneType:{castFrom:e=>null===e?"None":e,castTo:()=>null,parse:()=>"None",validate:e=>[null,"None",""].some((t=>e===t))},str:{castFrom:e=>e,castTo:e=>e,parse:e=>e,validate:e=>{if("string"!=typeof e)return!1;try{return JSON.parse(e),!1}catch{return!0}}}};var sh=V({id:"viewStageParameter",initial:"decide",context:{id:void 0,defaultValue:void 0,parameter:void 0,stage:void 0,type:void 0,value:"",submitted:void 0,tail:void 0,focusOnInit:void 0,error:void 0,fieldNames:[]},states:{decide:{always:[{target:"editing",cond:e=>e.focusOnInit},{target:"reading.submitted",cond:e=>e.submitted},{target:"reading.pending"}]},reading:{initial:"pending",entry:"blurInput",states:{pending:{},submitted:{}},on:{EDIT:"editing"}},editing:{entry:[Re("PARAMETER.EDIT"),qu({bestMatch:({fieldNames:e,value:t,type:n})=>"field"===n?So(e,t):{},currentResult:null,prevValue:({value:e})=>e,focusOnInit:!1,results:({type:e,fieldNames:t,value:n})=>"field"===e?t.filter((e=>e.toLowerCase().startsWith(n.toLowerCase()))):[]}),"focusInput"],initial:"notHovering",states:{hovering:{on:{MOUSELEAVE:"notHovering"}},notHovering:{on:{MOUSEENTER:"hovering"}}},on:{CHANGE:{actions:[qu({bestMatch:({fieldNames:e,type:t},{value:n})=>"field"===t?So(e,n):{},currentResult:null,value:(e,{value:t})=>t,errorId:void 0,results:({type:e,fieldNames:t},{value:n})=>"field"===e?t.filter((e=>e.toLowerCase().startsWith(n.toLowerCase()))):[]})]},COMMIT:[{target:"decide",actions:[qu({submitted:!0,value:({type:e,value:t,defaultValue:n,fieldNames:s,bestMatch:a},{value:l})=>{const i="field"===e?Lo(s,t):null;return t=l||t,""===(t=i||(a.value?a.value:t))&&n?n:e.split("|").reduce(((e,n)=>{if(void 0!==e)return e;const a=nh[n];return a.validate(t,s)?a.parse(t,s):e}),void 0)},errorId:void 0,bestMatch:{}}),"blurInput",Re((e=>({type:"PARAMETER.COMMIT",parameter:e})))],cond:({type:e,fieldNames:t,value:n,defaultValue:s,bestMatch:a},{value:l})=>{n=l||n;const i="field"===e?Lo(t,n):null;return""===(n=i||(a.value?a.value:n))&&s||e.split("|").some((e=>nh[e].validate(n,t)))}},{actions:[qu({error:({type:e})=>({name:"value",error:`Expected type "${th(e)}"`}),errorId:x()})]}],CANCEL:{target:"reading.pending",actions:[qu({value:({prevValue:e})=>e,errorId:void 0})]},NEXT_RESULT:{actions:qu({currentResult:({currentResult:e,results:t})=>null===e?0:Math.min(e+1,t.length-1),value:({currentResult:e,results:t})=>null===e?t[0]:t[Math.min(e+1,t.length-1)],bestMatch:{}})},PREVIOUS_RESULT:{actions:qu({currentResult:({currentResult:e})=>0===e||null===e?null:e-1,value:({currentResult:e,prevValue:t,results:n})=>0===e||null===e?t:n[e-1],bestMatch:{}})}}}},on:{BLUR:[{target:"reading.pending",cond:({submitted:e,prevValue:t})=>!e&&""!==t,actions:[qu({value:({prevValue:e})=>e})]},{target:"reading.submitted",cond:({submitted:e})=>e}],FOCUS:{actions:"focusInput"},CLEAR_ERROR:{actions:[qu({error:void 0})]},CLEAR_ERROR_ID:{actions:[qu({errorId:void 0})]},UPDATE:{actions:qu({active:(e,{active:t})=>t})}}},{actions:{blurInput:()=>{},focusInput:()=>{}}});const ah=d.div`
  display: flex;
  overflow: visible;
  z-index: 800;
`,lh=m(d.div`
  box-sizing: border-box;
  border: 1px solid ${({theme:e})=>e.brand};
  display: flex;
  overflow: visible;
`),ih=m(d(Y)`
  & > input {
    background-color: transparent;
    border: none;
    padding: 0.5rem 0 0.5rem 0.5rem;
    color: ${({theme:e})=>e.font};
    height: 1rem;
    font-weight: bold;
  }

  & > input:focus {
    border: none;
    outline: none;
  }

  & ::placeholder {
    color: ${({theme:e})=>e.font};
  }
`),oh=m(d.div`
  font-weight: bold;
  position: fixed;
  line-height: 1rem;
  font-size: 14px;
  margin-left: -1px;
  overflow: visible;
  display: flex;
  border: 1px solid pink;
  border-style: solid;
  z-index: 800;
  will-change: transform;
  min-width: 2rem;
`),rh=m(d.textarea`
  background-color: transparent;
  overflow: visible;
  line-height: 1rem;
  border: none;
  color: ${({theme:e})=>e.font};
  height: 100%;
  font-size: 14px;
  will-change: tranform;
  resize: none;

  &::-webkit-scrollbar {
    width: 0px;
    background: transparent;
    display: none;
  }
  &::-webkit-scrollbar-thumb {
    width: 0px;
    display: none;
  }

  &:focus {
    border: none;
    outline: none;
  }
`),ch=m(d.button`
  box-sizing: border-box;
  border: 1px solid ${({theme:e})=>e.brand};
  color: ${({theme:e})=>e.font};
  background-color: ${({theme:e})=>e.backgroundLight};
  border-radius: 3px;
  position: relative;
  line-height: 1rem;
  cursor: pointer;
  font-weight: bold;
  position: absolute;
  bottom: 0.5rem;
  right: 0.5rem;

  :focus {
    outline: none;
  }
`),dh=g.memo((({send:e})=>{const t=M({opacity:1,from:{opacity:0}});return g.createElement(ch,{style:t,onClick:()=>e("COMMIT")},"Submit")})),mh=({placeholder:e,parameter:t})=>void 0!==e?e:t;let uh;const hh=({barRef:e,parameterRef:t,followRef:n,inputRef:s,stageRef:a,onClose:l,hasExpansion:i})=>{const[r,c]=W(t),[d]=W(a),p=u.exports.useContext(h),f=u.exports.useRef(null),{active:b,value:y}=r.context,[v,x]=M((()=>({height:r.matches("editing")?200:36,position:r.matches("editing")?"fixed":"relative",backgroundColor:r.matches("editing")?p.backgroundDark:r.matches("reading.submitted")?p.backgroundLight:p.background,borderColor:b&&d.matches("focusedViewBar.yes")?p.brand:p.fontDarkest,opacity:1,from:{opacity:0}}))),w=M({width:r.matches("editing")?400:0});fo(f,(e=>{e.stopPropagation(),c("BLUR"),l()})),u.exports.useEffect((()=>{x({position:r.matches("editing")?"fixed":"relative",backgroundColor:r.matches("editing")?p.backgroundDark:r.matches("reading.submitted")?p.backgroundLight:p.background,borderColor:b&&d.matches("focusedViewBar.yes")?p.brand:p.fontDarkest,height:r.matches("editing")?200:34,opacity:1})}),[r.matches("editing"),b,d.matches("focusedViewBar.yes")]);const k=()=>{uh&&window.cancelAnimationFrame(uh),uh=window.requestAnimationFrame((()=>{const{x:t,y:s}=r.matches("editing")?n.current.getBoundingClientRect():{x:0,y:0};f.current.style.top=r.matches("editing")?`${s}px`:"unset",f.current.style.left=r.matches("editing")?`${t}px`:"unset";const{x:a,width:l}=e.current.getBoundingClientRect(),i=a+l;f.current.style.width=r.matches("editing")?`${Math.min(i-t,400)}px`:"auto"}))};return uo(e.current?e.current:null,"scroll",k),uo(window,"scroll",k),go(f?f.current:null,k),g.createElement(g.Fragment,null,r.matches("editing")&&g.createElement(m.div,{style:o({height:"100%"},w)}),g.createElement(oh,{style:v,onClick:()=>r.matches("reading")&&c("EDIT"),ref:f},r.matches("reading")?g.createElement("div",{style:{padding:"0.5em",whiteSpace:"nowrap"}},((e,t)=>nh.dict.validate(e)?"  . . .  ":""===e?t:e)(y,mh(r.context))):g.createElement(g.Fragment,null,g.createElement(rh,{key:"textarea",autoFocus:r.matches("editing"),style:w,onChange:e=>{c({type:"CHANGE",value:e.target.value.replace(/&#13/g,"\n")})},onKeyDown:e=>{["Escape","Tab"].includes(e.key)&&(c("COMMIT"),l())},value:y,ref:s}),i&&g.createElement(oe,{style:{cursor:"pointer",color:p.font,marginTop:"0.2em",position:"absolute",right:"0.2rem"},onClick:l}),g.createElement(dh,{key:"submit",send:c})),g.createElement(Eo,{key:"error",serviceRef:t,style:{marginTop:"12.5rem",marginLeft:0}})))},ph=g.memo((({parameterRef:e,barRef:t,stageRef:n})=>{const s=u.exports.useContext(h),[a,l]=W(e),[i]=W(n),o=u.exports.useRef(),[r,c]=u.exports.useState({}),[d,m]=u.exports.useState(!1),{type:p,value:f,active:b,currentResult:y,results:v,bestMatch:x}=a.context,w=p.split("|").some((e=>["dict","json"].includes(e))),k="dict|str"===p,E=w&&(!k||d);let S=!1;try{const e=JSON.parse(f);S=!Array.isArray(e)&&"object"==typeof e}catch{}u.exports.useEffect((()=>{k&&!d&&S&&m(!0)}),[f]);const L=M({backgroundColor:a.matches("editing")?s.backgroundDark:a.matches("reading.submitted")?s.backgroundLight:s.background,borderStyle:"solid",borderColor:b&&i.matches("focusedViewBar.yes")?s.brand:s.fontDarkest,height:E&&a.matches("editing")?200:34,borderWidth:E?0:1,borderRightWidth:0,opacity:1,from:{opacity:0}}),T=a.matches("editing");return u.exports.useEffect((()=>{T&&o.current&&o.current.focus(),!T&&o.current&&o.current.blur()}),[T,o.current]),g.createElement(g.Fragment,null,g.createElement(ah,{ref:e=>e&&e!==r.current&&c({current:e})},E?g.createElement(hh,{parameterRef:e,barRef:t,followRef:r,inputRef:o,stageRef:n,onClose:()=>{k&&(m(!1),S&&l("BLUR"))},hasExpansion:k}):g.createElement(lh,{style:L},g.createElement(ih,{placeholder:mh(a.context),autoFocus:a.matches("editing"),value:S?". . .":a.matches("reading")&&f.length>24?f.slice(0,25)+"...":f,onFocus:()=>!T&&l({type:"EDIT"}),onBlur:()=>a.matches("editing.notHovering")&&l({type:"COMMIT"}),onChange:e=>{l({type:"CHANGE",value:e.target.value})},onKeyPress:e=>{"Enter"===e.key&&T&&l({type:"COMMIT"})},onKeyDown:e=>{switch(e.key){case"Tab":l("COMMIT");case"Escape":l("COMMIT");break;case"ArrowDown":l("NEXT_RESULT");break;case"ArrowUp":l("PREVIOUS_RESULT");break;case"ArrowRight":e.target.selectionStart===e.target.value.length&&x.value&&l({type:"CHANGE",value:x.value})}},ref:o}),g.createElement(mt,null,x?x.placeholder:""),k&&T&&g.createElement(re,{style:{cursor:"pointer",color:s.font,marginTop:"0.2em"},onMouseEnter:()=>l("MOUSEENTER"),onMouseLeave:()=>l("MOUSELEAVE"),onClick:()=>m(!0)}))),a.matches("editing")&&t.current&&r.current&&g.createElement(Po,{results:v,send:l,currentResult:y,bestMatch:x.value,followRef:r,barRef:t}),!w&&r.current&&g.createElement(Eo,{key:"error",serviceRef:e,barRef:t,followRef:r}))})),gh=m(d.div`
  margin: 0.5rem 0.25rem;
  display: flex;
  position: relative;
`),fh=m(d.div`
  box-sizing: border-box;
  border: 1px solid ${({theme:e})=>e.brand};
  border-top-left-radius: 3px;
  border-bottom-left-radius: 3px;
  border-right-width: 0;
  position: relative;
  display: flex;
`),bh=d(Y)`
  & input {
    background-color: transparent;
    border: none;
    padding: 0.5rem;
    color: ${({theme:e})=>e.font};
    height: 1rem;
    border: none;
    font-weight: bold;
  }

  & input:focus {
    border: none;
    outline: none;
    font-weight: bold;
    padding-right: 0;
  }

  & ::placeholder {
    color: ${({theme:e})=>e.font};
    font-weight: bold;
  }
`,yh=m(d.div`
  box-sizing: border-box;
  border: 1px dashed ${({theme:e})=>e.fontDarkest};
  color: ${({theme:e})=>e.fontDarkest};
  border-radius: 3px;
  position: relative;
  margin: 0.5rem;
  cursor: pointer;
  font-weight: bold;

  padding: 0 0.25rem;

  :focus {
    outline: none;
  }
`),vh=d.div`
  width: 14px;
  height: 32px;
  display: block;
  position: relative;
  overflow: hidden;
`;m(d($)`
  display: block;
  font-size: 14px;
`),m(d(We)`
  position: absolute;
`);const xh=g.memo((({send:e,index:t,active:n})=>{const s=u.exports.useContext(h),[a,l]=u.exports.useState(!1),[i,c]=M((()=>({background:s.background,color:n?s.font:s.fontDarkest,borderColor:n?s.brand:s.fontDarkest,top:n?-3:0,opacity:1,from:{opacity:0},config:X.stiff})));u.exports.useEffect((()=>{c({top:n?-3:0,color:n?s.font:s.fontDarkest,borderColor:n?s.brand:s.fontDarkest}),n?y():v()}),[n]);const[d,p]=M((()=>({marginTop:n?0:31}))),[f,b]=M((()=>({marginTop:n?-31:0}))),y=()=>{c({background:s.background}),p({marginTop:0}),b({marginTop:-31})},v=()=>{c({background:s.backgroundDark}),p({marginTop:31}),b({marginTop:0})};return u.exports.useEffect((()=>{(n||a)&&y(),!n&&!a&&v()}),[n,a]),g.createElement(yh,{style:i,onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),onClick:()=>e({type:"STAGE.ADD",index:t})},g.createElement(vh,null,g.createElement(m.div,{style:r(o({},f),{textAlign:"center",height:"100%",lineHeight:"2rem"})},">"),g.createElement(m.div,{style:r(o({},d),{textAlign:"center",height:"100%",lineHeight:"2rem"})},"+")))})),wh=m(d.div`
  box-sizing: border-box;
  border: 1px solid ${({theme:e})=>e.brand};
  position: relative;
  border-top-right-radius: 3px;
  border-bottom-right-radius: 3px;
  cursor: pointer;
`),kh=m(d.button`
  background-color: ${({theme:e})=>e.backgroundLight};
  border: none;
  padding: 0.5rem;
  color: ${({theme:e})=>e.font};
  height: 1rem;
  display: block;
  height: 100%;
  border: none;
  cursor: pointer;
  font-weight: bold;
  margin: 0;

  :focus {
    outline: none;
  }
`),Eh=g.memo((({send:e,spring:t})=>g.createElement(wh,{style:t,onClick:()=>e("STAGE.DELETE")},g.createElement(kh,null,g.createElement(f,{style:{fontSize:"14px",display:"block"}}))))),Sh=g.memo((({barRef:e,stageRef:t})=>{const n=u.exports.useContext(h),[s,a]=W(t),l=u.exports.useRef(),[i,o]=u.exports.useState({}),{stage:r,stageInfo:c,parameters:d,results:m,currentResult:p,focusOnInit:f,active:b,bestMatch:y}=s.context,v=["input.reading.selected","input.reading.submitted"].some(s.matches),x=M({borderColor:b&&s.matches("focusedViewBar.yes")?n.brand:n.fontDarkest,opacity:1,from:{opacity:0}}),w=M({backgroundColor:v?n.backgroundLight:n.background,borderRightWidth:s.matches("delible.yes")&&d.length?0:1,borderColor:b&&s.matches("focusedViewBar.yes")?n.brand:n.fontDarkest,borderTopRightRadius:d.length?0:3,borderBottomRightRadius:d.length?0:3,opacity:1,from:{opacity:0}}),k=M({top:s.matches("focusedViewBar.yes")&&s.context.active?-3:0,config:X.stiff}),E=s.matches("input.editing");return u.exports.useEffect((()=>{E&&l.current&&l.current.focus(),!E&&l.current&&l.current.blur()}),[E,l.current]),g.createElement(g.Fragment,null,g.createElement(gh,{style:k,ref:e=>e&&e!==i.current&&o({current:e})},g.createElement(fh,{style:w},g.createElement(bh,{placeholder:0===r.length?"+ add stage":"",value:r,autoFocus:f,onFocus:()=>!E&&a("EDIT"),onBlur:e=>{s.matches("input.editing.searchResults.notHovering")&&a("BLUR")},onChange:e=>a({type:"CHANGE",value:e.target.value}),onKeyPress:e=>{if("Enter"===e.key){const t=Lo(c.map((e=>e.name)),e.target.value);a({type:"COMMIT",value:t||(y.value?y.value:e.target.value)})}},onKeyDown:e=>{switch(e.key){case"Escape":a("BLUR");break;case"ArrowDown":a("NEXT_RESULT");break;case"ArrowUp":a("PREVIOUS_RESULT");break;case"ArrowRight":e.target.selectionStart===e.target.value.length&&y.value&&a({type:"CHANGE",value:y.value})}},style:{fontSize:"1rem"},ref:l}),s.matches("input.editing")?g.createElement(mt,null,y?y.placeholder:""):null,v&&g.createElement("div",{style:{width:"1rem",height:"1rem",margin:"0.4rem 0.5rem 0.5rem 0"}},g.createElement(Wo,{href:`https://voxel51.com/docs/fiftyone/api/fiftyone.core.stages.html#fiftyone.core.stages.${r}`,style:{maxHeight:"1rem",width:"1rem",display:"block"}},g.createElement(ye,{style:{width:"1rem",height:"1rem"}})))),d.filter((e=>!e.parameter.startsWith("_"))).map((n=>g.createElement(ph,{key:n.parameter,parameterRef:n.ref,barRef:e,stageRef:t}))),d.length?g.createElement(Eh,{spring:x,send:a}):null,s.matches("input.editing")&&e.current&&i.current&&g.createElement(Po,{results:m,send:a,currentResult:p,bestMatch:y.value,followRef:i,barRef:e}),i.current&&g.createElement(Eo,{serviceRef:t,followRef:i,barRef:e})))})),{choose:Lh}=Ie,Th=(e,t,n,s,a,l,i,o,r,c,d)=>({id:x(),defaultValue:a,parameter:n,type:s,stage:t,value:l||"",submitted:i,focusOnInit:o,inputRef:{},tail:r,currentResult:null,results:[],active:c,placeholder:d,fieldNames:e}),Zh=V({id:"viewStage",context:{id:void 0,stage:void 0,parameters:[],prevStage:"",stageInfo:void 0,index:void 0,focusOnInit:void 0,length:void 0,inputRef:{},fieldNames:[]},type:"parallel",states:{input:{initial:"decide",states:{hist:{type:"history"},decide:{always:[{target:"initializing",cond:e=>e.parameters.length&&!e.parameters[0].ref},{target:"waiting",cond:e=>!e.inputRef},{target:"editing",cond:({focusOnInit:e})=>e},{target:"reading"}]},initializing:{entry:F({parameters:e=>e.parameters.map((e=>r(o({},e),{ref:Me(sh.withContext(e))})))}),always:"decide"},waiting:{on:{FOCUS:{target:"decide",actions:F({inputRef:(e,{inputRef:t})=>t})}}},reading:{entry:"blurInput",initial:"decide",states:{decide:{always:[{target:"pending",cond:e=>{return t=e.stageInfo,n=e.stage,!t.map((e=>e.name)).some((e=>e.toLowerCase()===n.toLowerCase()));var t,n}},{target:"selected"}]},hist:{type:"history"},pending:{},selected:{},submitted:{}},on:{EDIT:{target:"editing",actions:Re((({index:e})=>({type:"STAGE.EDIT",index:e})))},DELETE:{target:"deleted"}}},editing:{entry:[F({prevStage:e=>e.stage,prevSubmitted:e=>e.submitted,results:({stageInfo:e,stage:t})=>e.map((e=>e.name)).filter((e=>e.toLowerCase().startsWith(t.toLowerCase()))),currentResult:null,focusOnInit:!0,bestMatch:({stageInfo:e,stage:t})=>So(e.map((e=>e.name)),t)})],type:"parallel",states:{input:{initial:"focused",states:{focused:{entry:"focusInput",on:{UNFOCUS_INPUT:"unfocused"}},unfocused:{on:{FOCUS_INPUT:"focused"}}}},searchResults:{initial:"notHovering",states:{hovering:{on:{MOUSELEAVE:"notHovering"}},notHovering:{on:{MOUSEENTER:"hovering"}}}}},on:{CHANGE:{actions:F({stage:(e,t)=>t.value,results:({stageInfo:e},t)=>e.map((e=>e.name)).filter((e=>e.toLowerCase().startsWith(t.value.toLowerCase()))),currentResult:null,errorId:void 0,bestMatch:({stageInfo:e},{value:t})=>So(e.map((e=>e.name)),t)})},COMMIT:[{target:"reading.selected",actions:[F({focusOnInit:!1,stage:(e,{value:t})=>e.stageInfo.filter((e=>e.name.toLowerCase().startsWith(t.toLowerCase())))[0].name,parameters:(e,{value:t})=>{const n=e.stageInfo.filter((e=>e.name.toLowerCase().startsWith(t.toLowerCase())))[0].params;return n.map(((s,a)=>Th(e.fieldNames,t,s.name,s.type,s.default,s.name.startsWith("_")?s.default:"",s.name.startsWith("_"),0===a,a===n.length-1,e.active,s.placeholder))).map((e=>r(o({},e),{ref:Me(sh.withContext(e))})))},errorId:void 0}),Xe("UPDATE_DELIBLE"),"blurInput"],cond:({stageInfo:e},{value:t})=>Lo(e.map((e=>e.name)),t)},{actions:[F({submitted:()=>!1,error:(e,{value:t})=>({name:"stage",error:`${""===t?'""':t} is not a valid stage`}),errorId:x()})]}],BLUR:[{target:"deleted",cond:e=>0===e.parameters.length},{target:"reading.pending",actions:[F({focusOnInit:!1}),"blurInput"]}]}},deleted:{onEntry:[F({stage:"",submitted:!1,parameters:[]}),Re((e=>({type:"STAGE.DELETE",stage:e})))],always:"reading.pending"}}},delible:{initial:"decide",states:{decide:{always:[{target:"yes",cond:e=>e.length>1||e.submitted||""!==e.stage},{target:"no"}]},yes:{},no:{}}},draggable:{initial:"decide",states:{decide:{always:[{target:"yes",cond:e=>1===e.length},{target:"no"}]},yes:{},no:{}}},focusedViewBar:{initial:"decide",states:{decide:{always:[{target:"yes",cond:e=>e.focusOnInit},{target:"no"}]},yes:{},no:{}}}},on:{CLEAR_ERROR:{actions:[F({error:void 0})]},CLEAR_ERROR_ID:{actions:[F({errorId:void 0})]},NEXT_RESULT:{actions:F({currentResult:({currentResult:e,results:t})=>null===e?0:Math.min(e+1,t.length-1),stage:({currentResult:e,results:t})=>null===e?t[0]:t[Math.min(e+1,t.length-1)],bestMatch:{}})},PREVIOUS_RESULT:{actions:F({currentResult:({currentResult:e})=>0===e||null===e?null:e-1,stage:({currentResult:e,prevStage:t,results:n})=>0===e||null===e?t:n[e-1],bestMatch:{}})},BAR_FOCUS:"focusedViewBar.yes",BAR_BLUR:"focusedViewBar.no",UPDATE_DELIBLE:"delible","STAGE.UPDATE":{target:["draggable","delible","input"],actions:[F({index:(e,{index:t})=>t,length:(e,{length:t})=>t,active:(e,{active:t})=>t,fieldNames:(e,{fieldNames:t})=>t}),(e,{active:t})=>{e.parameters.forEach((e=>e.ref.send({type:"UPDATE",active:t})))}]},"STAGE.DELETE":[{target:"input.deleted"}],"PARAMETER.COMMIT":{target:"input",actions:[F({parameters:(e,t)=>e.parameters.map((e=>e.id===t.parameter.id?r(o({},t.parameter),{ref:e.ref}):e))}),Lh([{cond:e=>e.parameters.reduce(((e,t)=>t.submitted?e:e+1),0)>0,actions:Xe("EDIT",{to:(e,t)=>{const n=e.parameters.reduce(((e,n,s)=>n.id===t.parameter.id?s:e),void 0);let s=n+1;for(;s<e.parameters.length;){if(!e.parameters[s].submitted)return e.parameters[s].ref;s+=1}for(s=n-1;s>=0;){if(!e.parameters[s].submitted)return e.parameters[s].ref;s-=1}}})},{cond:e=>0===e.parameters.reduce(((e,t)=>t.submitted?e:e+1),0),actions:[F({submitted:!0,focusOnInit:!1,active:!1}),e=>{e.parameters.forEach((e=>e.ref.send({type:"UPDATE",active:!1})))},Re((e=>({type:"STAGE.COMMIT",stage:e})))]}])]},"PARAMETER.EDIT":{actions:[Re((e=>({type:"STAGE.EDIT",index:e.index})))]}}},{actions:{focusInput:()=>{},blurInput:()=>{}}}),{choose:Ch}=Ie,Ph=(e,t,n,s,a,l,i,o,r,c,d)=>({id:t||x(),stage:n,parameters:r,stageInfo:a,index:s,focusOnInit:l,length:i,active:o,inputRef:{},submitted:c,loaded:d,fieldNames:e});function Rh(e,t,n,s=!0,a){return e.split("|").reduce(((e,l)=>{if(void 0!==e)return e;const i=nh[l];return i.validate(s?n:i.castFrom(n,a),a)?i[t](n,a):e}),void 0)}function Ih(e,t,n){return 1===e.length&&""===e[0].stage?[]:e.map((e=>function(e,t,n){return{kwargs:e.parameters.map(((s,a)=>[s.parameter,Rh(t[e.stage][a].type,"castTo",s.value,!0,n)])),_uuid:e.id,_cls:`fiftyone.core.stages.${e.stage}`}}(e,t,n)))}function Wh(e,t){const n=Ph(e,null,"",0,t,!1,1,!0,[],!1);return[r(o({},n),{ref:Me(Zh.withContext(n))})]}function Mh(e,t){const n=e.view,s=Object.fromEntries(t.map((e=>[e.name,e.params])));return Xn(n,Ih(e.stages,s,e.fieldNames))?e.stages:0===n.length?Wh(e.fieldNames,t):n.map(((s,a)=>{let l=s._cls.split(".");l=l[l.length-1];const i=Ph(e.fieldNames,s._uuid,l,a,t,!1,e.stages.length,a===Math.min(n.length-1,e.activeStage),s.kwargs.map(((s,i)=>{const o=t.filter((e=>e.name===l))[0];return Th(e.fieldNames,l,s[0],o.params[i].type,o.params[i].default,Rh(o.params[i].type,"castFrom",s[1],!1,e.fieldNames),!0,!1,i===o.params.length-1,a===Math.min(n.length-1,e.activeStage),o.params[i].placeholder)})),!0,!0);return r(o({},i),{ref:Me(Zh.withContext(i))})}))}const Xh=V({id:"stages",context:{stages:[],stageInfo:void 0,activeStage:0,view:void 0,setView:void 0,http:void 0,fieldNames:[]},initial:"initializing",states:{decide:{always:[{target:"running.hist",cond:e=>e.stageInfo&&e.view,actions:[F({stages:e=>Mh(e,e.stageInfo)})]},{target:"loading"}]},initializing:{},loading:{invoke:{src:function(e){return fetch(`${e.http}/stages`).then((e=>e.json()))},onDone:{target:"running",actions:F({stageInfo:(e,t)=>t.data.stages,stages:(e,t)=>0===e.view.length?Wh(e.fieldNames,t.data.stages):Mh(e,t.data.stages)})}}},running:{type:"parallel",states:{focus:{initial:"blurred",states:{focused:{entry:[({stages:e})=>e.forEach((e=>e.ref.send({type:"BAR_FOCUS"})))],exit:[({stages:e})=>e.forEach((e=>e.ref.send({type:"BAR_BLUR"})))],on:{TOGGLE_FOCUS:{target:"blurred"},NEXT:{actions:[F({activeStage:({stages:e,activeStage:t})=>{const n=t;return n===e.length-.5?n:n%1!=0?Math.ceil(n):e[n].submitted&&(n===e.length-1||e[n+1].submitted)?n+.5:Math.min(e.length-1,n+1)}}),"sendStagesUpdate"]},PREVIOUS:{actions:[F({activeStage:({stages:e,activeStage:t})=>{const n=t;return-.5===n?n:n%1!=0?Math.floor(n):e[n].submitted&&(0===n||e[n-1].submitted)?n-.5:Math.max(0,n-1)}}),"sendStagesUpdate"]},NEXT_STAGE:{actions:[F({activeStage:({stages:e,activeStage:t})=>Math.min(Math.floor(t+1),e.length-1)}),"sendStagesUpdate"]},PREVIOUS_STAGE:{actions:[F({activeStage:({stages:e,activeStage:t})=>Math.max(Math.ceil(t-1),0)}),"sendStagesUpdate"]},NEXT_RESULT:{actions:Xe((({stages:e,activeStage:t})=>({type:"NEXT_RESULT",to:e[t].ref})))},PREVIOUS_RESULT:{actions:Xe((({stages:e,activeStage:t})=>({type:"PREVIOUS_RESULT",to:e[t].ref})))},DELETE_ACTIVE_STAGE:{actions:Xe((({activeStage:e,stages:t})=>({type:"STAGE.DELETE",stage:t[e]})))},ENTER:{actions:[Ch([{actions:Xe((({activeStage:e})=>({type:"STAGE.ADD",index:Math.ceil(e)}))),cond:({activeStage:e})=>.5===Math.abs(e%1)},{actions:Xe((({stages:e,activeStage:t})=>{e[t].ref.send({type:"EDIT"})}))}])]}}},blurred:{on:{TOGGLE_FOCUS:{target:"focused"}}}}},hovering:{initial:"no",states:{yes:{on:{MOUSELEAVE:"no"}},no:{on:{MOUSEENTER:"yes"}}}},hist:{type:"history",history:"deep"}}}},on:{"STAGE.EDIT":{actions:[F({activeStage:(e,t)=>t.index}),"sendStagesUpdate"]},"STAGE.ADD":{actions:[F({activeStage:(e,{index:t})=>t,stages:(e,{index:t})=>{const n=Ph(e.fieldNames,null,"",t,e.stageInfo,!0,e.stages.length+1,!0,[],!1);return n.added=!0,[...e.stages.slice(0,t),r(o({},n),{ref:Me(Zh.withContext(n))}),...e.stages.slice(t)].map(((t,n)=>r(o({},t),{index:n,active:n==n,length:e.stages.length+1})))}}),"sendStagesUpdate"]},"STAGE.COMMIT":{actions:[F({stages:({stages:e},t)=>(e[t.stage.index]=r(o({},t.stage),{ref:e[t.stage.index].ref}),e),activeStage:({activeStage:e})=>e+.5}),"submit"]},CLEAR:{actions:[F({stages:e=>{const t=Ph(e.fieldNames,null,"",0,e.stageInfo,!1,0,!0,[],!1);return[r(o({},t),{ref:Me(Zh.withContext(t))})]}}),"submit"]},"STAGE.DELETE":{actions:[F({activeStage:({activeStage:e})=>Math.max(e-1,0),stages:({fieldNames:e,stages:t,stageInfo:n},s)=>{if(1===t.length&&t[0].id===s.stage.id){const t=Ph(e,null,"",0,n,!1,0,!0,[],!1);return[r(o({},t),{ref:Me(Zh.withContext(t))})]}return t.filter((e=>e.id!==s.stage.id||1===t.length)).map(((e,n)=>{const a=e.id===s.stage.id?s.stage:e;return a.index=n,a.length=Math.max(t.length-1,1),a}))}}),"submit"]},UPDATE:{target:"decide",actions:[F({http:(e,{http:t})=>t,view:(e,{view:t})=>t,setView:(e,{setView:t})=>t,fieldNames:(e,{fieldNames:t})=>t}),"sendStagesUpdate"]}}},{actions:{sendStagesUpdate:e=>{e.stages.forEach((t=>t.ref.send({type:"STAGE.UPDATE",index:t.index,length:e.stages.length,active:t.index===e.activeStage,stage:t.stage,fieldNames:e.fieldNames})))},submit:({stages:e,stageInfo:t,fieldNames:n,setView:s,view:a})=>{const l=Ih(e,Object.fromEntries(t.map((e=>[e.name,e.params]))),n);Xn(l,a)||s(l)}}}),Nh=d.div`
  display: block;
  position: relative;
  width: 100%;
  background-color: ${({theme:e})=>e.background};
  padding: 1rem 0;
`,Gh=d.div`
  background-color: ${({theme:e})=>e.backgroundDark};
  border-radius: 3px;
  border: 1px solid ${({theme:e})=>e.backgroundDarkBorder};
  box-sizing: border-box;
  height: 52px;
  width: 100%;
  padding: 0 0.25rem;
  display: flex;
  overflow-x: scroll;
  scrollbar-width: none;

  &::-webkit-scrollbar {
    width: 0px;
    background: transparent;
    display: none;
  }
  &::-webkit-scrollbar-thumb {
    width: 0px;
    display: none;
  }
`,Yh=d.div`
  position: absolute;
  z-index: 904;
  top: 1rem;
  padding: 14px 0.5rem;
  height: 52px;
  border-radius: 3px;
  right: 0;
  background-image: linear-gradient(
    to right,
    rgba(0, 0, 0, 0),
    5%,
    ${({theme:e})=>e.backgroundDark}
  );

  & > * {
    height: 100%;
  }

  & > * > {
    display: flex;
    justify-content: center;
    align-content: center;
    flex-direction: column;
  }
`,Vh={VIEW_BAR_NEXT:"right",VIEW_BAR_PREVIOUS:"left",VIEW_BAR_NEXT_STAGE:"shift+right",VIEW_BAR_PREVIOUS_STAGE:"shift+left",VIEW_BAR_DELETE:["del","backspace"],VIEW_BAR_ENTER:"enter"},Fh=g.memo((()=>{const[e,t]=z(Xh),[n,s]=H(wi),a=P(Gi);u.exports.useEffect((()=>{t({type:"UPDATE",http:Zn,view:n,setView:s,fieldNames:a})}),[Zn,n]);const{stages:l,activeStage:i}=e.context,o=u.exports.useRef(null),r={VIEW_BAR_NEXT:u.exports.useCallback((()=>t("NEXT")),[]),VIEW_BAR_PREVIOUS:u.exports.useCallback((()=>t("PREVIOUS")),[]),VIEW_BAR_NEXT_STAGE:u.exports.useCallback((()=>t("NEXT_STAGE")),[]),VIEW_BAR_PREVIOUS_STAGE:u.exports.useCallback((()=>t("PREVIOUS_STAGE")),[]),VIEW_BAR_DELETE:u.exports.useCallback((()=>t("DELETE_ACTIVE_STAGE")),[]),VIEW_BAR_ENTER:u.exports.useCallback((e=>{e.preventDefault(),t("ENTER")}),[])};return fo(o,(()=>e.matches("running.focus.focused")&&t("TOGGLE_FOCUS"))),g.createElement("div",{style:{padding:"0 1rem"}},g.createElement(Nh,null,g.createElement(Ne.exports.GlobalHotKeys,{handlers:r,keyMap:Vh}),g.createElement(Gh,{onClick:()=>e.matches("running.focus.blurred")&&t("TOGGLE_FOCUS"),ref:o},e.matches("running")?l.map(((n,s)=>g.createElement(g.Fragment,{key:n.id},n.submitted&&(0===s||l[s-1].submitted)?g.createElement(xh,{key:`insert-button-${n.id}`,send:t,index:s,active:i===s-.5&&e.matches("running.focus.focused")}):null,g.createElement(Sh,{key:n.id,stageRef:n.ref,barRef:o})))):null,e.matches("running")&&l[l.length-1].submitted?g.createElement(xh,{key:"insert-button-tail",send:t,index:l.length,active:i===l.length-.5&&e.matches("running.focus.focused")}):null,g.createElement("div",{style:{display:"block",minWidth:64,maxWidth:64,height:"100%"}})),g.createElement(Yh,null,g.createElement(f,{onClick:()=>t("CLEAR"),style:{cursor:"pointer"}}),g.createElement(Wo,{href:"https://voxel51.com/docs/fiftyone/user_guide/app.html#using-the-view-bar"},g.createElement(ye,null)))))})),Kh=d.div`
  display: block;
  height: 100%;
  width 286px;
  padding-left: 1rem;
  overflow: visible;
`,Oh=d.div`
  max-height: 100%;
  height: 100%;
  overflow-y: scroll;
  overflow-x: hidden;
  scrollbar-color: ${({theme:e})=>e.fontDarkest}
    ${({theme:e})=>e.background};

  ${tr}
`,zh=d.div`
  flex-grow: 1;
  width: 1px;
`,Dh=d.div`
  display: flex;
  justify-content: space-between;
  flex-grow: 1;
  overflow: hidden;
`,Hh=g.memo((()=>{const[e,t]=H(Zt);return g.createElement(g.Fragment,null,g.createElement(Fh,{key:"bar"}),g.createElement($u,{showSidebar:e,onShowSidebar:t,key:"header"}),g.createElement(Dh,null,e?g.createElement(Kh,null,g.createElement(Oh,null,g.createElement(im,{modal:!1}))):null,g.createElement(zh,{style:{paddingLeft:e?0:"1rem"}},g.createElement(ku,null))))})),Uh=m(d.img`
  width: 4rem;
  height: 4rem;
  margin: auto;
  display: block;
  transform-origin: 50% 50%;
  border-color: ${({theme:e})=>e.backgroundDarkBorder};
`),jh=d.div`
  display: flex;
  padding: 2rem;
  width: 100%;
  height: 100%;
`,Bh=d.div`
  padding-top: 1rem;
  font-weight: bold;
  text-align: center;

  & a {
    color: ${({theme:e})=>e.brand};
    text-decoration: underline;
    cursor: pointer;
  }
`,Jh=g.memo((({text:e=null,onClick:t=null})=>{const[n,s]=u.exports.useState(!1),a=M({from:{transform:"rotate(0deg)"},transform:"rotate(360deg)",onRest:()=>s((e=>!e)),reset:n,config:{duration:3e3}}),l=t?{onClick:t}:{};return g.createElement(jh,null,g.createElement("div",o({style:{margin:"auto",width:"100%",cursor:t?"pointer":"default"}},l),g.createElement(Uh,{style:a,src:Xo}),e&&g.createElement(Bh,null,e)))})),Ah=d.div`
  ${tr}
  overflow-y: hidden;
  overflow-x: scroll;
  width: 100%;
  height: 100%;
  padding-left: 1rem;
`,_h=({title:e,count:t})=>g.createElement(nr,null,g.createElement(sr,null,e),"Count: ",t),Qh=(e,t)=>class extends u.exports.PureComponent{render(){const{x:n,y:s,payload:a,fill:l}=this.props,i=a.value;return g.createElement("g",{transform:`translate(${n},${s})`},g.createElement("text",{x:0,y:0,dy:16,textAnchor:"end",fill:l,transform:"rotate(-80)"},e?gn(i,t):(o=i,Number(o)===o&&o%1!=0?i.toFixed(3):i.length>24?i.slice(0,21)+"...":i)));var o}},$h=d.div`
  font-weight: bold;
  font-size: 1rem;
  line-height: 2rem;
`,qh=({distribution:e})=>{const{name:t,data:n,ticks:s,type:a}=e,[l,{height:i}]=q(),d=u.exports.useRef(null),m="hsl(210, 20%, 90%)",h=m,p=P(Wr(t)),f=P(Mr(t)),b=P(Ni),y=0===s?{interval:s}:{ticks:s},v=n.map((e=>{var t=e,{key:n}=t,s=c(t,["key"]);return r(o({},s),{key:p||f?n:un(n,!1)})})),x=n.length>=200,w=v.reduce(((e,t)=>r(o({},e),{[t.key]:t.edges})),{}),k=Qh(p||f,f?"UTC":b);return g.createElement(Ah,{ref:l},g.createElement($h,null,`${t}${x?` (first ${n.length})`:""}`),g.createElement(Ge,{ref:d,height:i-37,width:28*n.length+50,barCategoryGap:"4px",data:v,margin:{top:0,left:0,bottom:5,right:5}},g.createElement(Ye,o({dataKey:"key",height:.2*i,axisLine:!1,tick:g.createElement(k,o({},{fill:h})),tickLine:{stroke:m}},y)),g.createElement(Ve,{dataKey:"count",axisLine:!1,tick:{fill:h},tickLine:{stroke:m}}),g.createElement(Fe,{cursor:!1,content:e=>{var t,n,s,l;const i=null==(n=null==(t=null==e?void 0:e.payload[0])?void 0:t.payload)?void 0:n.key,o=null==(l=null==(s=null==e?void 0:e.payload[0])?void 0:s.payload)?void 0:l.count;if("number"!=typeof o)return null;let r=`Value: ${i}`;if(w[i])if(p||f){const[{$date:e},{$date:t}]=w[i],[n,s]=fn(f?"UTC":b,e,t);let a=s.formatRange(e,t).replaceAll("/","-");3===s.resolvedOptions().fractionalSecondDigits&&(a=a.replaceAll(",",".")),r=`Range: ${n?n.format(e).replaceAll("/","-"):""} ${a.replaceAll("/","-")}`}else r=`Range: [${w[i].map((e=>"IntField"===a?e:e.toFixed(3))).join(", ")})`;return g.createElement(_h,{title:r,count:o})},contentStyle:{background:"hsl(210, 20%, 23%)",borderColor:"rgb(255, 109, 4)"}}),g.createElement(Ke,{dataKey:"count",fill:"rgb(255, 109, 4)",barCategoryGap:0,barSize:24})))},ep=d.div`
  overflow-y: scroll;
  overflow-x: hidden;
  width: 100%;
  height: calc(100% - 3rem);
  ${tr}
`,tp=({group:e})=>{const t=P(wi),n=P(Ti),s=P(si),[a,l]=u.exports.useState(!0),i=P(ei),[o,r]=u.exports.useState([]);return po("distributions",{group:e.toLowerCase()},null,[JSON.stringify(t),JSON.stringify(n),s,i]),ho("distributions",(({results:e})=>{l(!1),r(e)})),u.exports.useEffect((()=>{r([]),l(!0)}),[JSON.stringify(t),JSON.stringify(n),s,i,e]),a?g.createElement(Jh,null):0===o.length?g.createElement(Jh,{text:`No ${e.toLowerCase()}`}):g.createElement(ep,null,o.map(((e,t)=>g.createElement(qh,{key:t,distribution:e}))))},np=d(Oe)`
  position: absolute;
  bottom: -0.8rem;
  height: 1rem;
  width: 1rem;
  left: 50%;
  margin-left: -0.5rem;
  z-index: 1000;
  pointer-events: none;
`,sp=d(ze)`
  padding: 1rem 0 0;
  background-color: ${({theme:e})=>e.backgroundDark};
  border-bottom: 1px ${({theme:e})=>e.backgroundDarkBorder} solid;
`,ap=d.div`
  padding: 0 1rem;
  width: 100%;
  display: flex;
  justify-content: space-between;
`,lp=d.div`
  display: flex;
  justify-content: space-between;
`,ip=d.div`
  padding-bottom: 1rem;
`,op=d.div`
  height: 1.5rem;
  line-height: 1.5rem;
  margin: 0.25rem 0.25rem 0.25rem 0;
  cursor: pointer;
  display: inline-block;
  margin-right: 5px;
  padding: 0 1em;
  color: ${({theme:e})=>e.font};
  background-color: ${({theme:e})=>e.backgroundLight};
  text-decoration: none;
  border-radius: 2px;
  font-weight: bold;

  &.active {
    background-color: ${({theme:e})=>e.secondary};
  }
`,rp=d.div`
  cursor: pointer;
  width: 1.5rem;
  height: 1.5rem;
  margin: 0.25rem;
`,cp=g.memo((({maximized:e,setMaximized:t})=>g.createElement(rp,{onClick:()=>t(!e)},e?g.createElement(De,null):g.createElement(He,null)))),dp=({entries:e})=>{const{height:t}=yo(),[n,s]=H(vt),[a,l]=u.exports.useState(!1),[i,o]=u.exports.useState(392),[r,c]=u.exports.useState(!1),d=a?i:64,m=P(hi);return g.createElement(sp,{size:{height:r?t-73:d},minHeight:64,enable:{top:!1,right:!1,bottom:a&&!r,left:!1,topRight:!1,bottomRight:!1,bottomLeft:!1,topLeft:!1},onResizeStop:(e,t,n,s)=>{o(d+s.height)}},g.createElement(ap,null,g.createElement(ip,null,e.map((e=>g.createElement(op,{key:e,className:e===n&&a?"active":"",onClick:()=>{a&&n===e?l(!1):(l(!0),s(e))}},"Sample tags"===e?`${Ue(m.singular)} tags`:e)))),g.createElement(lp,null,a&&g.createElement(cp,{maximized:r,setMaximized:()=>{c(!r),l(!0)}}),g.createElement(lr,{onClick:()=>{l(!a),a&&c(!1)},text:a?"Hide":"Show",open:a,icon:g.createElement(je,null),highlight:!a,arrow:!0}))),a&&g.createElement(tp,{key:n,group:n}),a&&!r&&g.createElement(np,null))},mp=d.div`
  margin: 0;
`,up=d.div`
  border-top: 2px solid ${({theme:e})=>e.font};
  width: 100%;
  padding: 0.5rem 0 0;
`,hp=d.div`
  padding: 0.1rem 0 0 0;
  margin: 0;
`,pp=m(d(nr)`
  position: absolute;
  margin-top: 0;
  left: -1000;
  top: -1000;
  z-index: 20000;
  pointer-events: none;
`),gp=d.div`
  margin: 0;
  padding: 0;
  max-width: 10rem;
  word-wrap: break-word;
`,fp=d.div`
  font-size: 0.8rem;
  font-weight: bold;
  color: ${({theme:e})=>e.font};
`,bp=d.div`
  font-size: 0.7rem;
  font-weight: bold;
  padding-bottom: 0.3rem;
  color: ${({theme:e})=>e.fontDark};
`,yp=({name:e,value:t,style:n})=>"object"==typeof t?null:g.createElement(gp,{style:n},g.createElement(fp,null,(()=>{switch(typeof t){case"number":return Number.isInteger(t)?t:t.toFixed(3);case"string":return t.length?t:'""';case"boolean":return t?"True":"False";default:return"None"}})()),g.createElement(bp,null,e)),vp=({label:e,children:t=null})=>{let n=Object.entries(e).filter((([e,t])=>"tags"!==e&&!e.startsWith("_")));if(!n||!n.length)return null;const s=n.filter((([e])=>["label","confidence"].includes(e))),a=n.filter((([e])=>!["label","confidence"].includes(e))),l=([e,t])=>g.createElement(yp,{key:e,name:e,value:t}),i="object"==typeof e.attributes?Object.entries(e.attributes).map((([e,t])=>["attributes."+e,t.value])):null;return g.createElement(g.Fragment,null,s.map(l),t,a.map(l),i&&i.map(l))},xp=({color:e,id:t})=>{const n=P(so);return g.createElement(up,{style:{borderTop:`2px ${n.has(t)?"dashed":"solid"} ${e}`}})},wp={Classification:({detail:e})=>g.createElement(hp,{style:{borderColor:e.color}},g.createElement(vp,{label:e.label})),Detection:({detail:e})=>g.createElement(hp,{style:{borderColor:e.color}},g.createElement(vp,{label:e.label})),Heatmap:({detail:e})=>g.createElement(hp,{style:{borderColor:e.color}},g.createElement(yp,{key:"pixel-value",name:"pixel",value:e.target}),g.createElement(vp,{label:e.label})),Keypoint:({detail:e})=>g.createElement(hp,{style:{borderColor:e.color}},g.createElement(vp,{label:e.label})),Polyline:({detail:e})=>g.createElement(hp,{style:{borderColor:e.color}},g.createElement(vp,{label:e.label})),Regression:({detail:e})=>g.createElement(hp,{style:{borderColor:e.color}},g.createElement(vp,{label:e.label})),Segmentation:({detail:e})=>{const t=(n=e.field,s=e.target,P(no)(n,s));var n,s;return g.createElement(hp,{style:{borderColor:e.color}},t?g.createElement(yp,{key:"target-value",name:"label",value:t}):g.createElement(yp,{key:"pixel-value",name:"pixel",value:e.target}),g.createElement(vp,{label:e.label}))}},kp=({tags:e})=>e?g.createElement(mp,null,g.createElement(yp,{key:"tags",name:"tags",value:e.length?e.join(", "):"No tags",style:{maxWidth:"20rem"}})):null,Ep=g.memo((({looker:e})=>{var t;const[n,s]=u.exports.useState(null),[a,l]=u.exports.useState({top:-1e3,left:-1e3,bottom:"unset"}),i=M(r(o({},n?a:{top:-1e3,left:-1e3,bottom:"unset"}),{config:{duration:0}})),c=u.exports.useRef(null);uo(e,"tooltip",(e=>{s(e.detail?e.detail:null),e.detail&&l((([e,t])=>{let n=t,s="unset";return t>window.innerHeight/2&&(s=window.innerHeight-t,n="unset"),{bottom:s,top:n,left:e<=window.innerWidth/2?e+24:"unset",right:e>window.innerWidth/2?window.innerWidth-e+24:"unset"}})(e.detail.coordinates))}));const d=M({display:n?"block":"none",opacity:n?1:0}),m=n?wp[n.type]:null;return m?Be.createPortal(g.createElement(pp,{style:r(o(o({},i),d),{position:"fixed"}),ref:c},g.createElement(sr,{key:"header"},n.field),g.createElement(xp,{color:n.color,id:n.label.id}),n.label.tags&&n.label.tags.length>0&&g.createElement(kp,{key:"tags",tags:null==(t=n.label)?void 0:t.tags}),g.createElement(m,{key:"attrs",detail:n})),document.body):null})),Sp=e=>Object.fromEntries(Object.entries(e).map((([e,t])=>[t,e]))),Lp=T({key:"lookerOptions",get:({get:e})=>{const t=e(Qi).show_confidence,n=e(Qi).show_index,s=e(Qi).show_label,a=e(Qi).show_tooltip,l=e(Qi).use_frame_number,i=e(xi)?{loop:e(Qi).loop_videos}:{},c=!!e(gi)&&e(pt(!0));return r(o(r(o({showConfidence:t,showIndex:n,showLabel:s,useFrameNumber:l,showTooltip:a},i),{zoom:c,filter:e(tc(!0))}),e(Xt)),{selectedLabels:[...e(so)],fullscreen:e(gt),fieldsMap:Sp(e(_i("sample"))),frameFieldsMap:Sp(e(_i("frame"))),timeZone:e(Ni),coloring:e(qi(!0)),alpha:e(Rt(!0))})}});var Tp=g.memo((({lookerRef:e,onClose:t,onNext:n,onPrevious:s,onSelectLabel:a,style:l})=>{const[i]=u.exports.useState((()=>x())),{sample:c,dimensions:d,frameRate:m,frameNumber:h}=P(ut),p=P(gt),f=P(pi),b=pn(c),y=P(Ri("sample")),v=ou(c.filepath,c._id),w=P(Lp),k=P(ic),E=xo(),S=P(ru),L=u.exports.useRef(!0),[T]=u.exports.useState((()=>{const e=S(b),t=f?{support:c.support}:{};return new e(c,o({src:v,dimensions:d,frameRate:m,frameNumber:h,sampleId:c._id,thumbnail:!1,fieldSchema:Object.fromEntries(y.map((e=>[e.name,e])))},t),r(o({activePaths:k},w),{hasNext:Boolean(n),hasPrevious:Boolean(s)}))}));return u.exports.useEffect((()=>{!L.current&&T.updateOptions(r(o({},w),{activePaths:k}))}),[w,k]),u.exports.useEffect((()=>{!L.current&&T.updateSample(c)}),[c]),u.exports.useEffect((()=>()=>T&&T.destroy()),[T]),e&&(e.current=T),uo(T,"options",te((({snapshot:e,set:t})=>async n=>{const s=await e.getPromise(Xt);t(Xt,o(o({},s),n.detail))}))),uo(T,"fullscreen",te((({set:e})=>async t=>{e(gt,t.detail)}))),n&&uo(T,"next",n),s&&uo(T,"previous",s),t&&uo(T,"close",t),a&&uo(T,"select",a),u.exports.useEffect((()=>{L.current=!1}),[]),u.exports.useEffect((()=>{T.attach(p?"root":i)}),[i,p]),uo(T,"clear",te((({set:e})=>async()=>e(lo,{})),[])),g.createElement("div",{id:i,style:o({width:"100%",height:"100%",background:E.backgroundDark},l)},g.createElement(Ep,{looker:T}))}));const Zp=d.div`
  position: relative;
  display: grid;
  grid-template-columns: auto 296px;
  width: 90vw;
  height: 80vh;
  max-height: 80vh;
  background-color: ${({theme:e})=>e.backgroundDark};

  h2 {
    margin: 0.5rem -1rem;
    padding: 0 1rem;
    border-bottom: 2px solid ${({theme:e})=>e.backgroundLight};
    clear: both;
  }

  h2,
  h2 span {
    display: flex;
    align-items: center;
  }

  h2 .push-right {
    margin-left: auto;
  }

  h2 svg {
    cursor: pointer;
    margin-left: 5px;
  }

  h2 .close-wrapper {
    position: absolute;
    top: 1em;
    right: 1em;
    background-color: ${({theme:e})=>e.backgroundTransparent};
  }

  .nav-button {
    position: absolute;
    z-index: 1000;
    top: 50%;
    width: 2em;
    height: 5em;
    margin-top: -2.5em;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: ${({theme:e})=>e.overlayButton};
    cursor: pointer;
    font-size: 150%;
    font-weight: bold;
    user-select: none;

    &.left {
      left: 0;
    }
    &.right {
      right: 0;
    }
    &:hover {
      background-color: ${({theme:e})=>e.overlayButtonHover};
    }
  }

  .sidebar {
    position: relative;
    height: 100%;
    max-height: 100%;
    overflow-y: scroll;
    height: 100%;
    background: ${({theme:e})=>e.background};
    border-left: 2px solid ${({theme:e})=>e.border};
    scrollbar-width: none;

    .sidebar-content {
      padding-left: 1rem;
      padding-right: 1rem;
      flex-grow: 1;
    }
  }

  .sidebar::-webkit-scrollbar {
    width: 0px;
    background: transparent;
    display: none;
  }
  .sidebar::-webkit-scrollbar-thumb {
    width: 0px;
    display: none;
  }

  .row {
    display: flex;
    justify-content: space-between;
    width: 100%;
    flex-wrap: wrap;

    > label {
      font-weight: bold;
      display: block;
      padding-right: 0.5rem;
      width: auto;
    }
    > div {
      display: block;
      max-width: 100%;
    }
    span {
      flex-grow: 2;
      overflow-wrap: break-word;
      vertical-align: middle;
    }
  }

  .select-objects-wrapper {
    margin-top: -1em;
  }

  .looker-element {
    width: 100%;
    height: 100%;
    position: relative;
    max-height: 100%;
    max-width: 100%;
    overflow: hidden;
    background: ${({theme:e})=>e.backgroundDark};
  }
`,Cp=e=>{var t=e,{name:n,value:s,children:a}=t,l=c(t,["name","value","children"]);return g.createElement("div",o({className:"row"},l),g.createElement("label",null,n,""),g.createElement("div",null,g.createElement("span",{title:s},s)),a)};var Pp=g.forwardRef((({onClose:e},t)=>{const{sample:{filepath:n,_id:s,_media_type:a,metadata:l},index:i,getIndex:r}=P(ut),c=ou(n,s),d=u.exports.useRef(),m=te((({snapshot:e,set:t})=>async({detail:{id:n,field:s,frameNumber:a}})=>{const{sample:l}=await e.getPromise(ut);let i=o({},await e.getPromise(lo));i[n]?delete i[n]:i[n]={field:s,sample_id:l._id,frame_number:a},t(lo,i)}),[]);P(Ci),P(Zi),(e=>{const t=te((({set:t,snapshot:n})=>async({samples:s})=>{const a=await n.getPromise(ut);s.forEach((t=>{a.sample._id===t._id&&e.current&&e.current.updateSample(t)})),t(ut,o({},await n.getPromise(ut))),t(ao,!1)}),[]);ho("samples_update",t)})(d);const h=xo();return g.createElement(Zp,{style:{zIndex:10001},ref:t},g.createElement("div",{className:"looker-element"},g.createElement(Tp,{key:`modal-${c}`,lookerRef:d,onSelectLabel:m,onClose:e,onPrevious:i>0?()=>r(i-1):null,onNext:()=>r(i+1)})),g.createElement("div",{className:"sidebar"},g.createElement(er,{style:{width:"100%",borderTop:"none",borderBottom:`2px solid ${h.border}`,position:"relative"}},g.createElement(ju,{modal:!0,lookerRef:d})),g.createElement("div",{className:"sidebar-content"},g.createElement("h2",null,"Metadata",g.createElement("span",{className:"push-right"})),g.createElement(Cp,{name:"id",value:s}),g.createElement(Cp,{name:"filepath",value:n}),g.createElement(Cp,{name:"media type",value:a}),(e=>e?cn.map((t=>({name:t.name,value:t.value?t.value(e):e[t.key]}))).filter((({value:e})=>void 0!==e)):[])(l).map((({name:e,value:t})=>g.createElement(Cp,{key:"metadata-"+e,name:e,value:t}))),g.createElement(u.exports.Suspense,{fallback:g.createElement("h2",null,"Fields",g.createElement("span",{className:"push-right"}))},g.createElement("h2",null,"Fields",g.createElement("span",{className:"push-right"})),g.createElement(im,{modal:!0,style:{overflowY:"auto",overflowX:"hidden",height:"auto"}})))))}));const Rp=["Sample tags","Label tags","Labels","Other fields"],Ip=d.div`
  height: calc(100% - 74px);
  display: flex;
  flex-direction: column;
`,Wp=d.div`
  width: 100%;
  flex-grow: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
`;var Mp=g.memo((function(){const e=u.exports.useRef(),t=P(ql),n=xo(),s=P(gt)?{background:n.backgroundDark}:{},a=P(yi);vo(),(()=>{const e=P(xi),t=u.exports.useCallback((()=>{document.body.querySelectorAll("svg").forEach((e=>{e.setAttribute("width",e.getBoundingClientRect().width),e.setAttribute("height",e.getBoundingClientRect().height)}))}),[]),n=u.exports.useCallback((()=>{const e=document.body.querySelectorAll("img"),t=[];return e.forEach((e=>{!e.classList.contains("fo-captured")&&t.push(fetch(e.src).then((e=>e.blob())).then((e=>new Promise(((t,n)=>{const s=new FileReader;s.onloadend=()=>{t(s.result)},s.onerror=e=>n(e),s.readAsDataURL(e)})))).then((t=>new Promise(((n,s)=>{e.onload=n,e.onerror=s,e.src=t})))))})),Promise.all(t)}),[]),s=u.exports.useCallback((()=>{const e=[];return document.querySelectorAll("link").forEach((t=>{"stylesheet"===t.rel&&e.push(fetch(t.href).then((e=>e.text())).then((e=>{const t=document.createElement("style");t.appendChild(document.createTextNode(e)),document.head.appendChild(t)})))})),Promise.all(e)}),[]),a=u.exports.useCallback((()=>{const e=document.body.querySelectorAll("video"),t=[];return e.forEach((e=>{const n=document.createElement("canvas"),s=e.getBoundingClientRect();n.width=s.width,n.height=s.height,n.getContext("2d").drawImage(e,0,0,n.width,n.height);const a=n.toDataURL("image/png"),l=new Image(s.width,s.height);l.className="p51-contained-image fo-captured",e.parentNode.replaceChild(l,e),t.push(new Promise(((e,t)=>{l.onload=e,l.onerror=t,l.src=a})))})),Promise.all(t)}),[]),l=u.exports.useCallback((()=>{I(document.body).then((e=>{const t=e.toDataURL("image/png");vn&&window.parent.postMessage({src:t,handleId:wn,width:e.width},"*"),Rn.send(In("capture",{src:t,width:e.width}))}))}),[]);ho("deactivate",(()=>{t();let i=Promise.resolve(null);e&&(i=i.then(a)),vn?i.then(n).then(s).then(l):i.then(l)}))})(),(()=>{const e=P(si),t=D(lc);u.exports.useEffect((()=>{t()}),[e])})();const l=cu();return fo(e,l),u.exports.useEffect((()=>{document.body.classList.toggle("noscroll",t)}),[t]),g.createElement(g.Fragment,null,t?g.createElement(qo,{key:0,style:s},g.createElement(Pp,{onClose:l,ref:e})):null,g.createElement(Ip,{key:1},a&&g.createElement(dp,{entries:Rp,key:"nav"}),a?g.createElement(Wp,{key:"body"},g.createElement(Hh,{key:"samples"})):g.createElement(Jh,{text:"No dataset selected",key:"loading"})))}));const Xp=d.div`
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  width: 100%;
`,Np=d.div``,Gp=d.div`
  font-weight: bold;
  text-align: center;
`,Yp=d.code`
  background: ${({theme:e})=>e.backgroundDark};
  border-bottom: 1px ${({theme:e})=>e.backgroundDarkBorder} solid;
  color: ${({theme:e})=>e.secondary};
  padding: 0.5rem;
`,Vp=d.button`
  display: inline-block;
  margin: 1rem 0.5rem;
  padding: 0.5rem;
  background: ${({theme:e})=>e.backgroundDark};
  color: ${({theme:e})=>e.fontDark};
  border: none;
  border-radius: 2px;
  font-weight: bold;
  color: ${({theme:e})=>e.font};
  cursor: pointer;

  &:focus {
    outline: none;
  }
`,Fp=d.img`
  width: 5rem;
  height: 5rem;
  margin: 0 auto 1rem;
  display: block;
`,Kp=({resetErrorBoundary:e})=>g.createElement(Xp,null,g.createElement(Np,null,g.createElement(Fp,{src:Xo}),g.createElement(Gp,null,g.createElement("p",null,"Oops! Something went wrong."),g.createElement("p",null,"If you just changed your view, try reverting your changes:"),g.createElement(Yp,null,"session.view = old_view"),g.createElement("div",null,"And then"," ",g.createElement(Vp,{onClick:e},"Reload the App")," ","to try again.")))),Op=d.div`
  font-size: 2rem;
  line-height: 3rem;
  color: ${({theme:e})=>e.font};
  font-weight: bold;
`,zp=d.p`
  font-size: 1rem;
  line-height: 1.5rem;
  margin: 0;
  padding: 0;
  color: ${({theme:e})=>e.fontDark};

  & > a {
    color: ${({theme:e})=>e.brand};
  }
`,Dp=d.pre`
  padding: 2rem;
  background-color: ${({theme:e})=>e.backgroundDark};
  border: 1px solid ${({theme:e})=>e.backgroundDarkBorder};
  color: ${({theme:e})=>e.font};
  border-radius: 3px;
`,Hp=()=>{const e=`import fiftyone as fo\n\n# Load your FiftyOne dataset\ndataset = fo.load_dataset(...)\n\n# Launch the app\nsession = fo.launch_app(dataset, port=${Ln})\n`;return g.createElement(g.Fragment,null,g.createElement(Op,null,"Local sessions"),g.createElement(zp,null,"Here's how to connect to a local session from Python:"),g.createElement(Dp,null,e))},Up=()=>{const e=`# Option 1: Configure port forwaring\n# Then open http://localhost:${Ln} in your web browser\nssh -N -L ${Ln}:127.0.0.1:XXXX [<username>@]<hostname>\n\n# Option 2: Use the CLI\nfiftyone app connect --destination [<username>@]<hostname> \\\n    --port XXXX --local-port ${Ln}\n`;return g.createElement(g.Fragment,null,g.createElement(Op,null,"Remote sessions"),g.createElement(zp,null,"You can work with data on a remote machine by launching a remote App session and connecting to it from your local machine. See"," ",g.createElement("a",{target:"_blank",href:"https://voxel51.com/docs/fiftyone/user_guide/app.html#remote-sessions"},"this page")," ","for more information."),g.createElement(Ap,null,"On your remote machine"),g.createElement(Dp,null,"import fiftyone as fo\n\n# Load your FiftyOne dataset\ndataset = fo.load_dataset(...)\n\n# Launch a remote App instance that you'll connect to from your local machine\nsession = fo.launch_app(dataset, remote=True, port=XXXX)\n"),g.createElement(Ap,null,"On your local machine"),g.createElement(Dp,null,e))},jp=()=>g.createElement(g.Fragment,null,g.createElement(Op,null,"Notebook sessions"),g.createElement(zp,null,"Re-run the cell that created the session shown here.")),Bp=d.div`
  width: 800px;
  padding: 3rem 1rem;
  margin: 0 auto;
`,Jp=d.div`
  font-size: 2.5rem;
  line-height: 3.5rem;
  color: ${({theme:e})=>e.font};
  font-weight: bold;
`,Ap=d.div`
  font-size: 1.5rem;
  color: ${({theme:e})=>e.fontDark};
  font-weight: 500;
`,_p=d.div`
  display: flex;
  justify-content: flex-start;
  margin: 1em 0 3em 0;
  border-bottom-width: 2px;
  border-bottom-style: solid;
  border-bottom-color: ${({theme:e})=>e.backgroundDarkBorder};
  height: 53px;
`,Qp=m(d.div`
  font-size: 1rem;
  line-height: 3em;
  font-weight: bold;
  padding: 0 0.5em;
  cursor: pointer;
  border-bottom-width: 3px;
  border-bottom-style: solid;
`),$p=()=>{const e=xo(),[t,n]=u.exports.useState("local"),s=M({borderBottomColor:"local"===t?e.brand:e.background,color:"local"===t?e.font:e.fontDark}),a=M({borderBottomColor:"remote"===t?e.brand:e.background,color:"remote"===t?e.font:e.fontDark});return g.createElement(Bp,null,g.createElement(Jp,null,"Welcome to FiftyOne!"),g.createElement(Ap,null,"It looks like you are not connected to a session"),bn?g.createElement(jp,null):g.createElement(g.Fragment,null,g.createElement(_p,null,g.createElement(Qp,{onClick:()=>n("local"),style:s},"Local sessions"),g.createElement(Qp,{onClick:()=>n("remote"),style:a},"Remote sessions")),"remote"===t?g.createElement(Up,null):g.createElement(Hp,null)))};function qp(){const e=u.exports.useRef(null),[t,n]=u.exports.useState(!1);return ho("statistics",te((({set:e})=>async({stats:t,view:n,extended:s,filters:a})=>{s&&e(wt,{stats:t,view:n,filters:a}),!s&&e(xt,{stats:t,view:n})}),[])),uo(Rn,"open",te((({set:e,snapshot:t})=>async()=>{e(kt,!0),!(await t.getPromise(kt))&&e(ft,!0)}),[])),uo(Rn,"close",(()=>{const e=cu();return te((({reset:t,set:n})=>async()=>{e(),n(ft,!1),t(St)}),[])})()),ho("update",te((({snapshot:e,set:t})=>async({state:n})=>{const s=new Set(n.selected),a=await e.getPromise(Ct);t(Ct,a+1),t(kt,!1),t(Lt,s),t(St,n),t(ao,!1),t(gm,!1),t(Eu,!1),t(Du,!1);const l=await e.getPromise(It);JSON.stringify(n.config.color_pool)!==JSON.stringify(l)&&t(It,n.config.color_pool)}),[])),ho("notification",(t=>e.current(t))),po("as_app",{notebook:bn,handle:wn}),g.createElement(Je,{FallbackComponent:Kp,onReset:()=>n(!0),resetKeys:[t]},g.createElement(Qo,{addNotification:e}),g.createElement(u.exports.Suspense,{fallback:g.createElement($p,null)},g.createElement(Mp,null)),g.createElement(dt,{children:t=>e.current=t}))}const eg=_e`
   ${Ae`
  body,
  input,
  button {
    font-family: "Palanquin", sans-serif;
    font-size: 14px;
    color: ${({theme:e})=>e.font};
  }

  body,
  html {
    height: 100%;
    margin: 0 !important;
    padding: 0 !important;
    background-color: ${({theme:e})=>e.background};
  }

  body {
    ${tr};
    ::-webkit-scrollbar {
      background-color: ${({theme:e})=>e.background};
    }
  }

  input {
    padding: 0;
  }

  #root {
    height: 100%;
    position: relative;
  }
`}
`,tg=()=>g.createElement(Qe,{theme:Vn},g.createElement(eg,null),g.createElement($e,null,g.createElement(qp,null)));document.addEventListener("DOMContentLoaded",(()=>Be.render(g.createElement(u.exports.Fragment,null,g.createElement(tg,null)),document.getElementById("root"))));
